{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 51.501258850097656, "policy_loss": -708.3756103515625, "vf_loss": 4689.31689453125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32, "num_env_steps_trained": 32, "num_agent_steps_sampled": 32, "num_agent_steps_trained": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32, "num_agent_steps_trained": 32, "num_env_steps_sampled": 32, "num_env_steps_trained": 32, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 1.939793244196528, "num_env_steps_trained_throughput_per_sec": 1.939793244196528, "timesteps_total": 32, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 32, "timers": {"training_iteration_time_ms": 16496.603, "sample_time_ms": 15275.574, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1204.416, "learn_throughput": 26.569, "synch_weights_time_ms": 15.605}, "counters": {"num_env_steps_sampled": 32, "num_env_steps_trained": 32, "num_agent_steps_sampled": 32, "num_agent_steps_trained": 32}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "3fc51_00000", "date": "2024-08-11_19-09-56", "timestamp": 1723367396, "time_this_iter_s": 16.512215614318848, "time_total_s": 16.512215614318848, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 16.512215614318848, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.4375, "ram_util_percent": 84.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 19.729734420776367, "policy_loss": 73.34899139404297, "vf_loss": 249.67112731933594}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128}, "sampler_results": {"episode_reward_max": -37.069884351825635, "episode_reward_min": -48.37089058917819, "episode_reward_mean": -43.346986911135765, "episode_len_mean": 29.666666666666668, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635], "episode_lengths": [30, 30, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 521.8046482163246, "mean_inference_ms": 2.519212587915286, "mean_action_processing_ms": 0.44740330089222297, "mean_env_wait_ms": 453.94212790209843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5204200744628906}}, "episode_reward_max": -37.069884351825635, "episode_reward_min": -48.37089058917819, "episode_reward_mean": -43.346986911135765, "episode_len_mean": 29.666666666666668, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635], "episode_lengths": [30, 30, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 521.8046482163246, "mean_inference_ms": 2.519212587915286, "mean_action_processing_ms": 0.44740330089222297, "mean_env_wait_ms": 453.94212790209843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5204200744628906}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128, "num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.4841338309842955, "num_env_steps_trained_throughput_per_sec": 5.4841338309842955, "timesteps_total": 128, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 128, "timers": {"training_iteration_time_ms": 8500.412, "sample_time_ms": 8182.808, "load_time_ms": 0.165, "load_throughput": 194447.994, "learn_time_ms": 311.102, "learn_throughput": 102.86, "synch_weights_time_ms": 6.086}, "counters": {"num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128}, "done": false, "episodes_total": 3, "training_iteration": 2, "trial_id": "3fc51_00000", "date": "2024-08-11_19-10-14", "timestamp": 1723367414, "time_this_iter_s": 17.512760400772095, "time_total_s": 34.02497601509094, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 34.02497601509094, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.225000000000005, "ram_util_percent": 84.70416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 21.526809692382812, "policy_loss": 38.8161506652832, "vf_loss": 63.54969024658203}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 160, "num_env_steps_trained": 160, "num_agent_steps_sampled": 160, "num_agent_steps_trained": 160}, "sampler_results": {"episode_reward_max": -37.069884351825635, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -54.76770842401109, "episode_len_mean": 30.75, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704], "episode_lengths": [30, 30, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 480.8533159081177, "mean_inference_ms": 2.368380736176913, "mean_action_processing_ms": 0.35173877115524527, "mean_env_wait_ms": 432.679238534379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4156053066253662}}, "episode_reward_max": -37.069884351825635, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -54.76770842401109, "episode_len_mean": 30.75, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704], "episode_lengths": [30, 30, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 480.8533159081177, "mean_inference_ms": 2.368380736176913, "mean_action_processing_ms": 0.35173877115524527, "mean_env_wait_ms": 432.679238534379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4156053066253662}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160, "num_agent_steps_trained": 160, "num_env_steps_sampled": 160, "num_env_steps_trained": 160, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.182367979583278, "num_env_steps_trained_throughput_per_sec": 2.182367979583278, "timesteps_total": 160, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 160, "timers": {"training_iteration_time_ms": 9732.924, "sample_time_ms": 9476.298, "load_time_ms": 0.335, "load_throughput": 95501.443, "learn_time_ms": 249.795, "learn_throughput": 128.105, "synch_weights_time_ms": 6.294}, "counters": {"num_env_steps_sampled": 160, "num_env_steps_trained": 160, "num_agent_steps_sampled": 160, "num_agent_steps_trained": 160}, "done": false, "episodes_total": 4, "training_iteration": 3, "trial_id": "3fc51_00000", "date": "2024-08-11_19-10-28", "timestamp": 1723367428, "time_this_iter_s": 14.671157598495483, "time_total_s": 48.696133613586426, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 48.696133613586426, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.876190476190475, "ram_util_percent": 85.00952380952378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 22.067834854125977, "policy_loss": 41.454654693603516, "vf_loss": 58.24836730957031}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 224, "num_env_steps_trained": 224, "num_agent_steps_sampled": 224, "num_agent_steps_trained": 224}, "sampler_results": {"episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -31.092048791951658, "episode_len_mean": 28.285714285714285, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354], "episode_lengths": [30, 30, 29, 34, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 517.9766831137981, "mean_inference_ms": 2.268986358571774, "mean_action_processing_ms": 0.3522883969363287, "mean_env_wait_ms": 359.898130687907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01430511474609375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.280414308820452}}, "episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -31.092048791951658, "episode_len_mean": 28.285714285714285, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354], "episode_lengths": [30, 30, 29, 34, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 517.9766831137981, "mean_inference_ms": 2.268986358571774, "mean_action_processing_ms": 0.3522883969363287, "mean_env_wait_ms": 359.898130687907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01430511474609375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.280414308820452}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224, "num_agent_steps_trained": 224, "num_env_steps_sampled": 224, "num_env_steps_trained": 224, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 4.188013930265329, "num_env_steps_trained_throughput_per_sec": 4.188013930265329, "timesteps_total": 224, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 224, "timers": {"training_iteration_time_ms": 9135.189, "sample_time_ms": 8947.789, "load_time_ms": 0.239, "load_throughput": 133702.02, "learn_time_ms": 179.075, "learn_throughput": 178.696, "synch_weights_time_ms": 7.942}, "counters": {"num_env_steps_sampled": 224, "num_env_steps_trained": 224, "num_agent_steps_sampled": 224, "num_agent_steps_trained": 224}, "done": false, "episodes_total": 7, "training_iteration": 4, "trial_id": "3fc51_00000", "date": "2024-08-11_19-10-44", "timestamp": 1723367444, "time_this_iter_s": 15.28170657157898, "time_total_s": 63.977840185165405, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 63.977840185165405, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.890476190476193, "ram_util_percent": 84.59047619047621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 19.876020431518555, "policy_loss": 12.566892623901367, "vf_loss": 2.4350521564483643}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256}, "sampler_results": {"episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -27.159927021114623, "episode_len_mean": 27.875, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 504.015082405336, "mean_inference_ms": 2.196200281227954, "mean_action_processing_ms": 0.31738698837975, "mean_env_wait_ms": 344.00414455727844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012516975402832031, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.25786757469177246}}, "episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -27.159927021114623, "episode_len_mean": 27.875, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 504.015082405336, "mean_inference_ms": 2.196200281227954, "mean_action_processing_ms": 0.31738698837975, "mean_env_wait_ms": 344.00414455727844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012516975402832031, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.25786757469177246}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256, "num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.7241811070803155, "num_env_steps_trained_throughput_per_sec": 2.7241811070803155, "timesteps_total": 256, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 256, "timers": {"training_iteration_time_ms": 9461.622, "sample_time_ms": 9295.528, "load_time_ms": 0.209, "load_throughput": 152802.309, "learn_time_ms": 156.691, "learn_throughput": 204.224, "synch_weights_time_ms": 9.068}, "counters": {"num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256}, "done": false, "episodes_total": 8, "training_iteration": 5, "trial_id": "3fc51_00000", "date": "2024-08-11_19-10-56", "timestamp": 1723367456, "time_this_iter_s": 11.754410982131958, "time_total_s": 75.73225116729736, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 75.73225116729736, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.347058823529412, "ram_util_percent": 84.33529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 21.90496063232422, "policy_loss": -29.31589698791504, "vf_loss": 39.90524673461914}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 320, "num_env_steps_trained": 320, "num_agent_steps_sampled": 320, "num_agent_steps_trained": 320}, "sampler_results": {"episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -19.686880465341506, "episode_len_mean": 27.09090909090909, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 520.6437949976626, "mean_inference_ms": 2.1863247255370233, "mean_action_processing_ms": 0.3306576565222098, "mean_env_wait_ms": 300.64648484206896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023083253340287643, "StateBufferConnector_ms": 0.00047033483331853694, "ViewRequirementAgentConnector_ms": 0.22708069194446912}}, "episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -19.686880465341506, "episode_len_mean": 27.09090909090909, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 520.6437949976626, "mean_inference_ms": 2.1863247255370233, "mean_action_processing_ms": 0.3306576565222098, "mean_env_wait_ms": 300.64648484206896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023083253340287643, "StateBufferConnector_ms": 0.00047033483331853694, "ViewRequirementAgentConnector_ms": 0.22708069194446912}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320, "num_agent_steps_trained": 320, "num_env_steps_sampled": 320, "num_env_steps_trained": 320, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 4.717644048399025, "num_env_steps_trained_throughput_per_sec": 4.717644048399025, "timesteps_total": 320, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 320, "timers": {"training_iteration_time_ms": 8925.907, "sample_time_ms": 8790.056, "load_time_ms": 0.197, "load_throughput": 162412.546, "learn_time_ms": 126.052, "learn_throughput": 253.863, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 320, "num_env_steps_trained": 320, "num_agent_steps_sampled": 320, "num_agent_steps_trained": 320}, "done": false, "episodes_total": 11, "training_iteration": 6, "trial_id": "3fc51_00000", "date": "2024-08-11_19-11-09", "timestamp": 1723367469, "time_this_iter_s": 13.566093444824219, "time_total_s": 89.29834461212158, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 89.29834461212158, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.542105263157893, "ram_util_percent": 84.06315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 21.65648078918457, "policy_loss": -17.854015350341797, "vf_loss": 17.446012496948242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 352, "num_env_steps_trained": 352, "num_agent_steps_sampled": 352, "num_agent_steps_trained": 352}, "sampler_results": {"episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -18.027563854184507, "episode_len_mean": 26.916666666666668, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 512.0584273926025, "mean_inference_ms": 2.146408401679645, "mean_action_processing_ms": 0.3119078195994075, "mean_env_wait_ms": 289.76047577614406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021159648895263672, "StateBufferConnector_ms": 0.0004311402638753255, "ViewRequirementAgentConnector_ms": 0.2178668975830078}}, "episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -18.027563854184507, "episode_len_mean": 26.916666666666668, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 512.0584273926025, "mean_inference_ms": 2.146408401679645, "mean_action_processing_ms": 0.3119078195994075, "mean_env_wait_ms": 289.76047577614406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021159648895263672, "StateBufferConnector_ms": 0.0004311402638753255, "ViewRequirementAgentConnector_ms": 0.2178668975830078}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352, "num_agent_steps_trained": 352, "num_env_steps_sampled": 352, "num_env_steps_trained": 352, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.9703205030518336, "num_env_steps_trained_throughput_per_sec": 2.9703205030518336, "timesteps_total": 352, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 352, "timers": {"training_iteration_time_ms": 8353.571, "sample_time_ms": 8338.264, "load_time_ms": 0.197, "load_throughput": 162412.546, "learn_time_ms": 5.611, "learn_throughput": 5703.578, "synch_weights_time_ms": 9.5}, "counters": {"num_env_steps_sampled": 352, "num_env_steps_trained": 352, "num_agent_steps_sampled": 352, "num_agent_steps_trained": 352}, "done": false, "episodes_total": 12, "training_iteration": 7, "trial_id": "3fc51_00000", "date": "2024-08-11_19-11-20", "timestamp": 1723367480, "time_this_iter_s": 10.773248195648193, "time_total_s": 100.07159280776978, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 100.07159280776978, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.133333333333331, "ram_util_percent": 84.02666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 21.908327102661133, "policy_loss": -16.107986450195312, "vf_loss": 9.825274467468262}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 416, "num_env_steps_trained": 416, "num_agent_steps_sampled": 416, "num_agent_steps_trained": 416}, "sampler_results": {"episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -16.628281641580138, "episode_len_mean": 26.76923076923077, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 513.8040888284315, "mean_inference_ms": 2.102557307101198, "mean_action_processing_ms": 0.32424501121701116, "mean_env_wait_ms": 278.42156310013854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019531983595628005, "StateBufferConnector_ms": 0.0003979756281926082, "ViewRequirementAgentConnector_ms": 0.20110790546123797}}, "episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -16.628281641580138, "episode_len_mean": 26.76923076923077, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 513.8040888284315, "mean_inference_ms": 2.102557307101198, "mean_action_processing_ms": 0.32424501121701116, "mean_env_wait_ms": 278.42156310013854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019531983595628005, "StateBufferConnector_ms": 0.0003979756281926082, "ViewRequirementAgentConnector_ms": 0.20110790546123797}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416, "num_agent_steps_trained": 416, "num_env_steps_sampled": 416, "num_env_steps_trained": 416, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 6.009873024618754, "num_env_steps_trained_throughput_per_sec": 6.009873024618754, "timesteps_total": 416, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 416, "timers": {"training_iteration_time_ms": 9410.062, "sample_time_ms": 9394.746, "load_time_ms": 0.197, "load_throughput": 162412.546, "learn_time_ms": 2.488, "learn_throughput": 12861.771, "synch_weights_time_ms": 12.631}, "counters": {"num_env_steps_sampled": 416, "num_env_steps_trained": 416, "num_agent_steps_sampled": 416, "num_agent_steps_trained": 416}, "done": false, "episodes_total": 13, "training_iteration": 8, "trial_id": "3fc51_00000", "date": "2024-08-11_19-11-31", "timestamp": 1723367491, "time_this_iter_s": 10.64914345741272, "time_total_s": 110.7207362651825, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 110.7207362651825, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.58, "ram_util_percent": 83.92666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.78142166137695, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 22.129507064819336, "policy_loss": -5.75000524520874, "vf_loss": 0.42619484663009644}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 448, "num_env_steps_trained": 448, "num_agent_steps_sampled": 448, "num_agent_steps_trained": 448}, "sampler_results": {"episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -13.478118633124893, "episode_len_mean": 26.4375, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 512.1209639349734, "mean_inference_ms": 2.0774543661037588, "mean_action_processing_ms": 0.29606969149740103, "mean_env_wait_ms": 251.19174525616882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015869736671447754, "StateBufferConnector_ms": 0.00032335519790649414, "ViewRequirementAgentConnector_ms": 0.36473870277404785}}, "episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -13.478118633124893, "episode_len_mean": 26.4375, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 512.1209639349734, "mean_inference_ms": 2.0774543661037588, "mean_action_processing_ms": 0.29606969149740103, "mean_env_wait_ms": 251.19174525616882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015869736671447754, "StateBufferConnector_ms": 0.00032335519790649414, "ViewRequirementAgentConnector_ms": 0.36473870277404785}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448, "num_agent_steps_trained": 448, "num_env_steps_sampled": 448, "num_env_steps_trained": 448, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.2635544845960927, "num_env_steps_trained_throughput_per_sec": 2.2635544845960927, "timesteps_total": 448, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 448, "timers": {"training_iteration_time_ms": 9081.687, "sample_time_ms": 9066.624, "load_time_ms": 0.131, "load_throughput": 243899.197, "learn_time_ms": 3.174, "learn_throughput": 10081.174, "synch_weights_time_ms": 11.757}, "counters": {"num_env_steps_sampled": 448, "num_env_steps_trained": 448, "num_agent_steps_sampled": 448, "num_agent_steps_trained": 448}, "done": false, "episodes_total": 16, "training_iteration": 9, "trial_id": "3fc51_00000", "date": "2024-08-11_19-11-45", "timestamp": 1723367505, "time_this_iter_s": 14.152679681777954, "time_total_s": 124.87341594696045, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 124.87341594696045, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.244999999999997, "ram_util_percent": 84.055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 6.506585121154785, "policy_loss": 7.169302940368652, "vf_loss": 6.734994411468506}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 544, "num_env_steps_trained": 544, "num_agent_steps_sampled": 544, "num_agent_steps_trained": 544}, "sampler_results": {"episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -10.757321874105939, "episode_len_mean": 26.15, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 515.3481349871769, "mean_inference_ms": 2.0496359311216663, "mean_action_processing_ms": 0.27774314728855937, "mean_env_wait_ms": 222.9000759676152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012695789337158203, "StateBufferConnector_ms": 0.0002586841583251953, "ViewRequirementAgentConnector_ms": 0.2917909622192383}}, "episode_reward_max": 0.5724386923948961, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -10.757321874105939, "episode_len_mean": 26.15, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 515.3481349871769, "mean_inference_ms": 2.0496359311216663, "mean_action_processing_ms": 0.27774314728855937, "mean_env_wait_ms": 222.9000759676152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012695789337158203, "StateBufferConnector_ms": 0.0002586841583251953, "ViewRequirementAgentConnector_ms": 0.2917909622192383}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544, "num_agent_steps_trained": 544, "num_env_steps_sampled": 544, "num_env_steps_trained": 544, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.94634561665494, "num_env_steps_trained_throughput_per_sec": 5.94634561665494, "timesteps_total": 544, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 544, "timers": {"training_iteration_time_ms": 7701.656, "sample_time_ms": 7686.045, "load_time_ms": 0.029, "load_throughput": 1085026.095, "learn_time_ms": 3.827, "learn_throughput": 8361.121, "synch_weights_time_ms": 11.754}, "counters": {"num_env_steps_sampled": 544, "num_env_steps_trained": 544, "num_agent_steps_sampled": 544, "num_agent_steps_trained": 544}, "done": false, "episodes_total": 20, "training_iteration": 10, "trial_id": "3fc51_00000", "date": "2024-08-11_19-12-01", "timestamp": 1723367521, "time_this_iter_s": 16.14436936378479, "time_total_s": 141.01778531074524, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 141.01778531074524, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.034782608695654, "ram_util_percent": 84.31739130434781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 10.1451416015625, "policy_loss": -3.3520314693450928, "vf_loss": 0.9539591073989868}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 640, "num_env_steps_trained": 640, "num_agent_steps_sampled": 640, "num_agent_steps_trained": 640}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -8.877762931089828, "episode_len_mean": 25.958333333333332, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 520.8156072193177, "mean_inference_ms": 2.021478367266472, "mean_action_processing_ms": 0.26400595246492214, "mean_env_wait_ms": 201.31407053973467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010579824447631836, "StateBufferConnector_ms": 0.00021557013193766275, "ViewRequirementAgentConnector_ms": 0.275955597559611}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -8.877762931089828, "episode_len_mean": 25.958333333333332, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 520.8156072193177, "mean_inference_ms": 2.021478367266472, "mean_action_processing_ms": 0.26400595246492214, "mean_env_wait_ms": 201.31407053973467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010579824447631836, "StateBufferConnector_ms": 0.00021557013193766275, "ViewRequirementAgentConnector_ms": 0.275955597559611}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640, "num_agent_steps_trained": 640, "num_env_steps_sampled": 640, "num_env_steps_trained": 640, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.981720547308321, "num_env_steps_trained_throughput_per_sec": 5.981720547308321, "timesteps_total": 640, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 640, "timers": {"training_iteration_time_ms": 6775.271, "sample_time_ms": 6759.296, "load_time_ms": 0.105, "load_throughput": 305317.853, "learn_time_ms": 4.196, "learn_throughput": 7625.921, "synch_weights_time_ms": 11.675}, "counters": {"num_env_steps_sampled": 640, "num_env_steps_trained": 640, "num_agent_steps_sampled": 640, "num_agent_steps_trained": 640}, "done": false, "episodes_total": 24, "training_iteration": 11, "trial_id": "3fc51_00000", "date": "2024-08-11_19-12-18", "timestamp": 1723367538, "time_this_iter_s": 16.04889416694641, "time_total_s": 157.06667947769165, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 157.06667947769165, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.7, "ram_util_percent": 84.46521739130436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.5734806060791, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 17.951425552368164, "policy_loss": 2.3365132808685303, "vf_loss": 0.15797780454158783}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 736, "num_env_steps_trained": 736, "num_agent_steps_sampled": 736, "num_agent_steps_trained": 736}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -7.563984593685235, "episode_len_mean": 25.821428571428573, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 526.3213938140277, "mean_inference_ms": 1.9907613021398691, "mean_action_processing_ms": 0.251206386396167, "mean_env_wait_ms": 184.16523271848084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009068420955113001, "StateBufferConnector_ms": 0.00018477439880371094, "ViewRequirementAgentConnector_ms": 0.3481490271432059}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -7.563984593685235, "episode_len_mean": 25.821428571428573, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 526.3213938140277, "mean_inference_ms": 1.9907613021398691, "mean_action_processing_ms": 0.251206386396167, "mean_env_wait_ms": 184.16523271848084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009068420955113001, "StateBufferConnector_ms": 0.00018477439880371094, "ViewRequirementAgentConnector_ms": 0.3481490271432059}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736, "num_agent_steps_trained": 736, "num_env_steps_sampled": 736, "num_env_steps_trained": 736, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.134557409465984, "num_env_steps_trained_throughput_per_sec": 6.134557409465984, "timesteps_total": 736, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 736, "timers": {"training_iteration_time_ms": 6197.937, "sample_time_ms": 6181.962, "load_time_ms": 0.105, "load_throughput": 305317.853, "learn_time_ms": 5.759, "learn_throughput": 5556.565, "synch_weights_time_ms": 10.112}, "counters": {"num_env_steps_sampled": 736, "num_env_steps_trained": 736, "num_agent_steps_sampled": 736, "num_agent_steps_trained": 736}, "done": false, "episodes_total": 28, "training_iteration": 12, "trial_id": "3fc51_00000", "date": "2024-08-11_19-12-33", "timestamp": 1723367553, "time_this_iter_s": 15.664641380310059, "time_total_s": 172.7313208580017, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 172.7313208580017, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 32.918181818181814, "ram_util_percent": 84.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.295433044433594, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 4.040092945098877, "policy_loss": -1.3109596967697144, "vf_loss": 0.3867214322090149}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 832, "num_env_steps_trained": 832, "num_agent_steps_sampled": 832, "num_agent_steps_trained": 832}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -6.817012187207668, "episode_len_mean": 25.741935483870968, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 530.3989496255097, "mean_inference_ms": 1.9650838153179537, "mean_action_processing_ms": 0.24614749883319145, "mean_env_wait_ms": 173.2895807646228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008190831830424647, "StateBufferConnector_ms": 0.00016689300537109375, "ViewRequirementAgentConnector_ms": 0.32116443880142703}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -6.817012187207668, "episode_len_mean": 25.741935483870968, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 530.3989496255097, "mean_inference_ms": 1.9650838153179537, "mean_action_processing_ms": 0.24614749883319145, "mean_env_wait_ms": 173.2895807646228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008190831830424647, "StateBufferConnector_ms": 0.00016689300537109375, "ViewRequirementAgentConnector_ms": 0.32116443880142703}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832, "num_agent_steps_trained": 832, "num_env_steps_sampled": 832, "num_env_steps_trained": 832, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.129475870894491, "num_env_steps_trained_throughput_per_sec": 7.129475870894491, "timesteps_total": 832, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 832, "timers": {"training_iteration_time_ms": 6119.812, "sample_time_ms": 6102.326, "load_time_ms": 0.201, "load_throughput": 159498.191, "learn_time_ms": 6.509, "learn_throughput": 4916.22, "synch_weights_time_ms": 10.777}, "counters": {"num_env_steps_sampled": 832, "num_env_steps_trained": 832, "num_agent_steps_sampled": 832, "num_agent_steps_trained": 832}, "done": false, "episodes_total": 31, "training_iteration": 13, "trial_id": "3fc51_00000", "date": "2024-08-11_19-12-47", "timestamp": 1723367567, "time_this_iter_s": 13.465225458145142, "time_total_s": 186.19654631614685, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 186.19654631614685, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.3, "ram_util_percent": 84.4578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.646257400512695, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.401059865951538, "policy_loss": 0.26387518644332886, "vf_loss": 0.13417582213878632}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 864, "num_env_steps_trained": 864, "num_agent_steps_sampled": 864, "num_agent_steps_trained": 864}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -6.597939632711153, "episode_len_mean": 25.71875, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 529.5676259071515, "mean_inference_ms": 1.9610595238536122, "mean_action_processing_ms": 0.24319900592179886, "mean_env_wait_ms": 170.05587941543274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007934868335723877, "StateBufferConnector_ms": 0.00016167759895324707, "ViewRequirementAgentConnector_ms": 0.31112805008888245}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -6.597939632711153, "episode_len_mean": 25.71875, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 529.5676259071515, "mean_inference_ms": 1.9610595238536122, "mean_action_processing_ms": 0.24319900592179886, "mean_env_wait_ms": 170.05587941543274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007934868335723877, "StateBufferConnector_ms": 0.00016167759895324707, "ViewRequirementAgentConnector_ms": 0.31112805008888245}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864, "num_agent_steps_trained": 864, "num_env_steps_sampled": 864, "num_env_steps_trained": 864, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.6829409720606407, "num_env_steps_trained_throughput_per_sec": 2.6829409720606407, "timesteps_total": 864, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 864, "timers": {"training_iteration_time_ms": 5709.038, "sample_time_ms": 5691.551, "load_time_ms": 0.201, "load_throughput": 159498.191, "learn_time_ms": 8.069, "learn_throughput": 3965.987, "synch_weights_time_ms": 9.217}, "counters": {"num_env_steps_sampled": 864, "num_env_steps_trained": 864, "num_agent_steps_sampled": 864, "num_agent_steps_trained": 864}, "done": false, "episodes_total": 32, "training_iteration": 14, "trial_id": "3fc51_00000", "date": "2024-08-11_19-12-59", "timestamp": 1723367579, "time_this_iter_s": 11.942836284637451, "time_total_s": 198.1393826007843, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 198.1393826007843, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.888235294117647, "ram_util_percent": 84.51764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 1.0077472925186157, "policy_loss": 0.030087139457464218, "vf_loss": 0.6912170052528381}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 928, "num_env_steps_trained": 928, "num_agent_steps_sampled": 928, "num_agent_steps_trained": 928}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -6.025373279608518, "episode_len_mean": 25.65714285714286, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 535.3383231261126, "mean_inference_ms": 1.946516470470689, "mean_action_processing_ms": 0.24063340146192214, "mean_env_wait_ms": 160.99959068796096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072547367640904015, "StateBufferConnector_ms": 0.00014781951904296875, "ViewRequirementAgentConnector_ms": 0.2844599315098354}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -6.025373279608518, "episode_len_mean": 25.65714285714286, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 535.3383231261126, "mean_inference_ms": 1.946516470470689, "mean_action_processing_ms": 0.24063340146192214, "mean_env_wait_ms": 160.99959068796096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072547367640904015, "StateBufferConnector_ms": 0.00014781951904296875, "ViewRequirementAgentConnector_ms": 0.2844599315098354}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928, "num_agent_steps_trained": 928, "num_env_steps_sampled": 928, "num_env_steps_trained": 928, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.1248328045295057, "num_env_steps_trained_throughput_per_sec": 3.1248328045295057, "timesteps_total": 928, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 928, "timers": {"training_iteration_time_ms": 7746.782, "sample_time_ms": 7729.195, "load_time_ms": 0.096, "load_throughput": 333958.019, "learn_time_ms": 8.101, "learn_throughput": 3950.299, "synch_weights_time_ms": 9.391}, "counters": {"num_env_steps_sampled": 928, "num_env_steps_trained": 928, "num_agent_steps_sampled": 928, "num_agent_steps_trained": 928}, "done": false, "episodes_total": 35, "training_iteration": 15, "trial_id": "3fc51_00000", "date": "2024-08-11_19-13-20", "timestamp": 1723367600, "time_this_iter_s": 20.490097284317017, "time_total_s": 218.62947988510132, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 218.62947988510132, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.910344827586208, "ram_util_percent": 86.53448275862068}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.970673561096191, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.6624376773834229, "policy_loss": -0.00016587713616900146, "vf_loss": 0.06846949458122253}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 960, "num_env_steps_trained": 960, "num_agent_steps_sampled": 960, "num_agent_steps_trained": 960}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -5.855671024353699, "episode_len_mean": 25.63888888888889, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 534.7690892471558, "mean_inference_ms": 1.9428323066028161, "mean_action_processing_ms": 0.23817079247876796, "mean_env_wait_ms": 158.27371304702683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007053216298421224, "StateBufferConnector_ms": 0.00014371342129177519, "ViewRequirementAgentConnector_ms": 0.2765582667456733}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -5.855671024353699, "episode_len_mean": 25.63888888888889, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 534.7690892471558, "mean_inference_ms": 1.9428323066028161, "mean_action_processing_ms": 0.23817079247876796, "mean_env_wait_ms": 158.27371304702683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007053216298421224, "StateBufferConnector_ms": 0.00014371342129177519, "ViewRequirementAgentConnector_ms": 0.2765582667456733}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960, "num_agent_steps_trained": 960, "num_env_steps_sampled": 960, "num_env_steps_trained": 960, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.1610797788776397, "num_env_steps_trained_throughput_per_sec": 2.1610797788776397, "timesteps_total": 960, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 960, "timers": {"training_iteration_time_ms": 7632.999, "sample_time_ms": 7614.456, "load_time_ms": 0.096, "load_throughput": 333958.019, "learn_time_ms": 9.509, "learn_throughput": 3365.388, "synch_weights_time_ms": 8.939}, "counters": {"num_env_steps_sampled": 960, "num_env_steps_trained": 960, "num_agent_steps_sampled": 960, "num_agent_steps_trained": 960}, "done": false, "episodes_total": 36, "training_iteration": 16, "trial_id": "3fc51_00000", "date": "2024-08-11_19-13-34", "timestamp": 1723367614, "time_this_iter_s": 14.819629192352295, "time_total_s": 233.4491090774536, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 233.4491090774536, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.08095238095238, "ram_util_percent": 87.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.3298405706882477, "policy_loss": -0.011569861322641373, "vf_loss": 1.5746514797210693}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -5.400226936250035, "episode_len_mean": 25.58974358974359, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 542.0639888318979, "mean_inference_ms": 1.935218839902738, "mean_action_processing_ms": 0.23734933413232687, "mean_env_wait_ms": 150.59129386654246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006915972783015325, "StateBufferConnector_ms": 0.0001326585427308694, "ViewRequirementAgentConnector_ms": 0.2605536045172276}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -5.400226936250035, "episode_len_mean": 25.58974358974359, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 542.0639888318979, "mean_inference_ms": 1.935218839902738, "mean_action_processing_ms": 0.23734933413232687, "mean_env_wait_ms": 150.59129386654246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006915972783015325, "StateBufferConnector_ms": 0.0001326585427308694, "ViewRequirementAgentConnector_ms": 0.2605536045172276}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 2.793785634665609, "num_env_steps_trained_throughput_per_sec": 2.793785634665609, "timesteps_total": 1024, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 9915.532, "sample_time_ms": 9896.435, "load_time_ms": 0.197, "load_throughput": 162846.066, "learn_time_ms": 11.007, "learn_throughput": 2907.285, "synch_weights_time_ms": 7.894}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 39, "training_iteration": 17, "trial_id": "3fc51_00000", "date": "2024-08-11_19-13-57", "timestamp": 1723367637, "time_this_iter_s": 22.921443939208984, "time_total_s": 256.3705530166626, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 256.3705530166626, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.29375, "ram_util_percent": 88.24687499999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3661227226257324, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.24565929174423218, "policy_loss": -0.0015398981049656868, "vf_loss": 0.0026527203153818846}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 1056, "num_env_steps_trained": 1056, "num_agent_steps_sampled": 1056, "num_agent_steps_trained": 1056}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -5.263563333915723, "episode_len_mean": 25.575, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 541.8109745484792, "mean_inference_ms": 1.9336700756899756, "mean_action_processing_ms": 0.23543992645570277, "mean_env_wait_ms": 148.25591326846416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006743073463439941, "StateBufferConnector_ms": 0.00012934207916259766, "ViewRequirementAgentConnector_ms": 0.25705277919769287}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -5.263563333915723, "episode_len_mean": 25.575, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 541.8109745484792, "mean_inference_ms": 1.9336700756899756, "mean_action_processing_ms": 0.23543992645570277, "mean_env_wait_ms": 148.25591326846416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006743073463439941, "StateBufferConnector_ms": 0.00012934207916259766, "ViewRequirementAgentConnector_ms": 0.25705277919769287}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056, "num_agent_steps_trained": 1056, "num_env_steps_sampled": 1056, "num_env_steps_trained": 1056, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 1.8917227076571852, "num_env_steps_trained_throughput_per_sec": 1.8917227076571852, "timesteps_total": 1056, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1056, "timers": {"training_iteration_time_ms": 10050.473, "sample_time_ms": 10031.635, "load_time_ms": 0.197, "load_throughput": 162846.066, "learn_time_ms": 9.877, "learn_throughput": 3239.799, "synch_weights_time_ms": 8.764}, "counters": {"num_env_steps_sampled": 1056, "num_env_steps_trained": 1056, "num_agent_steps_sampled": 1056, "num_agent_steps_trained": 1056}, "done": false, "episodes_total": 40, "training_iteration": 18, "trial_id": "3fc51_00000", "date": "2024-08-11_19-14-14", "timestamp": 1723367654, "time_this_iter_s": 16.92482829093933, "time_total_s": 273.29538130760193, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 273.29538130760193, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 11.862500000000002, "ram_util_percent": 88.00416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.1516914665699005, "policy_loss": 0.005058576352894306, "vf_loss": 1.8414113521575928}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 1120, "num_env_steps_trained": 1120, "num_agent_steps_sampled": 1120, "num_agent_steps_trained": 1120}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.893008699897505, "episode_len_mean": 25.53488372093023, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 550.2405507351374, "mean_inference_ms": 1.9292180174239346, "mean_action_processing_ms": 0.2354671348415294, "mean_env_wait_ms": 141.6400225425576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062726264776185505, "StateBufferConnector_ms": 0.00012031821317450945, "ViewRequirementAgentConnector_ms": 0.25757911593415017}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.893008699897505, "episode_len_mean": 25.53488372093023, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 550.2405507351374, "mean_inference_ms": 1.9292180174239346, "mean_action_processing_ms": 0.2354671348415294, "mean_env_wait_ms": 141.6400225425576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062726264776185505, "StateBufferConnector_ms": 0.00012031821317450945, "ViewRequirementAgentConnector_ms": 0.25757911593415017}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120, "num_agent_steps_trained": 1120, "num_env_steps_sampled": 1120, "num_env_steps_trained": 1120, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 2.6123045109153096, "num_env_steps_trained_throughput_per_sec": 2.6123045109153096, "timesteps_total": 1120, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 1120, "timers": {"training_iteration_time_ms": 12490.75, "sample_time_ms": 12471.878, "load_time_ms": 0.251, "load_throughput": 127268.849, "learn_time_ms": 8.715, "learn_throughput": 3671.786, "synch_weights_time_ms": 9.905}, "counters": {"num_env_steps_sampled": 1120, "num_env_steps_trained": 1120, "num_agent_steps_sampled": 1120, "num_agent_steps_trained": 1120}, "done": false, "episodes_total": 43, "training_iteration": 19, "trial_id": "3fc51_00000", "date": "2024-08-11_19-14-39", "timestamp": 1723367679, "time_this_iter_s": 24.514084815979004, "time_total_s": 297.80946612358093, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 297.80946612358093, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.099999999999994, "ram_util_percent": 88.48235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.830036163330078, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.1235964298248291, "policy_loss": 0.001260504825040698, "vf_loss": 0.09602149575948715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 1152, "num_env_steps_trained": 1152, "num_agent_steps_sampled": 1152, "num_agent_steps_trained": 1152}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.780691316660998, "episode_len_mean": 25.522727272727273, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 549.948593248506, "mean_inference_ms": 1.9284546493782564, "mean_action_processing_ms": 0.23401047915615064, "mean_env_wait_ms": 139.6128457276952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006130066784945401, "StateBufferConnector_ms": 0.00011758370832963423, "ViewRequirementAgentConnector_ms": 0.2540003169666637}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.780691316660998, "episode_len_mean": 25.522727272727273, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 549.948593248506, "mean_inference_ms": 1.9284546493782564, "mean_action_processing_ms": 0.23401047915615064, "mean_env_wait_ms": 139.6128457276952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006130066784945401, "StateBufferConnector_ms": 0.00011758370832963423, "ViewRequirementAgentConnector_ms": 0.2540003169666637}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152, "num_agent_steps_trained": 1152, "num_env_steps_sampled": 1152, "num_env_steps_trained": 1152, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.2259793367839196, "num_env_steps_trained_throughput_per_sec": 2.2259793367839196, "timesteps_total": 1152, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1152, "timers": {"training_iteration_time_ms": 12591.364, "sample_time_ms": 12574.101, "load_time_ms": 0.251, "load_throughput": 127268.849, "learn_time_ms": 7.864, "learn_throughput": 4069.127, "synch_weights_time_ms": 9.147}, "counters": {"num_env_steps_sampled": 1152, "num_env_steps_trained": 1152, "num_agent_steps_sampled": 1152, "num_agent_steps_trained": 1152}, "done": false, "episodes_total": 44, "training_iteration": 20, "trial_id": "3fc51_00000", "date": "2024-08-11_19-14-54", "timestamp": 1723367694, "time_this_iter_s": 14.384735107421875, "time_total_s": 312.1942012310028, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 312.1942012310028, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.445, "ram_util_percent": 90.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.08802008628845215, "policy_loss": -0.0015178394969552755, "vf_loss": 0.8217605352401733}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 1216, "num_env_steps_trained": 1216, "num_agent_steps_sampled": 1216, "num_agent_steps_trained": 1216}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.673609718270914, "episode_len_mean": 25.511111111111113, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 552.024513210014, "mean_inference_ms": 1.9291250851992845, "mean_action_processing_ms": 0.2361087036696892, "mean_env_wait_ms": 137.60197913915562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006328688727484809, "StateBufferConnector_ms": 0.0022951761881510415, "ViewRequirementAgentConnector_ms": 0.2572398715549045}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.673609718270914, "episode_len_mean": 25.511111111111113, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 552.024513210014, "mean_inference_ms": 1.9291250851992845, "mean_action_processing_ms": 0.2361087036696892, "mean_env_wait_ms": 137.60197913915562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006328688727484809, "StateBufferConnector_ms": 0.0022951761881510415, "ViewRequirementAgentConnector_ms": 0.2572398715549045}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216, "num_agent_steps_trained": 1216, "num_env_steps_sampled": 1216, "num_env_steps_trained": 1216, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 4.755805031866506, "num_env_steps_trained_throughput_per_sec": 4.755805031866506, "timesteps_total": 1216, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 1216, "timers": {"training_iteration_time_ms": 12739.57, "sample_time_ms": 12721.695, "load_time_ms": 0.302, "load_throughput": 105950.212, "learn_time_ms": 8.079, "learn_throughput": 3961.001, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 1216, "num_env_steps_trained": 1216, "num_agent_steps_sampled": 1216, "num_agent_steps_trained": 1216}, "done": false, "episodes_total": 45, "training_iteration": 21, "trial_id": "3fc51_00000", "date": "2024-08-11_19-15-08", "timestamp": 1723367708, "time_this_iter_s": 13.465566158294678, "time_total_s": 325.6597673892975, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 325.6597673892975, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 10.135000000000002, "ram_util_percent": 89.91999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.632478713989258, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.07543376833200455, "policy_loss": -0.000931093527469784, "vf_loss": 0.2641664743423462}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 1248, "num_env_steps_trained": 1248, "num_agent_steps_sampled": 1248, "num_agent_steps_trained": 1248}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.378885512515815, "episode_len_mean": 25.479166666666668, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 556.9697052112634, "mean_inference_ms": 1.927826978228767, "mean_action_processing_ms": 0.23301972520447264, "mean_env_wait_ms": 132.01313895628755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008257230122884115, "StateBufferConnector_ms": 0.006284316380818685, "ViewRequirementAgentConnector_ms": 0.25916645924250287}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.378885512515815, "episode_len_mean": 25.479166666666668, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 556.9697052112634, "mean_inference_ms": 1.927826978228767, "mean_action_processing_ms": 0.23301972520447264, "mean_env_wait_ms": 132.01313895628755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008257230122884115, "StateBufferConnector_ms": 0.006284316380818685, "ViewRequirementAgentConnector_ms": 0.25916645924250287}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248, "num_agent_steps_trained": 1248, "num_env_steps_sampled": 1248, "num_env_steps_trained": 1248, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 1.5505833588119526, "num_env_steps_trained_throughput_per_sec": 1.5505833588119526, "timesteps_total": 1248, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1248, "timers": {"training_iteration_time_ms": 12759.996, "sample_time_ms": 12742.978, "load_time_ms": 0.302, "load_throughput": 105950.212, "learn_time_ms": 7.278, "learn_throughput": 4396.588, "synch_weights_time_ms": 9.433}, "counters": {"num_env_steps_sampled": 1248, "num_env_steps_trained": 1248, "num_agent_steps_sampled": 1248, "num_agent_steps_trained": 1248}, "done": false, "episodes_total": 48, "training_iteration": 22, "trial_id": "3fc51_00000", "date": "2024-08-11_19-15-28", "timestamp": 1723367728, "time_this_iter_s": 20.646950006484985, "time_total_s": 346.30671739578247, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 346.30671739578247, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 22.817241379310346, "ram_util_percent": 88.83448275862068}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.75243377685547, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.052202269434928894, "policy_loss": 0.0008125011227093637, "vf_loss": 0.5690914392471313}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.03945475165574, "episode_len_mean": 25.442307692307693, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 562.9694442276287, "mean_inference_ms": 1.929070091347661, "mean_action_processing_ms": 0.2330020070428778, "mean_env_wait_ms": 125.29611161820367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007622058574969952, "StateBufferConnector_ms": 0.005800907428448017, "ViewRequirementAgentConnector_ms": 0.25848883848923904}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -4.03945475165574, "episode_len_mean": 25.442307692307693, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 562.9694442276287, "mean_inference_ms": 1.929070091347661, "mean_action_processing_ms": 0.2330020070428778, "mean_env_wait_ms": 125.29611161820367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007622058574969952, "StateBufferConnector_ms": 0.005800907428448017, "ViewRequirementAgentConnector_ms": 0.25848883848923904}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.573656173261612, "num_env_steps_trained_throughput_per_sec": 5.573656173261612, "timesteps_total": 1344, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 10710.845, "sample_time_ms": 10693.605, "load_time_ms": 0.201, "load_throughput": 158931.59, "learn_time_ms": 8.02, "learn_throughput": 3990.264, "synch_weights_time_ms": 9.013}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 52, "training_iteration": 23, "trial_id": "3fc51_00000", "date": "2024-08-11_19-15-46", "timestamp": 1723367746, "time_this_iter_s": 17.234402179718018, "time_total_s": 363.5411195755005, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 363.5411195755005, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 26.06, "ram_util_percent": 88.75599999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.04164011403918266, "policy_loss": -0.0008294038707390428, "vf_loss": 1.0516842603683472}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.7488210833937416, "episode_len_mean": 25.410714285714285, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 568.548850595478, "mean_inference_ms": 1.9313188441322597, "mean_action_processing_ms": 0.23290092297606216, "mean_env_wait_ms": 119.32738483046344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008865765162876673, "StateBufferConnector_ms": 0.005386556897844587, "ViewRequirementAgentConnector_ms": 0.25984644889831543}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.7488210833937416, "episode_len_mean": 25.410714285714285, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 568.548850595478, "mean_inference_ms": 1.9313188441322597, "mean_action_processing_ms": 0.23290092297606216, "mean_env_wait_ms": 119.32738483046344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008865765162876673, "StateBufferConnector_ms": 0.005386556897844587, "ViewRequirementAgentConnector_ms": 0.25984644889831543}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.404802608008384, "num_env_steps_trained_throughput_per_sec": 5.404802608008384, "timesteps_total": 1440, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 1440, "timers": {"training_iteration_time_ms": 8345.519, "sample_time_ms": 8327.734, "load_time_ms": 0.251, "load_throughput": 127619.785, "learn_time_ms": 8.509, "learn_throughput": 3760.664, "synch_weights_time_ms": 8.919}, "counters": {"num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "done": false, "episodes_total": 56, "training_iteration": 24, "trial_id": "3fc51_00000", "date": "2024-08-11_19-16-03", "timestamp": 1723367763, "time_this_iter_s": 17.770145654678345, "time_total_s": 381.31126523017883, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 381.31126523017883, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 26.796000000000003, "ram_util_percent": 88.584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.03689531981945038, "policy_loss": 0.0007611954933963716, "vf_loss": 1.1636180877685547}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.4971898178460608, "episode_len_mean": 25.383333333333333, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 574.4882541139118, "mean_inference_ms": 1.9326282878500907, "mean_action_processing_ms": 0.23263102282154202, "mean_env_wait_ms": 113.9818063338103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009942452112833658, "StateBufferConnector_ms": 0.005027453104654948, "ViewRequirementAgentConnector_ms": 0.2575377623240153}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.4971898178460608, "episode_len_mean": 25.383333333333333, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 574.4882541139118, "mean_inference_ms": 1.9326282878500907, "mean_action_processing_ms": 0.23263102282154202, "mean_env_wait_ms": 113.9818063338103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009942452112833658, "StateBufferConnector_ms": 0.005027453104654948, "ViewRequirementAgentConnector_ms": 0.2575377623240153}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.3567993643591985, "num_env_steps_trained_throughput_per_sec": 4.3567993643591985, "timesteps_total": 1536, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 7765.778, "sample_time_ms": 7748.805, "load_time_ms": 0.3, "load_throughput": 106522.006, "learn_time_ms": 7.947, "learn_throughput": 4026.705, "synch_weights_time_ms": 8.626}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 60, "training_iteration": 25, "trial_id": "3fc51_00000", "date": "2024-08-11_19-16-25", "timestamp": 1723367785, "time_this_iter_s": 22.045295238494873, "time_total_s": 403.3565604686737, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 403.3565604686737, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 21.296774193548384, "ram_util_percent": 87.96774193548387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.03418189659714699, "policy_loss": -0.0005305036902427673, "vf_loss": 0.7958698868751526}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 1632, "num_env_steps_trained": 1632, "num_agent_steps_sampled": 1632, "num_agent_steps_trained": 1632}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.3296123040182573, "episode_len_mean": 25.365079365079364, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 579.9478114650191, "mean_inference_ms": 1.9346044639677227, "mean_action_processing_ms": 0.2336450363986836, "mean_env_wait_ms": 110.3051050623495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009469002012222533, "StateBufferConnector_ms": 0.004788050575861855, "ViewRequirementAgentConnector_ms": 0.2589180355980283}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.3296123040182573, "episode_len_mean": 25.365079365079364, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 579.9478114650191, "mean_inference_ms": 1.9346044639677227, "mean_action_processing_ms": 0.2336450363986836, "mean_env_wait_ms": 110.3051050623495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009469002012222533, "StateBufferConnector_ms": 0.004788050575861855, "ViewRequirementAgentConnector_ms": 0.2589180355980283}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632, "num_agent_steps_trained": 1632, "num_env_steps_sampled": 1632, "num_env_steps_trained": 1632, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.43777391382168, "num_env_steps_trained_throughput_per_sec": 4.43777391382168, "timesteps_total": 1632, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 1632, "timers": {"training_iteration_time_ms": 7852.747, "sample_time_ms": 7834.531, "load_time_ms": 0.49, "load_throughput": 65249.26, "learn_time_ms": 8.718, "learn_throughput": 3670.601, "synch_weights_time_ms": 8.807}, "counters": {"num_env_steps_sampled": 1632, "num_env_steps_trained": 1632, "num_agent_steps_sampled": 1632, "num_agent_steps_trained": 1632}, "done": false, "episodes_total": 63, "training_iteration": 26, "trial_id": "3fc51_00000", "date": "2024-08-11_19-16-47", "timestamp": 1723367807, "time_this_iter_s": 21.64229655265808, "time_total_s": 424.9988570213318, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 424.9988570213318, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.66, "ram_util_percent": 88.39000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.626045227050781, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.032852839678525925, "policy_loss": -0.00020990996563341469, "vf_loss": 0.04391511157155037}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 1664, "num_env_steps_trained": 1664, "num_agent_steps_sampled": 1664, "num_agent_steps_trained": 1664}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.2772376106124015, "episode_len_mean": 25.359375, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 580.2040468265498, "mean_inference_ms": 1.935390847523501, "mean_action_processing_ms": 0.23278838976429933, "mean_env_wait_ms": 109.15046713072547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010824203491210938, "StateBufferConnector_ms": 0.004713237285614014, "ViewRequirementAgentConnector_ms": 0.2614196389913559}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.2772376106124015, "episode_len_mean": 25.359375, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 580.2040468265498, "mean_inference_ms": 1.935390847523501, "mean_action_processing_ms": 0.23278838976429933, "mean_env_wait_ms": 109.15046713072547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010824203491210938, "StateBufferConnector_ms": 0.004713237285614014, "ViewRequirementAgentConnector_ms": 0.2614196389913559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664, "num_agent_steps_trained": 1664, "num_env_steps_sampled": 1664, "num_env_steps_trained": 1664, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 1.8398431257015617, "num_env_steps_trained_throughput_per_sec": 1.8398431257015617, "timesteps_total": 1664, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1664, "timers": {"training_iteration_time_ms": 7882.176, "sample_time_ms": 7864.865, "load_time_ms": 0.49, "load_throughput": 65249.26, "learn_time_ms": 7.965, "learn_throughput": 4017.593, "synch_weights_time_ms": 8.654}, "counters": {"num_env_steps_sampled": 1664, "num_env_steps_trained": 1664, "num_agent_steps_sampled": 1664, "num_agent_steps_trained": 1664}, "done": false, "episodes_total": 64, "training_iteration": 27, "trial_id": "3fc51_00000", "date": "2024-08-11_19-17-05", "timestamp": 1723367825, "time_this_iter_s": 17.40138339996338, "time_total_s": 442.40024042129517, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 442.40024042129517, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 12.636, "ram_util_percent": 88.736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.030748195946216583, "policy_loss": 0.00045125538599677384, "vf_loss": 0.6865590214729309}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 1728, "num_env_steps_trained": 1728, "num_agent_steps_sampled": 1728, "num_agent_steps_trained": 1728}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.1296273927314204, "episode_len_mean": 25.34328358208955, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 585.1621449744317, "mean_inference_ms": 1.9369659894580067, "mean_action_processing_ms": 0.23421317748879775, "mean_env_wait_ms": 105.81890986746335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010339537663246268, "StateBufferConnector_ms": 0.004502196810138759, "ViewRequirementAgentConnector_ms": 0.2572248231119184}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.1296273927314204, "episode_len_mean": 25.34328358208955, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 585.1621449744317, "mean_inference_ms": 1.9369659894580067, "mean_action_processing_ms": 0.23421317748879775, "mean_env_wait_ms": 105.81890986746335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010339537663246268, "StateBufferConnector_ms": 0.004502196810138759, "ViewRequirementAgentConnector_ms": 0.2572248231119184}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728, "num_agent_steps_trained": 1728, "num_env_steps_sampled": 1728, "num_env_steps_trained": 1728, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.66128772604255, "num_env_steps_trained_throughput_per_sec": 3.66128772604255, "timesteps_total": 1728, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 1728, "timers": {"training_iteration_time_ms": 9617.273, "sample_time_ms": 9600.381, "load_time_ms": 0.39, "load_throughput": 81985.052, "learn_time_ms": 7.668, "learn_throughput": 4173.203, "synch_weights_time_ms": 8.733}, "counters": {"num_env_steps_sampled": 1728, "num_env_steps_trained": 1728, "num_agent_steps_sampled": 1728, "num_agent_steps_trained": 1728}, "done": false, "episodes_total": 67, "training_iteration": 28, "trial_id": "3fc51_00000", "date": "2024-08-11_19-17-22", "timestamp": 1723367842, "time_this_iter_s": 17.48857855796814, "time_total_s": 459.8888189792633, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 459.8888189792633, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 19.67083333333333, "ram_util_percent": 88.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.122507095336914, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.03012526035308838, "policy_loss": 0.00015387347957585007, "vf_loss": 0.021704627200961113}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 1760, "num_env_steps_trained": 1760, "num_agent_steps_sampled": 1760, "num_agent_steps_trained": 1760}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.0833131811748125, "episode_len_mean": 25.33823529411765, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 585.3775395754701, "mean_inference_ms": 1.9374766489242583, "mean_action_processing_ms": 0.23350946329348496, "mean_env_wait_ms": 104.76912376078043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010187485638786764, "StateBufferConnector_ms": 0.004435988033519071, "ViewRequirementAgentConnector_ms": 0.25786932776955995}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -3.0833131811748125, "episode_len_mean": 25.33823529411765, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 585.3775395754701, "mean_inference_ms": 1.9374766489242583, "mean_action_processing_ms": 0.23350946329348496, "mean_env_wait_ms": 104.76912376078043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010187485638786764, "StateBufferConnector_ms": 0.004435988033519071, "ViewRequirementAgentConnector_ms": 0.25786932776955995}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760, "num_agent_steps_trained": 1760, "num_env_steps_sampled": 1760, "num_env_steps_trained": 1760, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.0170062867131753, "num_env_steps_trained_throughput_per_sec": 2.0170062867131753, "timesteps_total": 1760, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1760, "timers": {"training_iteration_time_ms": 9440.409, "sample_time_ms": 9423.263, "load_time_ms": 0.394, "load_throughput": 81319.435, "learn_time_ms": 7.768, "learn_throughput": 4119.294, "synch_weights_time_ms": 8.883}, "counters": {"num_env_steps_sampled": 1760, "num_env_steps_trained": 1760, "num_agent_steps_sampled": 1760, "num_agent_steps_trained": 1760}, "done": false, "episodes_total": 68, "training_iteration": 29, "trial_id": "3fc51_00000", "date": "2024-08-11_19-17-38", "timestamp": 1723367858, "time_this_iter_s": 15.873454570770264, "time_total_s": 475.76227355003357, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 475.76227355003357, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.417391304347827, "ram_util_percent": 88.07826086956521}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.029317937791347504, "policy_loss": -0.0004771955718751997, "vf_loss": 0.7476001381874084}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 1824, "num_env_steps_trained": 1824, "num_agent_steps_sampled": 1824, "num_agent_steps_trained": 1824}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.95229460129779, "episode_len_mean": 25.323943661971832, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 590.0583511041166, "mean_inference_ms": 1.9393554444490662, "mean_action_processing_ms": 0.23488256777653566, "mean_env_wait_ms": 101.73372671715823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009757028499119719, "StateBufferConnector_ms": 0.004248551919426717, "ViewRequirementAgentConnector_ms": 0.2611667337551923}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.95229460129779, "episode_len_mean": 25.323943661971832, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 590.0583511041166, "mean_inference_ms": 1.9393554444490662, "mean_action_processing_ms": 0.23488256777653566, "mean_env_wait_ms": 101.73372671715823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009757028499119719, "StateBufferConnector_ms": 0.004248551919426717, "ViewRequirementAgentConnector_ms": 0.2611667337551923}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824, "num_agent_steps_trained": 1824, "num_env_steps_sampled": 1824, "num_env_steps_trained": 1824, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.358710343502763, "num_env_steps_trained_throughput_per_sec": 3.358710343502763, "timesteps_total": 1824, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 1824, "timers": {"training_iteration_time_ms": 11338.409, "sample_time_ms": 11320.701, "load_time_ms": 0.493, "load_throughput": 64848.881, "learn_time_ms": 8.095, "learn_throughput": 3953.208, "synch_weights_time_ms": 9.018}, "counters": {"num_env_steps_sampled": 1824, "num_env_steps_trained": 1824, "num_agent_steps_sampled": 1824, "num_agent_steps_trained": 1824}, "done": false, "episodes_total": 71, "training_iteration": 30, "trial_id": "3fc51_00000", "date": "2024-08-11_19-17-57", "timestamp": 1723367877, "time_this_iter_s": 19.063515663146973, "time_total_s": 494.82578921318054, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 494.82578921318054, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.953846153846154, "ram_util_percent": 87.97307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.714046001434326, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.029215097427368164, "policy_loss": -0.00011365520185790956, "vf_loss": 0.005083642899990082}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 1856, "num_env_steps_trained": 1856, "num_agent_steps_sampled": 1856, "num_agent_steps_trained": 1856}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.9110439861605837, "episode_len_mean": 25.319444444444443, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 590.2093417643379, "mean_inference_ms": 1.9396174803638226, "mean_action_processing_ms": 0.23416831943959857, "mean_env_wait_ms": 100.77440676373061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009621514214409722, "StateBufferConnector_ms": 0.005522039201524522, "ViewRequirementAgentConnector_ms": 0.26320450835757786}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.9110439861605837, "episode_len_mean": 25.319444444444443, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 590.2093417643379, "mean_inference_ms": 1.9396174803638226, "mean_action_processing_ms": 0.23416831943959857, "mean_env_wait_ms": 100.77440676373061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009621514214409722, "StateBufferConnector_ms": 0.005522039201524522, "ViewRequirementAgentConnector_ms": 0.26320450835757786}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856, "num_agent_steps_trained": 1856, "num_env_steps_sampled": 1856, "num_env_steps_trained": 1856, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.140937756500752, "num_env_steps_trained_throughput_per_sec": 2.140937756500752, "timesteps_total": 1856, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1856, "timers": {"training_iteration_time_ms": 10637.122, "sample_time_ms": 10619.842, "load_time_ms": 0.493, "load_throughput": 64880.228, "learn_time_ms": 7.548, "learn_throughput": 4239.267, "synch_weights_time_ms": 9.137}, "counters": {"num_env_steps_sampled": 1856, "num_env_steps_trained": 1856, "num_agent_steps_sampled": 1856, "num_agent_steps_trained": 1856}, "done": false, "episodes_total": 72, "training_iteration": 31, "trial_id": "3fc51_00000", "date": "2024-08-11_19-18-13", "timestamp": 1723367893, "time_this_iter_s": 14.955365657806396, "time_total_s": 509.78115487098694, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 509.78115487098694, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 10.272727272727273, "ram_util_percent": 88.5590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.029262971132993698, "policy_loss": 0.0005414533661678433, "vf_loss": 0.8331402540206909}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.7939782790207364, "episode_len_mean": 25.30666666666667, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 594.7199954820007, "mean_inference_ms": 1.9416396773626874, "mean_action_processing_ms": 0.23549424522187598, "mean_env_wait_ms": 97.99523929546817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009328524271647135, "StateBufferConnector_ms": 0.006635030110677083, "ViewRequirementAgentConnector_ms": 0.2593851089477539}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.7939782790207364, "episode_len_mean": 25.30666666666667, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 594.7199954820007, "mean_inference_ms": 1.9416396773626874, "mean_action_processing_ms": 0.23549424522187598, "mean_env_wait_ms": 97.99523929546817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009328524271647135, "StateBufferConnector_ms": 0.006635030110677083, "ViewRequirementAgentConnector_ms": 0.2593851089477539}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920, "num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.1673331091085317, "num_env_steps_trained_throughput_per_sec": 3.1673331091085317, "timesteps_total": 1920, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 1920, "timers": {"training_iteration_time_ms": 12644.734, "sample_time_ms": 12628.355, "load_time_ms": 0.393, "load_throughput": 81398.343, "learn_time_ms": 6.776, "learn_throughput": 4722.617, "synch_weights_time_ms": 9.21}, "counters": {"num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920}, "done": false, "episodes_total": 75, "training_iteration": 32, "trial_id": "3fc51_00000", "date": "2024-08-11_19-18-33", "timestamp": 1723367913, "time_this_iter_s": 20.23053216934204, "time_total_s": 530.011687040329, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 530.011687040329, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.355172413793102, "ram_util_percent": 88.32068965517243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31024235486984253, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.029426921159029007, "policy_loss": 9.010509529616684e-05, "vf_loss": 3.658458444988355e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 1952, "num_env_steps_trained": 1952, "num_agent_steps_sampled": 1952, "num_agent_steps_trained": 1952}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.7570070423908124, "episode_len_mean": 25.30263157894737, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 594.835773068612, "mean_inference_ms": 1.9418737050794934, "mean_action_processing_ms": 0.23496766921387038, "mean_env_wait_ms": 97.11450922793524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009205780531230726, "StateBufferConnector_ms": 0.006547727082905017, "ViewRequirementAgentConnector_ms": 0.261984059685155}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.7570070423908124, "episode_len_mean": 25.30263157894737, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 594.835773068612, "mean_inference_ms": 1.9418737050794934, "mean_action_processing_ms": 0.23496766921387038, "mean_env_wait_ms": 97.11450922793524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009205780531230726, "StateBufferConnector_ms": 0.006547727082905017, "ViewRequirementAgentConnector_ms": 0.261984059685155}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952, "num_agent_steps_trained": 1952, "num_env_steps_sampled": 1952, "num_env_steps_trained": 1952, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.0352992247580524, "num_env_steps_trained_throughput_per_sec": 2.0352992247580524, "timesteps_total": 1952, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1952, "timers": {"training_iteration_time_ms": 12066.753, "sample_time_ms": 12050.254, "load_time_ms": 0.303, "load_throughput": 105541.974, "learn_time_ms": 6.952, "learn_throughput": 4602.976, "synch_weights_time_ms": 9.198}, "counters": {"num_env_steps_sampled": 1952, "num_env_steps_trained": 1952, "num_agent_steps_sampled": 1952, "num_agent_steps_trained": 1952}, "done": false, "episodes_total": 76, "training_iteration": 33, "trial_id": "3fc51_00000", "date": "2024-08-11_19-18-49", "timestamp": 1723367929, "time_this_iter_s": 15.733169555664062, "time_total_s": 545.744856595993, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 545.744856595993, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.313636363636364, "ram_util_percent": 88.17272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.44694137573242, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.03004630096256733, "policy_loss": -0.0003852010704576969, "vf_loss": 0.46655938029289246}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.7210186191736723, "episode_len_mean": 25.2987012987013, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 596.0034320146591, "mean_inference_ms": 1.9428045316328026, "mean_action_processing_ms": 0.23576397839841112, "mean_env_wait_ms": 96.23943024373229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009086224939916041, "StateBufferConnector_ms": 0.006462691666243912, "ViewRequirementAgentConnector_ms": 0.2665504232629553}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.7210186191736723, "episode_len_mean": 25.2987012987013, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 596.0034320146591, "mean_inference_ms": 1.9428045316328026, "mean_action_processing_ms": 0.23576397839841112, "mean_env_wait_ms": 96.23943024373229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009086224939916041, "StateBufferConnector_ms": 0.006462691666243912, "ViewRequirementAgentConnector_ms": 0.2665504232629553}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.7984099188457483, "num_env_steps_trained_throughput_per_sec": 3.7984099188457483, "timesteps_total": 2016, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 12006.699, "sample_time_ms": 11990.294, "load_time_ms": 0.303, "load_throughput": 105541.974, "learn_time_ms": 6.789, "learn_throughput": 4713.214, "synch_weights_time_ms": 9.268}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 77, "training_iteration": 34, "trial_id": "3fc51_00000", "date": "2024-08-11_19-19-06", "timestamp": 1723367946, "time_this_iter_s": 16.858736991882324, "time_total_s": 562.6035935878754, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 562.6035935878754, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 9.756521739130434, "ram_util_percent": 87.78260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2317166328430176, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.030734384432435036, "policy_loss": -0.00012586220691446215, "vf_loss": 0.00416986271739006}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.6184347458596298, "episode_len_mean": 25.2875, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 599.0537269749545, "mean_inference_ms": 1.9442365301603406, "mean_action_processing_ms": 0.23556998176338984, "mean_env_wait_ms": 93.73551436900289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011243224143981934, "StateBufferConnector_ms": 0.006220340728759766, "ViewRequirementAgentConnector_ms": 0.26575803756713867}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.6184347458596298, "episode_len_mean": 25.2875, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 599.0537269749545, "mean_inference_ms": 1.9442365301603406, "mean_action_processing_ms": 0.23556998176338984, "mean_env_wait_ms": 93.73551436900289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011243224143981934, "StateBufferConnector_ms": 0.006220340728759766, "ViewRequirementAgentConnector_ms": 0.26575803756713867}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 1.5322954426590716, "num_env_steps_trained_throughput_per_sec": 1.5322954426590716, "timesteps_total": 2048, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 12352.839, "sample_time_ms": 12336.598, "load_time_ms": 0.303, "load_throughput": 105541.974, "learn_time_ms": 6.686, "learn_throughput": 4785.816, "synch_weights_time_ms": 9.206}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 80, "training_iteration": 35, "trial_id": "3fc51_00000", "date": "2024-08-11_19-19-27", "timestamp": 1723367967, "time_this_iter_s": 20.89074420928955, "time_total_s": 583.4943377971649, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 583.4943377971649, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.646666666666665, "ram_util_percent": 87.79}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.711593627929688, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.0333014652132988, "policy_loss": 0.0002802207018248737, "vf_loss": 0.11523924767971039}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 2144, "num_env_steps_trained": 2144, "num_agent_steps_sampled": 2144, "num_agent_steps_trained": 2144}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.493109430685092, "episode_len_mean": 25.273809523809526, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 603.210871201377, "mean_inference_ms": 1.9463649528223546, "mean_action_processing_ms": 0.23610443121166436, "mean_env_wait_ms": 90.61050176273834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010707832518078032, "StateBufferConnector_ms": 0.0059241340273902526, "ViewRequirementAgentConnector_ms": 0.26903975577581496}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.493109430685092, "episode_len_mean": 25.273809523809526, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 603.210871201377, "mean_inference_ms": 1.9463649528223546, "mean_action_processing_ms": 0.23610443121166436, "mean_env_wait_ms": 90.61050176273834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010707832518078032, "StateBufferConnector_ms": 0.0059241340273902526, "ViewRequirementAgentConnector_ms": 0.26903975577581496}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144, "num_agent_steps_trained": 2144, "num_env_steps_sampled": 2144, "num_env_steps_trained": 2144, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.414834744936297, "num_env_steps_trained_throughput_per_sec": 4.414834744936297, "timesteps_total": 2144, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2144, "timers": {"training_iteration_time_ms": 11035.322, "sample_time_ms": 11018.593, "load_time_ms": 0.472, "load_throughput": 67834.695, "learn_time_ms": 6.964, "learn_throughput": 4594.924, "synch_weights_time_ms": 9.249}, "counters": {"num_env_steps_sampled": 2144, "num_env_steps_trained": 2144, "num_agent_steps_sampled": 2144, "num_agent_steps_trained": 2144}, "done": false, "episodes_total": 84, "training_iteration": 36, "trial_id": "3fc51_00000", "date": "2024-08-11_19-19-48", "timestamp": 1723367988, "time_this_iter_s": 21.75430417060852, "time_total_s": 605.2486419677734, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 605.2486419677734, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 21.643333333333327, "ram_util_percent": 88.20333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.497764587402344, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.035987548530101776, "policy_loss": -0.0004762447497341782, "vf_loss": 0.38133788108825684}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 2240, "num_env_steps_trained": 2240, "num_agent_steps_sampled": 2240, "num_agent_steps_trained": 2240}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.3792247692360453, "episode_len_mean": 25.261363636363637, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 607.4011144485416, "mean_inference_ms": 1.9485051695239244, "mean_action_processing_ms": 0.23656536414876353, "mean_env_wait_ms": 87.71530877979217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012425671924244274, "StateBufferConnector_ms": 0.006792220202359286, "ViewRequirementAgentConnector_ms": 0.2668359062888406}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.3792247692360453, "episode_len_mean": 25.261363636363637, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 607.4011144485416, "mean_inference_ms": 1.9485051695239244, "mean_action_processing_ms": 0.23656536414876353, "mean_env_wait_ms": 87.71530877979217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012425671924244274, "StateBufferConnector_ms": 0.006792220202359286, "ViewRequirementAgentConnector_ms": 0.2668359062888406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240, "num_agent_steps_trained": 2240, "num_env_steps_sampled": 2240, "num_env_steps_trained": 2240, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.394628325597637, "num_env_steps_trained_throughput_per_sec": 4.394628325597637, "timesteps_total": 2240, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2240, "timers": {"training_iteration_time_ms": 9704.508, "sample_time_ms": 9687.827, "load_time_ms": 0.586, "load_throughput": 54582.24, "learn_time_ms": 7.107, "learn_throughput": 4502.394, "synch_weights_time_ms": 8.943}, "counters": {"num_env_steps_sampled": 2240, "num_env_steps_trained": 2240, "num_agent_steps_sampled": 2240, "num_agent_steps_trained": 2240}, "done": false, "episodes_total": 88, "training_iteration": 37, "trial_id": "3fc51_00000", "date": "2024-08-11_19-20-10", "timestamp": 1723368010, "time_this_iter_s": 21.854414701461792, "time_total_s": 627.1030566692352, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 627.1030566692352, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 22.14516129032258, "ram_util_percent": 87.97741935483869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.038876473903656006, "policy_loss": 0.0007414487190544605, "vf_loss": 0.7843837738037109}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 2336, "num_env_steps_trained": 2336, "num_agent_steps_sampled": 2336, "num_agent_steps_trained": 2336}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.2752859307560396, "episode_len_mean": 25.25, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 611.9512091123497, "mean_inference_ms": 1.9497506789806958, "mean_action_processing_ms": 0.2368517131715691, "mean_env_wait_ms": 85.02421807959645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013024133184681768, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.26611063791357953}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.2752859307560396, "episode_len_mean": 25.25, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 611.9512091123497, "mean_inference_ms": 1.9497506789806958, "mean_action_processing_ms": 0.2368517131715691, "mean_env_wait_ms": 85.02421807959645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013024133184681768, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.26611063791357953}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336, "num_agent_steps_trained": 2336, "num_env_steps_sampled": 2336, "num_env_steps_trained": 2336, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 3.600814041348501, "num_env_steps_trained_throughput_per_sec": 3.600814041348501, "timesteps_total": 2336, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2336, "timers": {"training_iteration_time_ms": 9113.406, "sample_time_ms": 9097.983, "load_time_ms": 0.796, "load_throughput": 40178.934, "learn_time_ms": 6.343, "learn_throughput": 5044.774, "synch_weights_time_ms": 8.283}, "counters": {"num_env_steps_sampled": 2336, "num_env_steps_trained": 2336, "num_agent_steps_sampled": 2336, "num_agent_steps_trained": 2336}, "done": false, "episodes_total": 92, "training_iteration": 38, "trial_id": "3fc51_00000", "date": "2024-08-11_19-20-37", "timestamp": 1723368037, "time_this_iter_s": 26.668174743652344, "time_total_s": 653.7712314128876, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 653.7712314128876, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.91351351351351, "ram_util_percent": 88.88648648648648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.04027087986469269, "policy_loss": -0.0007987507269717753, "vf_loss": 0.9537132978439331}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}}, "num_env_steps_sampled": 2432, "num_env_steps_trained": 2432, "num_agent_steps_sampled": 2432, "num_agent_steps_trained": 2432}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.203101336163424, "episode_len_mean": 25.242105263157896, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 615.4192546551728, "mean_inference_ms": 1.950390415513469, "mean_action_processing_ms": 0.23745689326300815, "mean_env_wait_ms": 83.12085052949885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012612844768323396, "StateBufferConnector_ms": 0.006291740819027549, "ViewRequirementAgentConnector_ms": 0.26758093582956416}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.203101336163424, "episode_len_mean": 25.242105263157896, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 615.4192546551728, "mean_inference_ms": 1.950390415513469, "mean_action_processing_ms": 0.23745689326300815, "mean_env_wait_ms": 83.12085052949885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012612844768323396, "StateBufferConnector_ms": 0.006291740819027549, "ViewRequirementAgentConnector_ms": 0.26758093582956416}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432, "num_agent_steps_trained": 2432, "num_env_steps_sampled": 2432, "num_env_steps_trained": 2432, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.515302735707212, "num_env_steps_trained_throughput_per_sec": 7.515302735707212, "timesteps_total": 2432, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2432, "timers": {"training_iteration_time_ms": 8292.109, "sample_time_ms": 8278.154, "load_time_ms": 0.528, "load_throughput": 60575.767, "learn_time_ms": 5.69, "learn_throughput": 5623.734, "synch_weights_time_ms": 7.637}, "counters": {"num_env_steps_sampled": 2432, "num_env_steps_trained": 2432, "num_agent_steps_sampled": 2432, "num_agent_steps_trained": 2432}, "done": false, "episodes_total": 95, "training_iteration": 39, "trial_id": "3fc51_00000", "date": "2024-08-11_19-20-50", "timestamp": 1723368050, "time_this_iter_s": 12.779984951019287, "time_total_s": 666.5512163639069, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 666.5512163639069, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.627777777777776, "ram_util_percent": 90.98888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.04055846482515335, "policy_loss": 0.0005060358089394867, "vf_loss": 0.63251793384552}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 2496, "num_env_steps_trained": 2496, "num_agent_steps_sampled": 2496, "num_agent_steps_trained": 2496}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.1574855042716785, "episode_len_mean": 25.185567010309278, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 616.4531702993702, "mean_inference_ms": 1.950552473678371, "mean_action_processing_ms": 0.23751339798823523, "mean_env_wait_ms": 81.9058695690694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012352786113306419, "StateBufferConnector_ms": 0.006162014204202239, "ViewRequirementAgentConnector_ms": 0.26567277220106617}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.1574855042716785, "episode_len_mean": 25.185567010309278, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 616.4531702993702, "mean_inference_ms": 1.950552473678371, "mean_action_processing_ms": 0.23751339798823523, "mean_env_wait_ms": 81.9058695690694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012352786113306419, "StateBufferConnector_ms": 0.006162014204202239, "ViewRequirementAgentConnector_ms": 0.26567277220106617}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496, "num_agent_steps_trained": 2496, "num_env_steps_sampled": 2496, "num_env_steps_trained": 2496, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.3242495228585898, "num_env_steps_trained_throughput_per_sec": 3.3242495228585898, "timesteps_total": 2496, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 2496, "timers": {"training_iteration_time_ms": 8047.977, "sample_time_ms": 8034.733, "load_time_ms": 0.528, "load_throughput": 60578.502, "learn_time_ms": 5.383, "learn_throughput": 5945.072, "synch_weights_time_ms": 7.233}, "counters": {"num_env_steps_sampled": 2496, "num_env_steps_trained": 2496, "num_agent_steps_sampled": 2496, "num_agent_steps_trained": 2496}, "done": false, "episodes_total": 97, "training_iteration": 40, "trial_id": "3fc51_00000", "date": "2024-08-11_19-21-09", "timestamp": 1723368069, "time_this_iter_s": 19.260934114456177, "time_total_s": 685.812150478363, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 685.812150478363, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 10.739285714285714, "ram_util_percent": 90.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.724979400634766, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.041681643575429916, "policy_loss": 0.0005485056317411363, "vf_loss": 0.3964184820652008}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 2528, "num_env_steps_trained": 2528, "num_agent_steps_sampled": 2528, "num_agent_steps_trained": 2528}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.092520138037898, "episode_len_mean": 25.03, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 618.8414553750629, "mean_inference_ms": 1.949801768259115, "mean_action_processing_ms": 0.23716439444067336, "mean_env_wait_ms": 80.16595237981183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012047290802001953, "StateBufferConnector_ms": 0.005977153778076172, "ViewRequirementAgentConnector_ms": 0.26117491722106934}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": -89.02987296263704, "episode_reward_mean": -2.092520138037898, "episode_len_mean": 25.03, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.37089058917819, -44.600185792403465, -37.069884351825635, -89.02987296263704, 0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366], "episode_lengths": [30, 30, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 618.8414553750629, "mean_inference_ms": 1.949801768259115, "mean_action_processing_ms": 0.23716439444067336, "mean_env_wait_ms": 80.16595237981183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012047290802001953, "StateBufferConnector_ms": 0.005977153778076172, "ViewRequirementAgentConnector_ms": 0.26117491722106934}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528, "num_agent_steps_trained": 2528, "num_env_steps_sampled": 2528, "num_env_steps_trained": 2528, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.667767926339419, "num_env_steps_trained_throughput_per_sec": 2.667767926339419, "timesteps_total": 2528, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 2528, "timers": {"training_iteration_time_ms": 9242.073, "sample_time_ms": 9229.47, "load_time_ms": 0.413, "load_throughput": 77434.794, "learn_time_ms": 5.288, "learn_throughput": 6051.977, "synch_weights_time_ms": 6.703}, "counters": {"num_env_steps_sampled": 2528, "num_env_steps_trained": 2528, "num_agent_steps_sampled": 2528, "num_agent_steps_trained": 2528}, "done": false, "episodes_total": 100, "training_iteration": 41, "trial_id": "3fc51_00000", "date": "2024-08-11_19-21-22", "timestamp": 1723368082, "time_this_iter_s": 12.000184297561646, "time_total_s": 697.8123347759247, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 697.8123347759247, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.03529411764706, "ram_util_percent": 91.28235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.048021648079156876, "policy_loss": -0.0007644107099622488, "vf_loss": 0.6351659893989563}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 2624, "num_env_steps_trained": 2624, "num_agent_steps_sampled": 2624, "num_agent_steps_trained": 2624}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.09856805338865841, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 627.7445641429072, "mean_inference_ms": 1.931803960826156, "mean_action_processing_ms": 0.2326508562053302, "mean_env_wait_ms": 63.77892887988294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012047290802001953, "StateBufferConnector_ms": 0.005977153778076172, "ViewRequirementAgentConnector_ms": 0.24757695198059082}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.09856805338865841, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5724386923948961, 0.4690516542565396, 0.3850018057313354, 0.3649253747445719, 0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 627.7445641429072, "mean_inference_ms": 1.931803960826156, "mean_action_processing_ms": 0.2326508562053302, "mean_env_wait_ms": 63.77892887988294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012047290802001953, "StateBufferConnector_ms": 0.005977153778076172, "ViewRequirementAgentConnector_ms": 0.24757695198059082}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624, "num_agent_steps_trained": 2624, "num_env_steps_sampled": 2624, "num_env_steps_trained": 2624, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.244928397010692, "num_env_steps_trained_throughput_per_sec": 4.244928397010692, "timesteps_total": 2624, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2624, "timers": {"training_iteration_time_ms": 9319.83, "sample_time_ms": 9308.347, "load_time_ms": 0.302, "load_throughput": 105891.699, "learn_time_ms": 4.795, "learn_throughput": 6673.847, "synch_weights_time_ms": 6.087}, "counters": {"num_env_steps_sampled": 2624, "num_env_steps_trained": 2624, "num_agent_steps_sampled": 2624, "num_agent_steps_trained": 2624}, "done": false, "episodes_total": 104, "training_iteration": 42, "trial_id": "3fc51_00000", "date": "2024-08-11_19-21-44", "timestamp": 1723368104, "time_this_iter_s": 22.62532377243042, "time_total_s": 720.4376585483551, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 720.4376585483551, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 24.721874999999997, "ram_util_percent": 90.703125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.059159599244594574, "policy_loss": 0.0011384023819118738, "vf_loss": 0.8602882027626038}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 2720, "num_env_steps_trained": 2720, "num_agent_steps_sampled": 2720, "num_agent_steps_trained": 2720}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.08101567892902675, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 634.863985214165, "mean_inference_ms": 1.9274114064856882, "mean_action_processing_ms": 0.23099668418044794, "mean_env_wait_ms": 54.453647062958964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012046098709106445, "StateBufferConnector_ms": 0.006978750228881836, "ViewRequirementAgentConnector_ms": 0.25263524055480957}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.08101567892902675, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.2055595395288508, 0.303248738894539, 0.2149227717370177, 0.22491886854250012, 0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 634.863985214165, "mean_inference_ms": 1.9274114064856882, "mean_action_processing_ms": 0.23099668418044794, "mean_env_wait_ms": 54.453647062958964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012046098709106445, "StateBufferConnector_ms": 0.006978750228881836, "ViewRequirementAgentConnector_ms": 0.25263524055480957}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720, "num_agent_steps_trained": 2720, "num_env_steps_sampled": 2720, "num_env_steps_trained": 2720, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.259235125566527, "num_env_steps_trained_throughput_per_sec": 5.259235125566527, "timesteps_total": 2720, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2720, "timers": {"training_iteration_time_ms": 8479.057, "sample_time_ms": 8467.072, "load_time_ms": 0.403, "load_throughput": 79498.743, "learn_time_ms": 4.8, "learn_throughput": 6667.282, "synch_weights_time_ms": 6.484}, "counters": {"num_env_steps_sampled": 2720, "num_env_steps_trained": 2720, "num_agent_steps_sampled": 2720, "num_agent_steps_trained": 2720}, "done": false, "episodes_total": 108, "training_iteration": 43, "trial_id": "3fc51_00000", "date": "2024-08-11_19-22-03", "timestamp": 1723368123, "time_this_iter_s": 18.25968599319458, "time_total_s": 738.6973445415497, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 738.6973445415497, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 19.4, "ram_util_percent": 88.488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.05916912853717804, "policy_loss": -0.0013044980587437749, "vf_loss": 1.0898070335388184}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 2816, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 2816, "num_agent_steps_trained": 2816}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.07187077672384451, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 641.798332279094, "mean_inference_ms": 1.9211920414278767, "mean_action_processing_ms": 0.2284874635769295, "mean_env_wait_ms": 48.060504808006144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.00788259506225586, "ViewRequirementAgentConnector_ms": 0.2522428035736084}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.07187077672384451, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.16310490967228172, 0.15552370665718143, 0.18530593312069188, 0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 641.798332279094, "mean_inference_ms": 1.9211920414278767, "mean_action_processing_ms": 0.2284874635769295, "mean_env_wait_ms": 48.060504808006144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.00788259506225586, "ViewRequirementAgentConnector_ms": 0.2522428035736084}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816, "num_agent_steps_trained": 2816, "num_env_steps_sampled": 2816, "num_env_steps_trained": 2816, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.595383212567168, "num_env_steps_trained_throughput_per_sec": 6.595383212567168, "timesteps_total": 2816, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2816, "timers": {"training_iteration_time_ms": 6741.951, "sample_time_ms": 6729.574, "load_time_ms": 0.457, "load_throughput": 70021.77, "learn_time_ms": 5.264, "learn_throughput": 6078.481, "synch_weights_time_ms": 6.355}, "counters": {"num_env_steps_sampled": 2816, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 2816, "num_agent_steps_trained": 2816}, "done": false, "episodes_total": 112, "training_iteration": 44, "trial_id": "3fc51_00000", "date": "2024-08-11_19-22-17", "timestamp": 1723368137, "time_this_iter_s": 14.561159372329712, "time_total_s": 753.2585039138794, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 753.2585039138794, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 22.80952380952381, "ram_util_percent": 86.50000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.0601467527449131, "policy_loss": 0.0010769511573016644, "vf_loss": 0.7999235391616821}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 2912, "num_env_steps_trained": 2912, "num_agent_steps_sampled": 2912, "num_agent_steps_trained": 2912}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.06707103661699, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 647.1669937172021, "mean_inference_ms": 1.9206735229992415, "mean_action_processing_ms": 0.22674284174711265, "mean_env_wait_ms": 44.60109526869339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.008835315704345703, "ViewRequirementAgentConnector_ms": 0.23413395881652832}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007682078717841169, "episode_reward_mean": 0.06707103661699, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.17693357076563382, 0.11099730977847118, 0.1515088164011773, 0.12162334204969415, 0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 647.1669937172021, "mean_inference_ms": 1.9206735229992415, "mean_action_processing_ms": 0.22674284174711265, "mean_env_wait_ms": 44.60109526869339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.008835315704345703, "ViewRequirementAgentConnector_ms": 0.23413395881652832}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912, "num_agent_steps_trained": 2912, "num_env_steps_sampled": 2912, "num_env_steps_trained": 2912, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.432860452208221, "num_env_steps_trained_throughput_per_sec": 7.432860452208221, "timesteps_total": 2912, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 2912, "timers": {"training_iteration_time_ms": 6826.475, "sample_time_ms": 6814.341, "load_time_ms": 0.358, "load_throughput": 89502.353, "learn_time_ms": 5.122, "learn_throughput": 6247.654, "synch_weights_time_ms": 6.455}, "counters": {"num_env_steps_sampled": 2912, "num_env_steps_trained": 2912, "num_agent_steps_sampled": 2912, "num_agent_steps_trained": 2912}, "done": false, "episodes_total": 115, "training_iteration": 45, "trial_id": "3fc51_00000", "date": "2024-08-11_19-22-30", "timestamp": 1723368150, "time_this_iter_s": 12.921682834625244, "time_total_s": 766.1801867485046, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 766.1801867485046, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.63888888888889, "ram_util_percent": 86.40555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.06709963083267212, "policy_loss": -0.0013253254583105445, "vf_loss": 0.8989319801330566}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}}, "num_env_steps_sampled": 3008, "num_env_steps_trained": 3008, "num_agent_steps_sampled": 3008, "num_agent_steps_trained": 3008}, "sampler_results": {"episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007397891286333716, "episode_reward_mean": 0.06176905995857984, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 654.0851038469606, "mean_inference_ms": 1.9159111578364818, "mean_action_processing_ms": 0.2308468110139292, "mean_env_wait_ms": 40.76813895552608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.24445438385009766}}, "episode_reward_max": 1.7494515665506736, "episode_reward_min": 0.007397891286333716, "episode_reward_mean": 0.06176905995857984, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.11933117965015752, 0.08475476829375972, 1.7494515665506736, 0.15573054299685749, 0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 654.0851038469606, "mean_inference_ms": 1.9159111578364818, "mean_action_processing_ms": 0.2308468110139292, "mean_env_wait_ms": 40.76813895552608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.24445438385009766}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008, "num_agent_steps_trained": 3008, "num_env_steps_sampled": 3008, "num_env_steps_trained": 3008, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.553508618299315, "num_env_steps_trained_throughput_per_sec": 4.553508618299315, "timesteps_total": 3008, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3008, "timers": {"training_iteration_time_ms": 6670.47, "sample_time_ms": 6658.889, "load_time_ms": 0.358, "load_throughput": 89412.916, "learn_time_ms": 5.064, "learn_throughput": 6319.548, "synch_weights_time_ms": 6.058}, "counters": {"num_env_steps_sampled": 3008, "num_env_steps_trained": 3008, "num_agent_steps_sampled": 3008, "num_agent_steps_trained": 3008}, "done": false, "episodes_total": 119, "training_iteration": 46, "trial_id": "3fc51_00000", "date": "2024-08-11_19-22-51", "timestamp": 1723368171, "time_this_iter_s": 21.089208126068115, "time_total_s": 787.2693948745728, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 787.2693948745728, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 15.173333333333334, "ram_util_percent": 86.2866666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.08767763525247574, "policy_loss": 0.0019550223369151354, "vf_loss": 0.9758826494216919}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}}, "num_env_steps_sampled": 3104, "num_env_steps_trained": 3104, "num_agent_steps_sampled": 3104, "num_agent_steps_trained": 3104}, "sampler_results": {"episode_reward_max": 0.606087635197169, "episode_reward_min": 0.007077739732649977, "episode_reward_mean": 0.040970997496314304, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 659.4538274661098, "mean_inference_ms": 1.9149454916691186, "mean_action_processing_ms": 0.23180339535266545, "mean_env_wait_ms": 37.64869729565759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.24455046653747559}}, "episode_reward_max": 0.606087635197169, "episode_reward_min": 0.007077739732649977, "episode_reward_mean": 0.040970997496314304, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0901902581216492, 0.09760820567393988, 0.606087635197169, 0.44912822116417095, 0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 659.4538274661098, "mean_inference_ms": 1.9149454916691186, "mean_action_processing_ms": 0.23180339535266545, "mean_env_wait_ms": 37.64869729565759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.24455046653747559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104, "num_agent_steps_trained": 3104, "num_env_steps_sampled": 3104, "num_env_steps_trained": 3104, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.50137001995232, "num_env_steps_trained_throughput_per_sec": 4.50137001995232, "timesteps_total": 3104, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3104, "timers": {"training_iteration_time_ms": 6980.681, "sample_time_ms": 6969.067, "load_time_ms": 0.502, "load_throughput": 63737.168, "learn_time_ms": 4.906, "learn_throughput": 6523.118, "synch_weights_time_ms": 6.206}, "counters": {"num_env_steps_sampled": 3104, "num_env_steps_trained": 3104, "num_agent_steps_sampled": 3104, "num_agent_steps_trained": 3104}, "done": false, "episodes_total": 123, "training_iteration": 47, "trial_id": "3fc51_00000", "date": "2024-08-11_19-23-13", "timestamp": 1723368193, "time_this_iter_s": 21.33290147781372, "time_total_s": 808.6022963523865, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 808.6022963523865, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 15.110000000000001, "ram_util_percent": 86.49666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.09875019639730453, "policy_loss": -0.002528713783249259, "vf_loss": 1.122544765472412}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "sampler_results": {"episode_reward_max": 0.251391263287378, "episode_reward_min": 0.00680569715903242, "episode_reward_mean": 0.02882344390571272, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 664.028366353333, "mean_inference_ms": 1.9163069682632383, "mean_action_processing_ms": 0.23369992992909816, "mean_env_wait_ms": 35.0327749203845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.21774673461914062}}, "episode_reward_max": 0.251391263287378, "episode_reward_min": 0.00680569715903242, "episode_reward_mean": 0.02882344390571272, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.12191766093402719, 0.09669859452265572, 0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 664.028366353333, "mean_inference_ms": 1.9163069682632383, "mean_action_processing_ms": 0.23369992992909816, "mean_env_wait_ms": 35.0327749203845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.21774673461914062}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.4480076535394755, "num_env_steps_trained_throughput_per_sec": 4.4480076535394755, "timesteps_total": 3200, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 7683.786, "sample_time_ms": 7672.139, "load_time_ms": 0.5, "load_throughput": 64010.744, "learn_time_ms": 4.925, "learn_throughput": 6498.043, "synch_weights_time_ms": 6.121}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "done": false, "episodes_total": 127, "training_iteration": 48, "trial_id": "3fc51_00000", "date": "2024-08-11_19-23-34", "timestamp": 1723368214, "time_this_iter_s": 21.58954882621765, "time_total_s": 830.1918451786041, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 830.1918451786041, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 14.303333333333335, "ram_util_percent": 86.36999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.403743743896484, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.10632681101560593, "policy_loss": 0.0017537595704197884, "vf_loss": 0.5475397109985352}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 3296, "num_env_steps_trained": 3296, "num_agent_steps_sampled": 3296, "num_agent_steps_trained": 3296}, "sampler_results": {"episode_reward_max": 0.251391263287378, "episode_reward_min": 0.006692088744225598, "episode_reward_mean": 0.02677451631461152, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 665.4451065218071, "mean_inference_ms": 1.9192467126101764, "mean_action_processing_ms": 0.2339823757859631, "mean_env_wait_ms": 33.862329823923076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.222275972366333}}, "episode_reward_max": 0.251391263287378, "episode_reward_min": 0.006692088744225598, "episode_reward_mean": 0.02677451631461152, "episode_len_mean": 24.8, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.251391263287378, 0.11610096193881858, 0.19330955668079153, 0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 665.4451065218071, "mean_inference_ms": 1.9192467126101764, "mean_action_processing_ms": 0.2339823757859631, "mean_env_wait_ms": 33.862329823923076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.222275972366333}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3296, "num_agent_steps_trained": 3296, "num_env_steps_sampled": 3296, "num_env_steps_trained": 3296, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.970554453465534, "num_env_steps_trained_throughput_per_sec": 4.970554453465534, "timesteps_total": 3296, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3296, "timers": {"training_iteration_time_ms": 7378.565, "sample_time_ms": 7366.761, "load_time_ms": 0.41, "load_throughput": 78083.5, "learn_time_ms": 5.325, "learn_throughput": 6009.408, "synch_weights_time_ms": 5.868}, "counters": {"num_env_steps_sampled": 3296, "num_env_steps_trained": 3296, "num_agent_steps_sampled": 3296, "num_agent_steps_trained": 3296}, "done": false, "episodes_total": 129, "training_iteration": 49, "trial_id": "3fc51_00000", "date": "2024-08-11_19-23-54", "timestamp": 1723368234, "time_this_iter_s": 19.321452617645264, "time_total_s": 849.5132977962494, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 849.5132977962494, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 9.618518518518519, "ram_util_percent": 86.5037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4544925689697266, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.11141800135374069, "policy_loss": 0.0005946069722995162, "vf_loss": 0.004342688713222742}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 103.0}}, "num_env_steps_sampled": 3328, "num_env_steps_trained": 3328, "num_agent_steps_sampled": 3328, "num_agent_steps_trained": 3328}, "sampler_results": {"episode_reward_max": 0.11634172458613544, "episode_reward_min": 0.006589274526421736, "episode_reward_mean": 0.021370125734843808, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 669.0046202303307, "mean_inference_ms": 1.9201328281018666, "mean_action_processing_ms": 0.23442281758154745, "mean_env_wait_ms": 32.28545404813653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.22220540046691895}}, "episode_reward_max": 0.11634172458613544, "episode_reward_min": 0.006589274526421736, "episode_reward_mean": 0.021370125734843808, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.05982400342201418, 0.11634172458613544, 0.06983773245061436, 0.08390790956496662, 0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 669.0046202303307, "mean_inference_ms": 1.9201328281018666, "mean_action_processing_ms": 0.23442281758154745, "mean_env_wait_ms": 32.28545404813653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.009834051132202148, "ViewRequirementAgentConnector_ms": 0.22220540046691895}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3328, "num_agent_steps_trained": 3328, "num_env_steps_sampled": 3328, "num_env_steps_trained": 3328, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.542227035778824, "num_env_steps_trained_throughput_per_sec": 2.542227035778824, "timesteps_total": 3328, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 3328, "timers": {"training_iteration_time_ms": 7481.067, "sample_time_ms": 7469.455, "load_time_ms": 0.514, "load_throughput": 62227.145, "learn_time_ms": 5.133, "learn_throughput": 6234.334, "synch_weights_time_ms": 5.764}, "counters": {"num_env_steps_sampled": 3328, "num_env_steps_trained": 3328, "num_agent_steps_sampled": 3328, "num_agent_steps_trained": 3328}, "done": false, "episodes_total": 132, "training_iteration": 50, "trial_id": "3fc51_00000", "date": "2024-08-11_19-24-06", "timestamp": 1723368246, "time_this_iter_s": 12.59282112121582, "time_total_s": 862.1061189174652, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 862.1061189174652, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.616666666666664, "ram_util_percent": 86.89444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.923620223999023, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.14248864352703094, "policy_loss": -0.0015385912265628576, "vf_loss": 0.12151910364627838}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 3424, "num_env_steps_trained": 3424, "num_agent_steps_sampled": 3424, "num_agent_steps_trained": 3424}, "sampler_results": {"episode_reward_max": 0.0876620186425456, "episode_reward_min": 0.006343601225625346, "episode_reward_mean": 0.018331212611642035, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 672.3179666537051, "mean_inference_ms": 1.9207962837233044, "mean_action_processing_ms": 0.2356628693304345, "mean_env_wait_ms": 30.431322720056915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.010835886001586914, "ViewRequirementAgentConnector_ms": 0.23121380805969238}}, "episode_reward_max": 0.0876620186425456, "episode_reward_min": 0.006343601225625346, "episode_reward_mean": 0.018331212611642035, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.05043995930226073, 0.0876620186425456, 0.05720438503700226, 0.06631715712242486, 0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 672.3179666537051, "mean_inference_ms": 1.9207962837233044, "mean_action_processing_ms": 0.2356628693304345, "mean_env_wait_ms": 30.431322720056915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010508298873901367, "StateBufferConnector_ms": 0.010835886001586914, "ViewRequirementAgentConnector_ms": 0.23121380805969238}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3424, "num_agent_steps_trained": 3424, "num_env_steps_sampled": 3424, "num_env_steps_trained": 3424, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.079761689351938, "num_env_steps_trained_throughput_per_sec": 7.079761689351938, "timesteps_total": 3424, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3424, "timers": {"training_iteration_time_ms": 6704.36, "sample_time_ms": 6693.22, "load_time_ms": 0.315, "load_throughput": 101672.395, "learn_time_ms": 4.875, "learn_throughput": 6564.466, "synch_weights_time_ms": 5.65}, "counters": {"num_env_steps_sampled": 3424, "num_env_steps_trained": 3424, "num_agent_steps_sampled": 3424, "num_agent_steps_trained": 3424}, "done": false, "episodes_total": 136, "training_iteration": 51, "trial_id": "3fc51_00000", "date": "2024-08-11_19-24-20", "timestamp": 1723368260, "time_this_iter_s": 13.566340923309326, "time_total_s": 875.6724598407745, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 875.6724598407745, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 23.57, "ram_util_percent": 86.78999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.35001564025879, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.21709498763084412, "policy_loss": 0.00372305023483932, "vf_loss": 0.35534441471099854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}}, "num_env_steps_sampled": 3520, "num_env_steps_trained": 3520, "num_agent_steps_sampled": 3520, "num_agent_steps_trained": 3520}, "sampler_results": {"episode_reward_max": 0.05956176607116196, "episode_reward_min": 0.006137077468913663, "episode_reward_mean": 0.015966494698360752, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 674.428434722033, "mean_inference_ms": 1.918788498516419, "mean_action_processing_ms": 0.23631931693637373, "mean_env_wait_ms": 28.794874582600336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011348724365234375, "StateBufferConnector_ms": 0.010835886001586914, "ViewRequirementAgentConnector_ms": 0.23397040367126465}}, "episode_reward_max": 0.05956176607116196, "episode_reward_min": 0.006137077468913663, "episode_reward_mean": 0.015966494698360752, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.03976491317455742, 0.05956176607116196, 0.04383258179048044, 0.048956162508795226, 0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 674.428434722033, "mean_inference_ms": 1.918788498516419, "mean_action_processing_ms": 0.23631931693637373, "mean_env_wait_ms": 28.794874582600336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011348724365234375, "StateBufferConnector_ms": 0.010835886001586914, "ViewRequirementAgentConnector_ms": 0.23397040367126465}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520, "num_agent_steps_trained": 3520, "num_env_steps_sampled": 3520, "num_env_steps_trained": 3520, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.454454059854766, "num_env_steps_trained_throughput_per_sec": 6.454454059854766, "timesteps_total": 3520, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3520, "timers": {"training_iteration_time_ms": 6033.336, "sample_time_ms": 6022.097, "load_time_ms": 0.315, "load_throughput": 101672.395, "learn_time_ms": 5.091, "learn_throughput": 6285.338, "synch_weights_time_ms": 5.633}, "counters": {"num_env_steps_sampled": 3520, "num_env_steps_trained": 3520, "num_agent_steps_sampled": 3520, "num_agent_steps_trained": 3520}, "done": false, "episodes_total": 140, "training_iteration": 52, "trial_id": "3fc51_00000", "date": "2024-08-11_19-24-35", "timestamp": 1723368275, "time_this_iter_s": 14.879445314407349, "time_total_s": 890.5519051551819, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 890.5519051551819, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 20.719047619047622, "ram_util_percent": 86.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.2726791501045227, "policy_loss": -0.0070479754358530045, "vf_loss": 0.7830393314361572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 3616, "num_env_steps_trained": 3616, "num_agent_steps_sampled": 3616, "num_agent_steps_trained": 3616}, "sampler_results": {"episode_reward_max": 0.049273701189927015, "episode_reward_min": 0.005949594122259086, "episode_reward_mean": 0.01428898821725391, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 675.4009999778845, "mean_inference_ms": 1.9153704595333827, "mean_action_processing_ms": 0.23650377198842062, "mean_env_wait_ms": 27.336855021146757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011348724365234375, "StateBufferConnector_ms": 0.010835886001586914, "ViewRequirementAgentConnector_ms": 0.2320573329925537}}, "episode_reward_max": 0.049273701189927015, "episode_reward_min": 0.005949594122259086, "episode_reward_mean": 0.01428898821725391, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.03798061089280286, 0.03488495891982237, 0.049273701189927015, 0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 675.4009999778845, "mean_inference_ms": 1.9153704595333827, "mean_action_processing_ms": 0.23650377198842062, "mean_env_wait_ms": 27.336855021146757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011348724365234375, "StateBufferConnector_ms": 0.010835886001586914, "ViewRequirementAgentConnector_ms": 0.2320573329925537}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3616, "num_agent_steps_trained": 3616, "num_env_steps_sampled": 3616, "num_env_steps_trained": 3616, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.902305744442029, "num_env_steps_trained_throughput_per_sec": 6.902305744442029, "timesteps_total": 3616, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3616, "timers": {"training_iteration_time_ms": 5492.801, "sample_time_ms": 5482.536, "load_time_ms": 0.205, "load_throughput": 156139.749, "learn_time_ms": 4.45, "learn_throughput": 7191.07, "synch_weights_time_ms": 5.51}, "counters": {"num_env_steps_sampled": 3616, "num_env_steps_trained": 3616, "num_agent_steps_sampled": 3616, "num_agent_steps_trained": 3616}, "done": false, "episodes_total": 144, "training_iteration": 53, "trial_id": "3fc51_00000", "date": "2024-08-11_19-24-49", "timestamp": 1723368289, "time_this_iter_s": 13.914923906326294, "time_total_s": 904.4668290615082, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 904.4668290615082, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 22.910526315789475, "ram_util_percent": 86.65789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.4230312705039978, "policy_loss": 0.011997563764452934, "vf_loss": 0.8989503383636475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 116.0, "diff_num_grad_updates_vs_sampler_policy": 115.0}}, "num_env_steps_sampled": 3712, "num_env_steps_trained": 3712, "num_agent_steps_sampled": 3712, "num_agent_steps_trained": 3712}, "sampler_results": {"episode_reward_max": 0.041774061322254155, "episode_reward_min": 0.005752501545936463, "episode_reward_mean": 0.013243854471845073, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 675.6787951169312, "mean_inference_ms": 1.910868899096867, "mean_action_processing_ms": 0.23621939483736798, "mean_env_wait_ms": 26.37245148636089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01104736328125, "StateBufferConnector_ms": 0.008859872817993164, "ViewRequirementAgentConnector_ms": 0.2284560203552246}}, "episode_reward_max": 0.041774061322254155, "episode_reward_min": 0.005752501545936463, "episode_reward_mean": 0.013243854471845073, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.041774061322254155, 0.029542581276738467, 0.03924495472512006, 0.034337308501219646, 0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 675.6787951169312, "mean_inference_ms": 1.910868899096867, "mean_action_processing_ms": 0.23621939483736798, "mean_env_wait_ms": 26.37245148636089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01104736328125, "StateBufferConnector_ms": 0.008859872817993164, "ViewRequirementAgentConnector_ms": 0.2284560203552246}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3712, "num_agent_steps_trained": 3712, "num_env_steps_sampled": 3712, "num_env_steps_trained": 3712, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.97821229233267, "num_env_steps_trained_throughput_per_sec": 6.97821229233267, "timesteps_total": 3712, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3712, "timers": {"training_iteration_time_ms": 5601.808, "sample_time_ms": 5591.458, "load_time_ms": 0.101, "load_throughput": 318353.245, "learn_time_ms": 4.785, "learn_throughput": 6686.98, "synch_weights_time_ms": 5.364}, "counters": {"num_env_steps_sampled": 3712, "num_env_steps_trained": 3712, "num_agent_steps_sampled": 3712, "num_agent_steps_trained": 3712}, "done": false, "episodes_total": 147, "training_iteration": 54, "trial_id": "3fc51_00000", "date": "2024-08-11_19-25-03", "timestamp": 1723368303, "time_this_iter_s": 13.763612031936646, "time_total_s": 918.2304410934448, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 918.2304410934448, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.189999999999998, "ram_util_percent": 86.76000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.6266568899154663, "policy_loss": -0.022045567631721497, "vf_loss": 1.2361528873443604}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 3808, "num_env_steps_trained": 3808, "num_agent_steps_sampled": 3808, "num_agent_steps_trained": 3808}, "sampler_results": {"episode_reward_max": 0.033579785054473295, "episode_reward_min": 0.005587971553153783, "episode_reward_mean": 0.012025105832055344, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.8267024788831, "mean_inference_ms": 1.9048046823241531, "mean_action_processing_ms": 0.23750358773423375, "mean_env_wait_ms": 25.180915598731772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012103796005249023, "StateBufferConnector_ms": 0.008859872817993164, "ViewRequirementAgentConnector_ms": 0.223435640335083}}, "episode_reward_max": 0.033579785054473295, "episode_reward_min": 0.005587971553153783, "episode_reward_mean": 0.012025105832055344, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.031732670157551546, 0.026224833364431373, 0.033579785054473295, 0.029928260856566278, 0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.8267024788831, "mean_inference_ms": 1.9048046823241531, "mean_action_processing_ms": 0.23750358773423375, "mean_env_wait_ms": 25.180915598731772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012103796005249023, "StateBufferConnector_ms": 0.008859872817993164, "ViewRequirementAgentConnector_ms": 0.223435640335083}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3808, "num_agent_steps_trained": 3808, "num_env_steps_sampled": 3808, "num_env_steps_trained": 3808, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.243802250644494, "num_env_steps_trained_throughput_per_sec": 4.243802250644494, "timesteps_total": 3808, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3808, "timers": {"training_iteration_time_ms": 6508.123, "sample_time_ms": 6496.895, "load_time_ms": 0.101, "load_throughput": 318353.245, "learn_time_ms": 4.937, "learn_throughput": 6481.694, "synch_weights_time_ms": 6.091}, "counters": {"num_env_steps_sampled": 3808, "num_env_steps_trained": 3808, "num_agent_steps_sampled": 3808, "num_agent_steps_trained": 3808}, "done": false, "episodes_total": 151, "training_iteration": 55, "trial_id": "3fc51_00000", "date": "2024-08-11_19-25-26", "timestamp": 1723368326, "time_this_iter_s": 22.628779888153076, "time_total_s": 940.8592209815979, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 940.8592209815979, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 14.334375000000001, "ram_util_percent": 87.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 3.1832034587860107, "policy_loss": 0.17022378742694855, "vf_loss": 1.3782408237457275}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 121.0}}, "num_env_steps_sampled": 3904, "num_env_steps_trained": 3904, "num_agent_steps_sampled": 3904, "num_agent_steps_trained": 3904}, "sampler_results": {"episode_reward_max": 0.02879453732817312, "episode_reward_min": 0.005411297769339644, "episode_reward_mean": 0.011033433345762504, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.9193129522328, "mean_inference_ms": 1.8974272862587154, "mean_action_processing_ms": 0.23713517077797003, "mean_env_wait_ms": 24.10244290253758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011102437973022461, "StateBufferConnector_ms": 0.008859872817993164, "ViewRequirementAgentConnector_ms": 0.223236083984375}}, "episode_reward_max": 0.02879453732817312, "episode_reward_min": 0.005411297769339644, "episode_reward_mean": 0.011033433345762504, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.027933536773484452, 0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.9193129522328, "mean_inference_ms": 1.8974272862587154, "mean_action_processing_ms": 0.23713517077797003, "mean_env_wait_ms": 24.10244290253758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011102437973022461, "StateBufferConnector_ms": 0.008859872817993164, "ViewRequirementAgentConnector_ms": 0.223236083984375}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3904, "num_agent_steps_trained": 3904, "num_env_steps_sampled": 3904, "num_env_steps_trained": 3904, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.465485590463834, "num_env_steps_trained_throughput_per_sec": 4.465485590463834, "timesteps_total": 3904, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 3904, "timers": {"training_iteration_time_ms": 7171.294, "sample_time_ms": 7160.227, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5.001, "learn_throughput": 6398.969, "synch_weights_time_ms": 5.966}, "counters": {"num_env_steps_sampled": 3904, "num_env_steps_trained": 3904, "num_agent_steps_sampled": 3904, "num_agent_steps_trained": 3904}, "done": false, "episodes_total": 155, "training_iteration": 56, "trial_id": "3fc51_00000", "date": "2024-08-11_19-25-47", "timestamp": 1723368347, "time_this_iter_s": 21.504226446151733, "time_total_s": 962.3634474277496, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 962.3634474277496, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 14.583333333333334, "ram_util_percent": 86.59666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.496825695037842, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 1.5670166015625, "policy_loss": 0.014845773577690125, "vf_loss": 0.0041272882372140884}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 123.0, "diff_num_grad_updates_vs_sampler_policy": 122.0}}, "num_env_steps_sampled": 3936, "num_env_steps_trained": 3936, "num_agent_steps_sampled": 3936, "num_agent_steps_trained": 3936}, "sampler_results": {"episode_reward_max": 0.02879453732817312, "episode_reward_min": 0.005411297769339644, "episode_reward_mean": 0.010809628299421576, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.4536835704816, "mean_inference_ms": 1.895363524035161, "mean_action_processing_ms": 0.23592826644211182, "mean_env_wait_ms": 23.842056844232058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011102437973022461, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.22121882438659668}}, "episode_reward_max": 0.02879453732817312, "episode_reward_min": 0.005411297769339644, "episode_reward_mean": 0.010809628299421576, "episode_len_mean": 24.8, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.023202720305098772, 0.02879453732817312, 0.026061480515361824, 0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.4536835704816, "mean_inference_ms": 1.895363524035161, "mean_action_processing_ms": 0.23592826644211182, "mean_env_wait_ms": 23.842056844232058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011102437973022461, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.22121882438659668}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3936, "num_agent_steps_trained": 3936, "num_env_steps_sampled": 3936, "num_env_steps_trained": 3936, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 3.0971388755012628, "num_env_steps_trained_throughput_per_sec": 3.0971388755012628, "timesteps_total": 3936, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 3936, "timers": {"training_iteration_time_ms": 6820.867, "sample_time_ms": 6809.655, "load_time_ms": 0.1, "load_throughput": 319337.921, "learn_time_ms": 5.037, "learn_throughput": 6353.562, "synch_weights_time_ms": 5.975}, "counters": {"num_env_steps_sampled": 3936, "num_env_steps_trained": 3936, "num_agent_steps_sampled": 3936, "num_agent_steps_trained": 3936}, "done": false, "episodes_total": 156, "training_iteration": 57, "trial_id": "3fc51_00000", "date": "2024-08-11_19-25-58", "timestamp": 1723368358, "time_this_iter_s": 10.340399026870728, "time_total_s": 972.7038464546204, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 972.7038464546204, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 9.193333333333332, "ram_util_percent": 86.45333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.501952588558197, "policy_loss": -0.01936367154121399, "vf_loss": 1.4975321292877197}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 125.0, "diff_num_grad_updates_vs_sampler_policy": 124.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 0.024532861137259686, "episode_reward_min": 0.005210256902679682, "episode_reward_mean": 0.010188358517297033, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.3906704803615, "mean_inference_ms": 1.8898936787864158, "mean_action_processing_ms": 0.23676138622607543, "mean_env_wait_ms": 23.11886948147732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010101795196533203, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.22455906867980957}}, "episode_reward_max": 0.024532861137259686, "episode_reward_min": 0.005210256902679682, "episode_reward_mean": 0.010188358517297033, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.024532861137259686, 0.02023188719668512, 0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 676.3906704803615, "mean_inference_ms": 1.8898936787864158, "mean_action_processing_ms": 0.23676138622607543, "mean_env_wait_ms": 23.11886948147732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010101795196533203, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.22455906867980957}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 5.317096279102603, "num_env_steps_trained_throughput_per_sec": 5.317096279102603, "timesteps_total": 4000, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8016.28, "sample_time_ms": 8005.061, "load_time_ms": 0.1, "load_throughput": 319337.921, "learn_time_ms": 5.143, "learn_throughput": 6221.561, "synch_weights_time_ms": 5.975}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 159, "training_iteration": 58, "trial_id": "3fc51_00000", "date": "2024-08-11_19-26-10", "timestamp": 1723368370, "time_this_iter_s": 12.042748928070068, "time_total_s": 984.7465953826904, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 984.7465953826904, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.076470588235296, "ram_util_percent": 86.56470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.25588515400886536, "policy_loss": 0.005300414282828569, "vf_loss": 0.6546021103858948}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 128.0, "diff_num_grad_updates_vs_sampler_policy": 127.0}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": 0.02434769246290907, "episode_reward_min": 0.0051343861243037005, "episode_reward_mean": 0.009845470077648027, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 674.981847734664, "mean_inference_ms": 1.8856879795985504, "mean_action_processing_ms": 0.23598818402260938, "mean_env_wait_ms": 22.65227633883241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010101795196533203, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.21697735786437988}}, "episode_reward_max": 0.02434769246290907, "episode_reward_min": 0.0051343861243037005, "episode_reward_mean": 0.009845470077648027, "episode_len_mean": 24.8, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.02434769246290907, 0.021234337953870638, 0.0223680739564782, 0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 674.981847734664, "mean_inference_ms": 1.8856879795985504, "mean_action_processing_ms": 0.23598818402260938, "mean_env_wait_ms": 22.65227633883241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010101795196533203, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.21697735786437988}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.897222435131502, "num_env_steps_trained_throughput_per_sec": 4.897222435131502, "timesteps_total": 4096, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 7677.966, "sample_time_ms": 7667.023, "load_time_ms": 0.1, "load_throughput": 319337.921, "learn_time_ms": 4.916, "learn_throughput": 6509.041, "synch_weights_time_ms": 5.927}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 161, "training_iteration": 59, "trial_id": "3fc51_00000", "date": "2024-08-11_19-26-29", "timestamp": 1723368389, "time_this_iter_s": 19.612122774124146, "time_total_s": 1004.3587181568146, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1004.3587181568146, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 8.75925925925926, "ram_util_percent": 86.3074074074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.167816638946533, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.22799520194530487, "policy_loss": 0.0015053136739879847, "vf_loss": 0.006155859678983688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 129.0, "diff_num_grad_updates_vs_sampler_policy": 128.0}}, "num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128}, "sampler_results": {"episode_reward_max": 0.02126596484145847, "episode_reward_min": 0.005073648551663692, "episode_reward_mean": 0.009321666257546431, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 674.2907594825767, "mean_inference_ms": 1.8785959153717915, "mean_action_processing_ms": 0.23509142345332212, "mean_env_wait_ms": 21.99924751448564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009139776229858398, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.21052837371826172}}, "episode_reward_max": 0.02126596484145847, "episode_reward_min": 0.005073648551663692, "episode_reward_mean": 0.009321666257546431, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.01805556273663378, 0.02126596484145847, 0.018850238610437192, 0.019738993117909998, 0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 674.2907594825767, "mean_inference_ms": 1.8785959153717915, "mean_action_processing_ms": 0.23509142345332212, "mean_env_wait_ms": 21.99924751448564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009139776229858398, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.21052837371826172}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.695156531766799, "num_env_steps_trained_throughput_per_sec": 2.695156531766799, "timesteps_total": 4128, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 4128, "timers": {"training_iteration_time_ms": 7534.308, "sample_time_ms": 7523.995, "load_time_ms": 0.1, "load_throughput": 319337.921, "learn_time_ms": 4.538, "learn_throughput": 7052.325, "synch_weights_time_ms": 5.577}, "counters": {"num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128}, "done": false, "episodes_total": 164, "training_iteration": 60, "trial_id": "3fc51_00000", "date": "2024-08-11_19-26-41", "timestamp": 1723368401, "time_this_iter_s": 11.879708766937256, "time_total_s": 1016.2384269237518, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1016.2384269237518, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 19.947058823529414, "ram_util_percent": 85.69411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.787455558776855, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.19897623360157013, "policy_loss": -0.0021198741160333157, "vf_loss": 0.09031705558300018}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 132.0, "diff_num_grad_updates_vs_sampler_policy": 131.0}}, "num_env_steps_sampled": 4224, "num_env_steps_trained": 4224, "num_agent_steps_sampled": 4224, "num_agent_steps_trained": 4224}, "sampler_results": {"episode_reward_max": 0.01897355091342154, "episode_reward_min": 0.004938052751765889, "episode_reward_mean": 0.008743956575199848, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 672.7989702924114, "mean_inference_ms": 1.869134807018625, "mean_action_processing_ms": 0.2340704442071279, "mean_env_wait_ms": 21.186302376480327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009139776229858398, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.21053171157836914}}, "episode_reward_max": 0.01897355091342154, "episode_reward_min": 0.004938052751765889, "episode_reward_mean": 0.008743956575199848, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.016377711523264855, 0.01897355091342154, 0.017028365307487747, 0.017749688581052886, 0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 672.7989702924114, "mean_inference_ms": 1.869134807018625, "mean_action_processing_ms": 0.2340704442071279, "mean_env_wait_ms": 21.186302376480327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009139776229858398, "StateBufferConnector_ms": 0.009856224060058594, "ViewRequirementAgentConnector_ms": 0.21053171157836914}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4224, "num_agent_steps_trained": 4224, "num_env_steps_sampled": 4224, "num_env_steps_trained": 4224, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.520270001330762, "num_env_steps_trained_throughput_per_sec": 6.520270001330762, "timesteps_total": 4224, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 4224, "timers": {"training_iteration_time_ms": 6856.818, "sample_time_ms": 6846.178, "load_time_ms": 0.2, "load_throughput": 159821.062, "learn_time_ms": 4.365, "learn_throughput": 7331.538, "synch_weights_time_ms": 5.976}, "counters": {"num_env_steps_sampled": 4224, "num_env_steps_trained": 4224, "num_agent_steps_sampled": 4224, "num_agent_steps_trained": 4224}, "done": false, "episodes_total": 168, "training_iteration": 61, "trial_id": "3fc51_00000", "date": "2024-08-11_19-26-56", "timestamp": 1723368416, "time_this_iter_s": 14.729427099227905, "time_total_s": 1030.9678540229797, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1030.9678540229797, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 21.514285714285716, "ram_util_percent": 85.91904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.78961944580078, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.2249864786863327, "policy_loss": 0.0034727202728390694, "vf_loss": 0.2478380650281906}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 135.0, "diff_num_grad_updates_vs_sampler_policy": 134.0}}, "num_env_steps_sampled": 4320, "num_env_steps_trained": 4320, "num_agent_steps_sampled": 4320, "num_agent_steps_trained": 4320}, "sampler_results": {"episode_reward_max": 0.016802901287600813, "episode_reward_min": 0.004826542451154956, "episode_reward_mean": 0.008239424876202264, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 671.0748460891309, "mean_inference_ms": 1.8590438287721238, "mean_action_processing_ms": 0.23305497353322743, "mean_env_wait_ms": 20.432857376466437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009139776229858398, "StateBufferConnector_ms": 0.008896827697753906, "ViewRequirementAgentConnector_ms": 0.2019357681274414}}, "episode_reward_max": 0.016802901287600813, "episode_reward_min": 0.004826542451154956, "episode_reward_mean": 0.008239424876202264, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.014734265421656892, 0.016802901287600813, 0.015258910297506874, 0.015835704853491894, 0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 671.0748460891309, "mean_inference_ms": 1.8590438287721238, "mean_action_processing_ms": 0.23305497353322743, "mean_env_wait_ms": 20.432857376466437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009139776229858398, "StateBufferConnector_ms": 0.008896827697753906, "ViewRequirementAgentConnector_ms": 0.2019357681274414}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320, "num_agent_steps_trained": 4320, "num_env_steps_sampled": 4320, "num_env_steps_trained": 4320, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.06137219518955, "num_env_steps_trained_throughput_per_sec": 7.06137219518955, "timesteps_total": 4320, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 4320, "timers": {"training_iteration_time_ms": 5979.451, "sample_time_ms": 5969.303, "load_time_ms": 0.152, "load_throughput": 210570.643, "learn_time_ms": 3.963, "learn_throughput": 8075.481, "synch_weights_time_ms": 5.835}, "counters": {"num_env_steps_sampled": 4320, "num_env_steps_trained": 4320, "num_agent_steps_sampled": 4320, "num_agent_steps_trained": 4320}, "done": false, "episodes_total": 172, "training_iteration": 62, "trial_id": "3fc51_00000", "date": "2024-08-11_19-27-10", "timestamp": 1723368430, "time_this_iter_s": 13.601518869400024, "time_total_s": 1044.5693728923798, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1044.5693728923798, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 24.105263157894736, "ram_util_percent": 85.92105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.2549477219581604, "policy_loss": -0.005750739946961403, "vf_loss": 0.5458556413650513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 138.0, "diff_num_grad_updates_vs_sampler_policy": 137.0}}, "num_env_steps_sampled": 4416, "num_env_steps_trained": 4416, "num_agent_steps_sampled": 4416, "num_agent_steps_trained": 4416}, "sampler_results": {"episode_reward_max": 0.015409035164623098, "episode_reward_min": 0.004724524682673184, "episode_reward_mean": 0.007805630825679369, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 669.128830262108, "mean_inference_ms": 1.8482547693302458, "mean_action_processing_ms": 0.23184511624958293, "mean_env_wait_ms": 19.732476601297765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009070873260498047, "StateBufferConnector_ms": 0.00789642333984375, "ViewRequirementAgentConnector_ms": 0.1963343620300293}}, "episode_reward_max": 0.015409035164623098, "episode_reward_min": 0.004724524682673184, "episode_reward_mean": 0.007805630825679369, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.014101545328989332, 0.013652595710794323, 0.015409035164623098, 0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 669.128830262108, "mean_inference_ms": 1.8482547693302458, "mean_action_processing_ms": 0.23184511624958293, "mean_env_wait_ms": 19.732476601297765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009070873260498047, "StateBufferConnector_ms": 0.00789642333984375, "ViewRequirementAgentConnector_ms": 0.1963343620300293}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4416, "num_agent_steps_trained": 4416, "num_env_steps_sampled": 4416, "num_env_steps_trained": 4416, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.181774893057598, "num_env_steps_trained_throughput_per_sec": 6.181774893057598, "timesteps_total": 4416, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 4416, "timers": {"training_iteration_time_ms": 5572.108, "sample_time_ms": 5562.072, "load_time_ms": 0.152, "load_throughput": 210570.643, "learn_time_ms": 4.05, "learn_throughput": 7901.714, "synch_weights_time_ms": 5.636}, "counters": {"num_env_steps_sampled": 4416, "num_env_steps_trained": 4416, "num_agent_steps_sampled": 4416, "num_agent_steps_trained": 4416}, "done": false, "episodes_total": 176, "training_iteration": 63, "trial_id": "3fc51_00000", "date": "2024-08-11_19-27-26", "timestamp": 1723368446, "time_this_iter_s": 15.535037755966187, "time_total_s": 1060.104410648346, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1060.104410648346, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 24.477272727272727, "ram_util_percent": 86.44545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.4001719057559967, "policy_loss": 0.01208867970854044, "vf_loss": 0.973490834236145}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 141.0, "diff_num_grad_updates_vs_sampler_policy": 140.0}}, "num_env_steps_sampled": 4512, "num_env_steps_trained": 4512, "num_agent_steps_sampled": 4512, "num_agent_steps_trained": 4512}, "sampler_results": {"episode_reward_max": 0.014592376726997681, "episode_reward_min": 0.004632425343910513, "episode_reward_mean": 0.007515340966655193, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 667.3661384108848, "mean_inference_ms": 1.8393268836753223, "mean_action_processing_ms": 0.23054309752223262, "mean_env_wait_ms": 19.249491180613322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00806879997253418, "StateBufferConnector_ms": 0.00789642333984375, "ViewRequirementAgentConnector_ms": 0.18885374069213867}}, "episode_reward_max": 0.014592376726997681, "episode_reward_min": 0.004632425343910513, "episode_reward_mean": 0.007515340966655193, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.014592376726997681, 0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 667.3661384108848, "mean_inference_ms": 1.8393268836753223, "mean_action_processing_ms": 0.23054309752223262, "mean_env_wait_ms": 19.249491180613322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00806879997253418, "StateBufferConnector_ms": 0.00789642333984375, "ViewRequirementAgentConnector_ms": 0.18885374069213867}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4512, "num_agent_steps_trained": 4512, "num_env_steps_sampled": 4512, "num_env_steps_trained": 4512, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.577759477210433, "num_env_steps_trained_throughput_per_sec": 7.577759477210433, "timesteps_total": 4512, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 4512, "timers": {"training_iteration_time_ms": 5644.82, "sample_time_ms": 5634.536, "load_time_ms": 0.052, "load_throughput": 615960.202, "learn_time_ms": 3.711, "learn_throughput": 8623.324, "synch_weights_time_ms": 6.421}, "counters": {"num_env_steps_sampled": 4512, "num_env_steps_trained": 4512, "num_agent_steps_sampled": 4512, "num_agent_steps_trained": 4512}, "done": false, "episodes_total": 179, "training_iteration": 64, "trial_id": "3fc51_00000", "date": "2024-08-11_19-27-38", "timestamp": 1723368458, "time_this_iter_s": 12.6757173538208, "time_total_s": 1072.7801280021667, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1072.7801280021667, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 22.566666666666666, "ram_util_percent": 86.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.238503456115723, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.4164564907550812, "policy_loss": 0.0006698333891108632, "vf_loss": 0.047079768031835556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 142.0, "diff_num_grad_updates_vs_sampler_policy": 141.0}}, "num_env_steps_sampled": 4544, "num_env_steps_trained": 4544, "num_agent_steps_sampled": 4544, "num_agent_steps_trained": 4544}, "sampler_results": {"episode_reward_max": 0.01423050001967056, "episode_reward_min": 0.004632425343910513, "episode_reward_mean": 0.007416776144112811, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 666.9872014061622, "mean_inference_ms": 1.8367220499732468, "mean_action_processing_ms": 0.23066991899694383, "mean_env_wait_ms": 19.087723872455943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008072614669799805, "StateBufferConnector_ms": 0.008896589279174805, "ViewRequirementAgentConnector_ms": 0.18787145614624023}}, "episode_reward_max": 0.01423050001967056, "episode_reward_min": 0.004632425343910513, "episode_reward_mean": 0.007416776144112811, "episode_len_mean": 24.8, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.012718626961317425, 0.01423050001967056, 0.013530805330819164, 0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 666.9872014061622, "mean_inference_ms": 1.8367220499732468, "mean_action_processing_ms": 0.23066991899694383, "mean_env_wait_ms": 19.087723872455943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008072614669799805, "StateBufferConnector_ms": 0.008896589279174805, "ViewRequirementAgentConnector_ms": 0.18787145614624023}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4544, "num_agent_steps_trained": 4544, "num_env_steps_sampled": 4544, "num_env_steps_trained": 4544, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 3.110498229741506, "num_env_steps_trained_throughput_per_sec": 3.110498229741506, "timesteps_total": 4544, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 4544, "timers": {"training_iteration_time_ms": 5208.101, "sample_time_ms": 5197.173, "load_time_ms": 0.052, "load_throughput": 615960.202, "learn_time_ms": 4.35, "learn_throughput": 7356.613, "synch_weights_time_ms": 6.426}, "counters": {"num_env_steps_sampled": 4544, "num_env_steps_trained": 4544, "num_agent_steps_sampled": 4544, "num_agent_steps_trained": 4544}, "done": false, "episodes_total": 180, "training_iteration": 65, "trial_id": "3fc51_00000", "date": "2024-08-11_19-27-49", "timestamp": 1723368469, "time_this_iter_s": 10.291773796081543, "time_total_s": 1083.0719017982483, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1083.0719017982483, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 10.82142857142857, "ram_util_percent": 86.5142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.5322167873382568, "policy_loss": -0.019915765151381493, "vf_loss": 1.4358292818069458}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 144.0, "diff_num_grad_updates_vs_sampler_policy": 143.0}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": 0.013107558910827362, "episode_reward_min": 0.00453025004434077, "episode_reward_mean": 0.007150148491040854, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 665.5467004614494, "mean_inference_ms": 1.8280017096631942, "mean_action_processing_ms": 0.23053267540570932, "mean_env_wait_ms": 18.636932201224866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008072614669799805, "StateBufferConnector_ms": 0.008896589279174805, "ViewRequirementAgentConnector_ms": 0.1784968376159668}}, "episode_reward_max": 0.013107558910827362, "episode_reward_min": 0.00453025004434077, "episode_reward_mean": 0.007150148491040854, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.013107558910827362, 0.011775702054411457, 0.013060040890102138, 0.012468469020127318, 0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 665.5467004614494, "mean_inference_ms": 1.8280017096631942, "mean_action_processing_ms": 0.23053267540570932, "mean_env_wait_ms": 18.636932201224866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008072614669799805, "StateBufferConnector_ms": 0.008896589279174805, "ViewRequirementAgentConnector_ms": 0.1784968376159668}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 5.049282520058231, "num_env_steps_trained_throughput_per_sec": 5.049282520058231, "timesteps_total": 4608, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 6469.08, "sample_time_ms": 6457.628, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4.784, "learn_throughput": 6688.78, "synch_weights_time_ms": 6.568}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 183, "training_iteration": 66, "trial_id": "3fc51_00000", "date": "2024-08-11_19-28-01", "timestamp": 1723368481, "time_this_iter_s": 12.682665348052979, "time_total_s": 1095.7545671463013, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1095.7545671463013, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.71666666666667, "ram_util_percent": 87.10555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 1.6858851909637451, "policy_loss": 3.192753314971924, "vf_loss": 2.1566078662872314}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 147.0, "diff_num_grad_updates_vs_sampler_policy": 146.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": 0.2802219263895576, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.009584576320559444, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 662.5823489835926, "mean_inference_ms": 1.815707478501372, "mean_action_processing_ms": 0.22950184701424153, "mean_env_wait_ms": 18.064217375268417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006132602691650391, "StateBufferConnector_ms": 0.00796055793762207, "ViewRequirementAgentConnector_ms": 0.17020535469055176}}, "episode_reward_max": 0.2802219263895576, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.009584576320559444, "episode_len_mean": 24.8, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.012108272811115733, 0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 662.5823489835926, "mean_inference_ms": 1.815707478501372, "mean_action_processing_ms": 0.22950184701424153, "mean_env_wait_ms": 18.064217375268417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006132602691650391, "StateBufferConnector_ms": 0.00796055793762207, "ViewRequirementAgentConnector_ms": 0.17020535469055176}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.388215877022555, "num_env_steps_trained_throughput_per_sec": 4.388215877022555, "timesteps_total": 4704, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 7297.362, "sample_time_ms": 7285.727, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4.876, "learn_throughput": 6563.054, "synch_weights_time_ms": 6.759}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 187, "training_iteration": 67, "trial_id": "3fc51_00000", "date": "2024-08-11_19-28-23", "timestamp": 1723368503, "time_this_iter_s": 21.88582444190979, "time_total_s": 1117.640391588211, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1117.640391588211, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 15.445161290322579, "ram_util_percent": 86.9032258064516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.868844985961914, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 12.559359550476074, "policy_loss": 3.0403592586517334, "vf_loss": 1.3964669704437256}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 148.0, "diff_num_grad_updates_vs_sampler_policy": 147.0}}, "num_env_steps_sampled": 4736, "num_env_steps_trained": 4736, "num_agent_steps_sampled": 4736, "num_agent_steps_trained": 4736}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.021335207688733288, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 661.3654501788537, "mean_inference_ms": 1.8121913009753658, "mean_action_processing_ms": 0.22874526450763777, "mean_env_wait_ms": 17.925388300251367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006132602691650391, "StateBufferConnector_ms": 0.00796055793762207, "ViewRequirementAgentConnector_ms": 0.17280173301696777}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.021335207688733288, "episode_len_mean": 24.8, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.010878748696767014, 0.011965923461248262, 0.011467398079840907, 0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 661.3654501788537, "mean_inference_ms": 1.8121913009753658, "mean_action_processing_ms": 0.22874526450763777, "mean_env_wait_ms": 17.925388300251367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006132602691650391, "StateBufferConnector_ms": 0.00796055793762207, "ViewRequirementAgentConnector_ms": 0.17280173301696777}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4736, "num_agent_steps_trained": 4736, "num_env_steps_sampled": 4736, "num_env_steps_trained": 4736, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 3.0310949718969695, "num_env_steps_trained_throughput_per_sec": 3.0310949718969695, "timesteps_total": 4736, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 4736, "timers": {"training_iteration_time_ms": 6806.547, "sample_time_ms": 6794.359, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4.976, "learn_throughput": 6431.194, "synch_weights_time_ms": 7.213}, "counters": {"num_env_steps_sampled": 4736, "num_env_steps_trained": 4736, "num_agent_steps_sampled": 4736, "num_agent_steps_trained": 4736}, "done": false, "episodes_total": 188, "training_iteration": 68, "trial_id": "3fc51_00000", "date": "2024-08-11_19-28-34", "timestamp": 1723368514, "time_this_iter_s": 10.570324420928955, "time_total_s": 1128.21071600914, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1128.21071600914, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 10.393333333333334, "ram_util_percent": 86.98666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 4.027264595031738, "policy_loss": -0.43046021461486816, "vf_loss": 4.724509239196777}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 150.0, "diff_num_grad_updates_vs_sampler_policy": 149.0}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.025900316750968086, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464], "episode_lengths": [25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 659.0686054356114, "mean_inference_ms": 1.8038150786655651, "mean_action_processing_ms": 0.22861484017725556, "mean_env_wait_ms": 17.527851645685455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006132602691650391, "StateBufferConnector_ms": 0.008971691131591797, "ViewRequirementAgentConnector_ms": 0.1731863021850586}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.025900316750968086, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.01116199297847355, 0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464], "episode_lengths": [25, 25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 659.0686054356114, "mean_inference_ms": 1.8038150786655651, "mean_action_processing_ms": 0.22861484017725556, "mean_env_wait_ms": 17.527851645685455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006132602691650391, "StateBufferConnector_ms": 0.008971691131591797, "ViewRequirementAgentConnector_ms": 0.1731863021850586}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 4.2373731907827645, "num_env_steps_trained_throughput_per_sec": 4.2373731907827645, "timesteps_total": 4800, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 8309.374, "sample_time_ms": 8297.002, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5.129, "learn_throughput": 6239.174, "synch_weights_time_ms": 7.244}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "done": false, "episodes_total": 191, "training_iteration": 69, "trial_id": "3fc51_00000", "date": "2024-08-11_19-28-49", "timestamp": 1723368529, "time_this_iter_s": 15.10923147201538, "time_total_s": 1143.3199474811554, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1143.3199474811554, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 20.366666666666667, "ram_util_percent": 87.6190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 3.841331958770752, "policy_loss": -0.7055088877677917, "vf_loss": 0.7375656366348267}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 150.0}}, "num_env_steps_sampled": 4832, "num_env_steps_trained": 4832, "num_agent_steps_sampled": 4832, "num_agent_steps_trained": 4832}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.02805750349873327, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227], "episode_lengths": [25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 657.6750661183859, "mean_inference_ms": 1.8004695489341749, "mean_action_processing_ms": 0.22786162007738908, "mean_env_wait_ms": 17.397378752395195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005084991455078125, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.17018628120422363}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.02805750349873327, "episode_len_mean": 24.8, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.010163119387432877, 0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227], "episode_lengths": [25, 25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 657.6750661183859, "mean_inference_ms": 1.8004695489341749, "mean_action_processing_ms": 0.22786162007738908, "mean_env_wait_ms": 17.397378752395195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005084991455078125, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.17018628120422363}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4832, "num_agent_steps_trained": 4832, "num_env_steps_sampled": 4832, "num_env_steps_trained": 4832, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.5659297188708954, "num_env_steps_trained_throughput_per_sec": 2.5659297188708954, "timesteps_total": 4832, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 4832, "timers": {"training_iteration_time_ms": 8297.06, "sample_time_ms": 8285.054, "load_time_ms": 0.101, "load_throughput": 318051.488, "learn_time_ms": 5.529, "learn_throughput": 5787.292, "synch_weights_time_ms": 6.376}, "counters": {"num_env_steps_sampled": 4832, "num_env_steps_trained": 4832, "num_agent_steps_sampled": 4832, "num_agent_steps_trained": 4832}, "done": false, "episodes_total": 192, "training_iteration": 70, "trial_id": "3fc51_00000", "date": "2024-08-11_19-29-02", "timestamp": 1723368542, "time_this_iter_s": 12.47715425491333, "time_total_s": 1155.7971017360687, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1155.7971017360687, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 14.47777777777778, "ram_util_percent": 87.62777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 5.340634822845459, "policy_loss": 1.7792775630950928, "vf_loss": 1.3724443912506104}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 4896, "num_env_steps_trained": 4896, "num_agent_steps_sampled": 4896, "num_agent_steps_trained": 4896}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.02861442963196671, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652], "episode_lengths": [25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 656.5405584085536, "mean_inference_ms": 1.7978112192709326, "mean_action_processing_ms": 0.2279011171826361, "mean_env_wait_ms": 17.269450986024346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005084991455078125, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.16770148277282715}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.02861442963196671, "episode_len_mean": 24.8, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.011105690180942512, 0.010409884461953267, 0.01067501017984561, 0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652], "episode_lengths": [25, 25, 25, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 656.5405584085536, "mean_inference_ms": 1.7978112192709326, "mean_action_processing_ms": 0.2279011171826361, "mean_env_wait_ms": 17.269450986024346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005084991455078125, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.16770148277282715}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4896, "num_agent_steps_trained": 4896, "num_env_steps_sampled": 4896, "num_env_steps_trained": 4896, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 6.164495565031489, "num_env_steps_trained_throughput_per_sec": 6.164495565031489, "timesteps_total": 4896, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 4896, "timers": {"training_iteration_time_ms": 8302.509, "sample_time_ms": 8290.345, "load_time_ms": 0.204, "load_throughput": 156723.176, "learn_time_ms": 5.215, "learn_throughput": 6135.948, "synch_weights_time_ms": 6.745}, "counters": {"num_env_steps_sampled": 4896, "num_env_steps_trained": 4896, "num_agent_steps_sampled": 4896, "num_agent_steps_trained": 4896}, "done": false, "episodes_total": 193, "training_iteration": 71, "trial_id": "3fc51_00000", "date": "2024-08-11_19-29-12", "timestamp": 1723368552, "time_this_iter_s": 10.387511491775513, "time_total_s": 1166.1846132278442, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1166.1846132278442, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 12.406666666666668, "ram_util_percent": 86.48666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 9.844440460205078, "policy_loss": 3.3145391941070557, "vf_loss": 1.1796895265579224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 154.0, "diff_num_grad_updates_vs_sampler_policy": 153.0}}, "num_env_steps_sampled": 4928, "num_env_steps_trained": 4928, "num_agent_steps_sampled": 4928, "num_agent_steps_trained": 4928}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.029927039330585114, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426], "episode_lengths": [20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 654.3915392469066, "mean_inference_ms": 1.7891611132798448, "mean_action_processing_ms": 0.22698778515318588, "mean_env_wait_ms": 16.904985938082532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060882568359375, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.162994384765625}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.029927039330585114, "episode_len_mean": 24.8, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00785801099269102, 0.007682078717841169, 0.008351529069519463, 0.00804650277563366, 0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426], "episode_lengths": [20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 654.3915392469066, "mean_inference_ms": 1.7891611132798448, "mean_action_processing_ms": 0.22698778515318588, "mean_env_wait_ms": 16.904985938082532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060882568359375, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.162994384765625}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4928, "num_agent_steps_trained": 4928, "num_env_steps_sampled": 4928, "num_env_steps_trained": 4928, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.0380280731806892, "num_env_steps_trained_throughput_per_sec": 2.0380280731806892, "timesteps_total": 4928, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 4928, "timers": {"training_iteration_time_ms": 8609.128, "sample_time_ms": 8596.972, "load_time_ms": 0.204, "load_throughput": 156723.176, "learn_time_ms": 5.119, "learn_throughput": 6250.913, "synch_weights_time_ms": 6.832}, "counters": {"num_env_steps_sampled": 4928, "num_env_steps_trained": 4928, "num_agent_steps_sampled": 4928, "num_agent_steps_trained": 4928}, "done": false, "episodes_total": 196, "training_iteration": 72, "trial_id": "3fc51_00000", "date": "2024-08-11_19-29-28", "timestamp": 1723368568, "time_this_iter_s": 15.70970344543457, "time_total_s": 1181.8943166732788, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1181.8943166732788, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.23181818181818, "ram_util_percent": 86.58181818181816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 9.77649211883545, "policy_loss": -3.3913238048553467, "vf_loss": 1.2379122972488403}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 157.0, "diff_num_grad_updates_vs_sampler_policy": 156.0}}, "num_env_steps_sampled": 5024, "num_env_steps_trained": 5024, "num_agent_steps_sampled": 5024, "num_agent_steps_trained": 5024}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.030530404299456224, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 651.1481713006406, "mean_inference_ms": 1.7786859259650853, "mean_action_processing_ms": 0.22618723275655828, "mean_env_wait_ms": 16.430573211620555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013082504272461, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.16867804527282715}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.030530404299456224, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.009153772870337267, 0.009911318061733674, 0.00956690814857587, 0.009353447530668054, 0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 651.1481713006406, "mean_inference_ms": 1.7786859259650853, "mean_action_processing_ms": 0.22618723275655828, "mean_env_wait_ms": 16.430573211620555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013082504272461, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.16867804527282715}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5024, "num_agent_steps_trained": 5024, "num_env_steps_sampled": 5024, "num_env_steps_trained": 5024, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.645049026260881, "num_env_steps_trained_throughput_per_sec": 6.645049026260881, "timesteps_total": 5024, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5024, "timers": {"training_iteration_time_ms": 7866.135, "sample_time_ms": 7853.813, "load_time_ms": 0.304, "load_throughput": 105334.899, "learn_time_ms": 5.34, "learn_throughput": 5992.425, "synch_weights_time_ms": 6.678}, "counters": {"num_env_steps_sampled": 5024, "num_env_steps_trained": 5024, "num_agent_steps_sampled": 5024, "num_agent_steps_trained": 5024}, "done": false, "episodes_total": 200, "training_iteration": 73, "trial_id": "3fc51_00000", "date": "2024-08-11_19-29-43", "timestamp": 1723368583, "time_this_iter_s": 14.45457148551941, "time_total_s": 1196.3488881587982, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1196.3488881587982, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.464999999999996, "ram_util_percent": 86.655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.07005245238542557, "policy_loss": 0.0014300410402938724, "vf_loss": 1.0330729484558105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 160.0, "diff_num_grad_updates_vs_sampler_policy": 159.0}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031004236290852707, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 647.6300476790733, "mean_inference_ms": 1.7687058401051639, "mean_action_processing_ms": 0.22537674864153384, "mean_env_wait_ms": 15.984817444642031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013082504272461, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.17366504669189453}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031004236290852707, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.008734053481616506, 0.00942103601583529, 0.009109354687175417, 0.00891563697955235, 0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 647.6300476790733, "mean_inference_ms": 1.7687058401051639, "mean_action_processing_ms": 0.22537674864153384, "mean_env_wait_ms": 15.984817444642031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013082504272461, "StateBufferConnector_ms": 0.009979724884033203, "ViewRequirementAgentConnector_ms": 0.17366504669189453}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.535558709320709, "num_env_steps_trained_throughput_per_sec": 6.535558709320709, "timesteps_total": 5120, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 6768.929, "sample_time_ms": 6757.476, "load_time_ms": 0.502, "load_throughput": 63712.963, "learn_time_ms": 4.878, "learn_throughput": 6560.423, "synch_weights_time_ms": 6.074}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 204, "training_iteration": 74, "trial_id": "3fc51_00000", "date": "2024-08-11_19-29-57", "timestamp": 1723368597, "time_this_iter_s": 14.693880081176758, "time_total_s": 1211.042768239975, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1211.042768239975, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.842857142857138, "ram_util_percent": 86.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.0014135879464447498, "policy_loss": -2.3076223442330956e-05, "vf_loss": 0.9256797432899475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 163.0, "diff_num_grad_updates_vs_sampler_policy": 162.0}}, "num_env_steps_sampled": 5216, "num_env_steps_trained": 5216, "num_agent_steps_sampled": 5216, "num_agent_steps_trained": 5216}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031243905545996747, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 644.0345085989169, "mean_inference_ms": 1.7585928085030098, "mean_action_processing_ms": 0.22437836265039685, "mean_env_wait_ms": 15.562652049267413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013559341430664, "StateBufferConnector_ms": 0.010487079620361328, "ViewRequirementAgentConnector_ms": 0.16566872596740723}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031243905545996747, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.008262462152241724, 0.008874797525806014, 0.008597621959131408, 0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 644.0345085989169, "mean_inference_ms": 1.7585928085030098, "mean_action_processing_ms": 0.22437836265039685, "mean_env_wait_ms": 15.562652049267413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013559341430664, "StateBufferConnector_ms": 0.010487079620361328, "ViewRequirementAgentConnector_ms": 0.16566872596740723}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5216, "num_agent_steps_trained": 5216, "num_env_steps_sampled": 5216, "num_env_steps_trained": 5216, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.531962872983243, "num_env_steps_trained_throughput_per_sec": 6.531962872983243, "timesteps_total": 5216, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5216, "timers": {"training_iteration_time_ms": 5953.413, "sample_time_ms": 5942.865, "load_time_ms": 0.298, "load_throughput": 107357.005, "learn_time_ms": 4.025, "learn_throughput": 7951.287, "synch_weights_time_ms": 6.226}, "counters": {"num_env_steps_sampled": 5216, "num_env_steps_trained": 5216, "num_agent_steps_sampled": 5216, "num_agent_steps_trained": 5216}, "done": false, "episodes_total": 208, "training_iteration": 75, "trial_id": "3fc51_00000", "date": "2024-08-11_19-30-12", "timestamp": 1723368612, "time_this_iter_s": 14.69696044921875, "time_total_s": 1225.7397286891937, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1225.7397286891937, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 21.98095238095238, "ram_util_percent": 86.97619047619047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.88279724121094, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 6.909148214617744e-05, "policy_loss": 0.0, "vf_loss": 0.5444605350494385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 166.0, "diff_num_grad_updates_vs_sampler_policy": 165.0}}, "num_env_steps_sampled": 5312, "num_env_steps_trained": 5312, "num_agent_steps_sampled": 5312, "num_agent_steps_trained": 5312}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031337803871765234, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 641.8217362535025, "mean_inference_ms": 1.751885313908276, "mean_action_processing_ms": 0.22420796877032292, "mean_env_wait_ms": 15.260472747889002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015993356704711914, "StateBufferConnector_ms": 0.009531497955322266, "ViewRequirementAgentConnector_ms": 0.1665799617767334}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031337803871765234, "episode_len_mean": 25.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00842481654750285, 0.0077599475711346505, 0.00829761436163197, 0.007902976831937497, 0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 641.8217362535025, "mean_inference_ms": 1.751885313908276, "mean_action_processing_ms": 0.22420796877032292, "mean_env_wait_ms": 15.260472747889002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015993356704711914, "StateBufferConnector_ms": 0.009531497955322266, "ViewRequirementAgentConnector_ms": 0.1665799617767334}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5312, "num_agent_steps_trained": 5312, "num_env_steps_sampled": 5312, "num_env_steps_trained": 5312, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.447568662940797, "num_env_steps_trained_throughput_per_sec": 6.447568662940797, "timesteps_total": 5312, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5312, "timers": {"training_iteration_time_ms": 5863.491, "sample_time_ms": 5853.388, "load_time_ms": 0.298, "load_throughput": 107357.005, "learn_time_ms": 4.683, "learn_throughput": 6832.957, "synch_weights_time_ms": 5.021}, "counters": {"num_env_steps_sampled": 5312, "num_env_steps_trained": 5312, "num_agent_steps_sampled": 5312, "num_agent_steps_trained": 5312}, "done": false, "episodes_total": 211, "training_iteration": 76, "trial_id": "3fc51_00000", "date": "2024-08-11_19-30-27", "timestamp": 1723368627, "time_this_iter_s": 14.898307800292969, "time_total_s": 1240.6380364894867, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1240.6380364894867, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.123809523809523, "ram_util_percent": 85.75238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 7.91593538451707e-06, "policy_loss": 0.0, "vf_loss": 0.6276434659957886}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 169.0, "diff_num_grad_updates_vs_sampler_policy": 168.0}}, "num_env_steps_sampled": 5408, "num_env_steps_trained": 5408, "num_agent_steps_sampled": 5408, "num_agent_steps_trained": 5408}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031425576136019484, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 637.908905604669, "mean_inference_ms": 1.7428627939901713, "mean_action_processing_ms": 0.22281370185177551, "mean_env_wait_ms": 14.875510307514489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.009590625762939453, "ViewRequirementAgentConnector_ms": 0.158843994140625}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031425576136019484, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.007397891286333716, 0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 637.908905604669, "mean_inference_ms": 1.7428627939901713, "mean_action_processing_ms": 0.22281370185177551, "mean_env_wait_ms": 14.875510307514489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.009590625762939453, "ViewRequirementAgentConnector_ms": 0.158843994140625}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5408, "num_agent_steps_trained": 5408, "num_env_steps_sampled": 5408, "num_env_steps_trained": 5408, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.593586794340408, "num_env_steps_trained_throughput_per_sec": 4.593586794340408, "timesteps_total": 5408, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5408, "timers": {"training_iteration_time_ms": 6510.362, "sample_time_ms": 6499.877, "load_time_ms": 0.1, "load_throughput": 321018.244, "learn_time_ms": 4.388, "learn_throughput": 7293.173, "synch_weights_time_ms": 5.897}, "counters": {"num_env_steps_sampled": 5408, "num_env_steps_trained": 5408, "num_agent_steps_sampled": 5408, "num_agent_steps_trained": 5408}, "done": false, "episodes_total": 215, "training_iteration": 77, "trial_id": "3fc51_00000", "date": "2024-08-11_19-30-48", "timestamp": 1723368648, "time_this_iter_s": 20.898701667785645, "time_total_s": 1261.5367381572723, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1261.5367381572723, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 16.43103448275862, "ram_util_percent": 83.71724137931034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.021260261535645, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 4.402036211104132e-06, "policy_loss": 0.0, "vf_loss": 0.02032572031021118}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 170.0, "diff_num_grad_updates_vs_sampler_policy": 169.0}}, "num_env_steps_sampled": 5440, "num_env_steps_trained": 5440, "num_agent_steps_sampled": 5440, "num_agent_steps_trained": 5440}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03144800127516756, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 636.469573488731, "mean_inference_ms": 1.7404940204682606, "mean_action_processing_ms": 0.22264183718811828, "mean_env_wait_ms": 14.784604734914863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.009590625762939453, "ViewRequirementAgentConnector_ms": 0.15509676933288574}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03144800127516756, "episode_len_mean": 25.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.007884892201358308, 0.008054837810207235, 0.007527751856060239, 0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 636.469573488731, "mean_inference_ms": 1.7404940204682606, "mean_action_processing_ms": 0.22264183718811828, "mean_env_wait_ms": 14.784604734914863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.009590625762939453, "ViewRequirementAgentConnector_ms": 0.15509676933288574}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440, "num_agent_steps_trained": 5440, "num_env_steps_sampled": 5440, "num_env_steps_trained": 5440, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 1.8206350076002829, "num_env_steps_trained_throughput_per_sec": 1.8206350076002829, "timesteps_total": 5440, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 5440, "timers": {"training_iteration_time_ms": 6806.128, "sample_time_ms": 6795.097, "load_time_ms": 0.1, "load_throughput": 321018.244, "learn_time_ms": 4.686, "learn_throughput": 6828.23, "synch_weights_time_ms": 6.145}, "counters": {"num_env_steps_sampled": 5440, "num_env_steps_trained": 5440, "num_agent_steps_sampled": 5440, "num_agent_steps_trained": 5440}, "done": false, "episodes_total": 216, "training_iteration": 78, "trial_id": "3fc51_00000", "date": "2024-08-11_19-31-06", "timestamp": 1723368666, "time_this_iter_s": 17.586286306381226, "time_total_s": 1279.1230244636536, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1279.1230244636536, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 36.16799999999999, "ram_util_percent": 86.348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 1.6183537354663713e-06, "policy_loss": 0.0, "vf_loss": 0.7466333508491516}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 172.0, "diff_num_grad_updates_vs_sampler_policy": 171.0}}, "num_env_steps_sampled": 5504, "num_env_steps_trained": 5504, "num_agent_steps_sampled": 5504, "num_agent_steps_trained": 5504}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031462756811316106, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 635.1519119590216, "mean_inference_ms": 1.7346955922385552, "mean_action_processing_ms": 0.22220355871846437, "mean_env_wait_ms": 14.515016005790544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.008591890335083008, "ViewRequirementAgentConnector_ms": 0.15993571281433105}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031462756811316106, "episode_len_mean": 25.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.007077739732649977, 0.007522185013718171, 0.007665385232445672, 0.00719650128608236, 0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 635.1519119590216, "mean_inference_ms": 1.7346955922385552, "mean_action_processing_ms": 0.22220355871846437, "mean_env_wait_ms": 14.515016005790544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.008591890335083008, "ViewRequirementAgentConnector_ms": 0.15993571281433105}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5504, "num_agent_steps_trained": 5504, "num_env_steps_sampled": 5504, "num_env_steps_trained": 5504, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.0914511624964094, "num_env_steps_trained_throughput_per_sec": 3.0914511624964094, "timesteps_total": 5504, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 5504, "timers": {"training_iteration_time_ms": 8870.39, "sample_time_ms": 8857.236, "load_time_ms": 0.1, "load_throughput": 321018.244, "learn_time_ms": 5.403, "learn_throughput": 5922.172, "synch_weights_time_ms": 7.551}, "counters": {"num_env_steps_sampled": 5504, "num_env_steps_trained": 5504, "num_agent_steps_sampled": 5504, "num_agent_steps_trained": 5504}, "done": false, "episodes_total": 219, "training_iteration": 79, "trial_id": "3fc51_00000", "date": "2024-08-11_19-31-26", "timestamp": 1723368686, "time_this_iter_s": 20.714561700820923, "time_total_s": 1299.8375861644745, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1299.8375861644745, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 43.49655172413794, "ram_util_percent": 90.06896551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 5.200204213906545e-07, "policy_loss": 0.0, "vf_loss": 0.951955258846283}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 175.0, "diff_num_grad_updates_vs_sampler_policy": 174.0}}, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 5600}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.0314638907722887, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 632.5353566571808, "mean_inference_ms": 1.727158363805817, "mean_action_processing_ms": 0.22169766708226013, "mean_env_wait_ms": 14.170462601822821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.008591890335083008, "ViewRequirementAgentConnector_ms": 0.1612238883972168}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.0314638907722887, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00680569715903242, 0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 632.5353566571808, "mean_inference_ms": 1.727158363805817, "mean_action_processing_ms": 0.22169766708226013, "mean_env_wait_ms": 14.170462601822821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.008591890335083008, "ViewRequirementAgentConnector_ms": 0.1612238883972168}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 5600, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.206956553301446, "num_env_steps_trained_throughput_per_sec": 4.206956553301446, "timesteps_total": 5600, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5600, "timers": {"training_iteration_time_ms": 9682.21, "sample_time_ms": 9666.356, "load_time_ms": 0.1, "load_throughput": 321018.244, "learn_time_ms": 7.354, "learn_throughput": 4351.178, "synch_weights_time_ms": 8.3}, "counters": {"num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 5600}, "done": false, "episodes_total": 223, "training_iteration": 80, "trial_id": "3fc51_00000", "date": "2024-08-11_19-31-49", "timestamp": 1723368709, "time_this_iter_s": 22.827205657958984, "time_total_s": 1322.6647918224335, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1322.6647918224335, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.431250000000002, "ram_util_percent": 87.85625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.383108139038086, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 3.8057640949773486e-07, "policy_loss": 0.0, "vf_loss": 0.10141536593437195}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 175.0}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03146576672458022, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 631.1846048490727, "mean_inference_ms": 1.7251927362800157, "mean_action_processing_ms": 0.22160301217552889, "mean_env_wait_ms": 14.087879532681963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.008591890335083008, "ViewRequirementAgentConnector_ms": 0.15763354301452637}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03146576672458022, "episode_len_mean": 25.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.007215653868378978, 0.007322173732318067, 0.006915436337039935, 0.0070314076023375496, 0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 631.1846048490727, "mean_inference_ms": 1.7251927362800157, "mean_action_processing_ms": 0.22160301217552889, "mean_env_wait_ms": 14.087879532681963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.008591890335083008, "ViewRequirementAgentConnector_ms": 0.15763354301452637}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.7524993987136903, "num_env_steps_trained_throughput_per_sec": 2.7524993987136903, "timesteps_total": 5632, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 9362.238, "sample_time_ms": 9348.073, "load_time_ms": 0.1, "load_throughput": 321018.244, "learn_time_ms": 6.454, "learn_throughput": 4957.953, "synch_weights_time_ms": 7.611}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 224, "training_iteration": 81, "trial_id": "3fc51_00000", "date": "2024-08-11_19-32-01", "timestamp": 1723368721, "time_this_iter_s": 11.657047271728516, "time_total_s": 1334.321839094162, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1334.321839094162, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 12.652941176470588, "ram_util_percent": 88.12352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.57308578491211, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 1.7415260344932904e-07, "policy_loss": 0.0, "vf_loss": 0.12153927236795425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 179.0, "diff_num_grad_updates_vs_sampler_policy": 178.0}}, "num_env_steps_sampled": 5728, "num_env_steps_trained": 5728, "num_agent_steps_sampled": 5728, "num_agent_steps_trained": 5728}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03143542181509995, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 629.6392461253236, "mean_inference_ms": 1.7180861414865416, "mean_action_processing_ms": 0.2213581527328459, "mean_env_wait_ms": 13.763352954033612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.009589672088623047, "ViewRequirementAgentConnector_ms": 0.1578044891357422}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03143542181509995, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.006692088744225598, 0.006589274526421736, 0.006972822361861829, 0.0068006270419335435, 0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 629.6392461253236, "mean_inference_ms": 1.7180861414865416, "mean_action_processing_ms": 0.2213581527328459, "mean_env_wait_ms": 13.763352954033612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707935333251953, "StateBufferConnector_ms": 0.009589672088623047, "ViewRequirementAgentConnector_ms": 0.1578044891357422}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5728, "num_agent_steps_trained": 5728, "num_env_steps_sampled": 5728, "num_env_steps_trained": 5728, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.116592173619135, "num_env_steps_trained_throughput_per_sec": 4.116592173619135, "timesteps_total": 5728, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5728, "timers": {"training_iteration_time_ms": 9604.394, "sample_time_ms": 9590.252, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 6.632, "learn_throughput": 4825.372, "synch_weights_time_ms": 7.511}, "counters": {"num_env_steps_sampled": 5728, "num_env_steps_trained": 5728, "num_agent_steps_sampled": 5728, "num_agent_steps_trained": 5728}, "done": false, "episodes_total": 228, "training_iteration": 82, "trial_id": "3fc51_00000", "date": "2024-08-11_19-32-25", "timestamp": 1723368745, "time_this_iter_s": 23.320260047912598, "time_total_s": 1357.6420991420746, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1357.6420991420746, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.936363636363637, "ram_util_percent": 88.21515151515152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.907099723815918, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 9.835959247084247e-08, "policy_loss": 0.0, "vf_loss": 0.012047108262777328}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 182.0, "diff_num_grad_updates_vs_sampler_policy": 181.0}}, "num_env_steps_sampled": 5824, "num_env_steps_trained": 5824, "num_agent_steps_sampled": 5824, "num_agent_steps_trained": 5824}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03139725989457866, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 627.443128297137, "mean_inference_ms": 1.7118747387851139, "mean_action_processing_ms": 0.22104178166875385, "mean_env_wait_ms": 13.452467854420302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01914191246032715, "StateBufferConnector_ms": 0.009589672088623047, "ViewRequirementAgentConnector_ms": 0.16147756576538086}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03139725989457866, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.006343601225625346, 0.00669834285873991, 0.006539269648491723, 0.006438843970696355, 0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 627.443128297137, "mean_inference_ms": 1.7118747387851139, "mean_action_processing_ms": 0.22104178166875385, "mean_env_wait_ms": 13.452467854420302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01914191246032715, "StateBufferConnector_ms": 0.009589672088623047, "ViewRequirementAgentConnector_ms": 0.16147756576538086}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5824, "num_agent_steps_trained": 5824, "num_env_steps_sampled": 5824, "num_env_steps_trained": 5824, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.417157179934087, "num_env_steps_trained_throughput_per_sec": 6.417157179934087, "timesteps_total": 5824, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5824, "timers": {"training_iteration_time_ms": 7272.53, "sample_time_ms": 7260.584, "load_time_ms": 0.067, "load_throughput": 480550.405, "learn_time_ms": 5.196, "learn_throughput": 6158.132, "synch_weights_time_ms": 6.683}, "counters": {"num_env_steps_sampled": 5824, "num_env_steps_trained": 5824, "num_agent_steps_sampled": 5824, "num_agent_steps_trained": 5824}, "done": false, "episodes_total": 232, "training_iteration": 83, "trial_id": "3fc51_00000", "date": "2024-08-11_19-32-40", "timestamp": 1723368760, "time_this_iter_s": 14.97551941871643, "time_total_s": 1372.617618560791, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1372.617618560791, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 28.238095238095237, "ram_util_percent": 87.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.970139503479004, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 6.638982341655719e-08, "policy_loss": 0.0, "vf_loss": 0.008242362178862095}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 184.0}}, "num_env_steps_sampled": 5920, "num_env_steps_trained": 5920, "num_agent_steps_sampled": 5920, "num_agent_steps_trained": 5920}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031347600151037464, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 625.4714620209605, "mean_inference_ms": 1.7057719134338936, "mean_action_processing_ms": 0.22058616119378055, "mean_env_wait_ms": 13.156768726685593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01914191246032715, "StateBufferConnector_ms": 0.008587837219238281, "ViewRequirementAgentConnector_ms": 0.15246915817260742}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.031347600151037464, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.006137077468913663, 0.006468466827138687, 0.0063200150136553295, 0.0062261694663974685, 0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 625.4714620209605, "mean_inference_ms": 1.7057719134338936, "mean_action_processing_ms": 0.22058616119378055, "mean_env_wait_ms": 13.156768726685593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01914191246032715, "StateBufferConnector_ms": 0.008587837219238281, "ViewRequirementAgentConnector_ms": 0.15246915817260742}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920, "num_agent_steps_trained": 5920, "num_env_steps_sampled": 5920, "num_env_steps_trained": 5920, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.8882159735792365, "num_env_steps_trained_throughput_per_sec": 5.8882159735792365, "timesteps_total": 5920, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 5920, "timers": {"training_iteration_time_ms": 6620.97, "sample_time_ms": 6611.715, "load_time_ms": 0.127, "load_throughput": 251862.879, "learn_time_ms": 2.249, "learn_throughput": 14229.436, "synch_weights_time_ms": 6.879}, "counters": {"num_env_steps_sampled": 5920, "num_env_steps_trained": 5920, "num_agent_steps_sampled": 5920, "num_agent_steps_trained": 5920}, "done": false, "episodes_total": 236, "training_iteration": 84, "trial_id": "3fc51_00000", "date": "2024-08-11_19-32-56", "timestamp": 1723368776, "time_this_iter_s": 16.31270956993103, "time_total_s": 1388.930328130722, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1388.930328130722, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 23.75217391304348, "ram_util_percent": 88.29130434782608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.096160888671875, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 4.988524082705226e-08, "policy_loss": 0.0, "vf_loss": 0.08258213847875595}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 188.0, "diff_num_grad_updates_vs_sampler_policy": 187.0}}, "num_env_steps_sampled": 6016, "num_env_steps_trained": 6016, "num_agent_steps_sampled": 6016, "num_agent_steps_trained": 6016}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03128761337277154, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 623.5637524343858, "mean_inference_ms": 1.7001227557006626, "mean_action_processing_ms": 0.22016758450740226, "mean_env_wait_ms": 12.873743716289564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018143415451049805, "StateBufferConnector_ms": 0.008587837219238281, "ViewRequirementAgentConnector_ms": 0.15702533721923828}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.00444078551714112, "episode_reward_mean": 0.03128761337277154, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.005949594122259086, 0.006260527563962609, 0.006121366198012158, 0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 623.5637524343858, "mean_inference_ms": 1.7001227557006626, "mean_action_processing_ms": 0.22016758450740226, "mean_env_wait_ms": 12.873743716289564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018143415451049805, "StateBufferConnector_ms": 0.008587837219238281, "ViewRequirementAgentConnector_ms": 0.15702533721923828}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6016, "num_agent_steps_trained": 6016, "num_env_steps_sampled": 6016, "num_env_steps_trained": 6016, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.255017298990088, "num_env_steps_trained_throughput_per_sec": 6.255017298990088, "timesteps_total": 6016, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6016, "timers": {"training_iteration_time_ms": 6032.057, "sample_time_ms": 6021.833, "load_time_ms": 0.227, "load_throughput": 140866.633, "learn_time_ms": 2.72, "learn_throughput": 11765.641, "synch_weights_time_ms": 7.276}, "counters": {"num_env_steps_sampled": 6016, "num_env_steps_trained": 6016, "num_agent_steps_sampled": 6016, "num_agent_steps_trained": 6016}, "done": false, "episodes_total": 240, "training_iteration": 85, "trial_id": "3fc51_00000", "date": "2024-08-11_19-33-11", "timestamp": 1723368791, "time_this_iter_s": 15.355448961257935, "time_total_s": 1404.28577709198, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1404.28577709198, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.83636363636364, "ram_util_percent": 88.70909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.343446731567383, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 3.969460138364411e-08, "policy_loss": 0.0, "vf_loss": 0.15629413723945618}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 6112, "num_env_steps_trained": 6112, "num_agent_steps_sampled": 6112, "num_agent_steps_trained": 6112}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.004338471915045095, "episode_reward_mean": 0.031236446130939313, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 622.5813357772628, "mean_inference_ms": 1.6963357559147922, "mean_action_processing_ms": 0.22029045699643254, "mean_env_wait_ms": 12.668842305137582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018143415451049805, "StateBufferConnector_ms": 0.008587837219238281, "ViewRequirementAgentConnector_ms": 0.15506839752197266}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.004338471915045095, "episode_reward_mean": 0.031236446130939313, "episode_len_mean": 25.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0060332875500768894, 0.005752501545936463, 0.006042686289385207, 0.005830708626346977, 0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 622.5813357772628, "mean_inference_ms": 1.6963357559147922, "mean_action_processing_ms": 0.22029045699643254, "mean_env_wait_ms": 12.668842305137582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018143415451049805, "StateBufferConnector_ms": 0.008587837219238281, "ViewRequirementAgentConnector_ms": 0.15506839752197266}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6112, "num_agent_steps_trained": 6112, "num_env_steps_sampled": 6112, "num_env_steps_trained": 6112, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 6.750637981798351, "num_env_steps_trained_throughput_per_sec": 6.750637981798351, "timesteps_total": 6112, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6112, "timers": {"training_iteration_time_ms": 6072.287, "sample_time_ms": 6064.397, "load_time_ms": 0.264, "load_throughput": 121211.711, "learn_time_ms": 3.128, "learn_throughput": 10231.024, "synch_weights_time_ms": 4.498}, "counters": {"num_env_steps_sampled": 6112, "num_env_steps_trained": 6112, "num_agent_steps_sampled": 6112, "num_agent_steps_trained": 6112}, "done": false, "episodes_total": 243, "training_iteration": 86, "trial_id": "3fc51_00000", "date": "2024-08-11_19-33-26", "timestamp": 1723368806, "time_this_iter_s": 14.22087812423706, "time_total_s": 1418.506655216217, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1418.506655216217, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 22.645, "ram_util_percent": 88.57000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.749860763549805, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 3.4048717623136326e-08, "policy_loss": 0.0, "vf_loss": 0.3096044063568115}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 194.0, "diff_num_grad_updates_vs_sampler_policy": 193.0}}, "num_env_steps_sampled": 6208, "num_env_steps_trained": 6208, "num_agent_steps_sampled": 6208, "num_agent_steps_trained": 6208}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.004012373689962439, "episode_reward_mean": 0.031165330723871086, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 620.2607025404127, "mean_inference_ms": 1.6912275044951994, "mean_action_processing_ms": 0.21939581610488204, "mean_env_wait_ms": 12.406640766346067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018143415451049805, "StateBufferConnector_ms": 0.0075991153717041016, "ViewRequirementAgentConnector_ms": 0.14988994598388672}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.004012373689962439, "episode_reward_mean": 0.031165330723871086, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.005587971553153783, 0.0058613959775511105, 0.005912935007076777, 0.005661739308577917, 0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 620.2607025404127, "mean_inference_ms": 1.6912275044951994, "mean_action_processing_ms": 0.21939581610488204, "mean_env_wait_ms": 12.406640766346067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018143415451049805, "StateBufferConnector_ms": 0.0075991153717041016, "ViewRequirementAgentConnector_ms": 0.14988994598388672}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6208, "num_agent_steps_trained": 6208, "num_env_steps_sampled": 6208, "num_env_steps_trained": 6208, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.143356383548676, "num_env_steps_trained_throughput_per_sec": 4.143356383548676, "timesteps_total": 6208, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6208, "timers": {"training_iteration_time_ms": 6896.38, "sample_time_ms": 6886.253, "load_time_ms": 0.264, "load_throughput": 121211.711, "learn_time_ms": 5.108, "learn_throughput": 6265.24, "synch_weights_time_ms": 4.756}, "counters": {"num_env_steps_sampled": 6208, "num_env_steps_trained": 6208, "num_agent_steps_sampled": 6208, "num_agent_steps_trained": 6208}, "done": false, "episodes_total": 247, "training_iteration": 87, "trial_id": "3fc51_00000", "date": "2024-08-11_19-33-49", "timestamp": 1723368829, "time_this_iter_s": 23.175617694854736, "time_total_s": 1441.6822729110718, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1441.6822729110718, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.646875, "ram_util_percent": 89.115625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 3.004547011187242e-08, "policy_loss": 0.0, "vf_loss": 0.508527398109436}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 197.0, "diff_num_grad_updates_vs_sampler_policy": 196.0}}, "num_env_steps_sampled": 6304, "num_env_steps_trained": 6304, "num_agent_steps_sampled": 6304, "num_agent_steps_trained": 6304}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0037826366020673585, "episode_reward_mean": 0.031090220351168044, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 618.546726242054, "mean_inference_ms": 1.6866364397323943, "mean_action_processing_ms": 0.21899596016456283, "mean_env_wait_ms": 12.157119424060083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016122102737426758, "StateBufferConnector_ms": 0.0075991153717041016, "ViewRequirementAgentConnector_ms": 0.1544489860534668}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0037826366020673585, "episode_reward_mean": 0.031090220351168044, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.005411297769339644, 0.0056673186603579005, 0.005739236335408322, 0.005480448038632676, 0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 618.546726242054, "mean_inference_ms": 1.6866364397323943, "mean_action_processing_ms": 0.21899596016456283, "mean_env_wait_ms": 12.157119424060083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016122102737426758, "StateBufferConnector_ms": 0.0075991153717041016, "ViewRequirementAgentConnector_ms": 0.1544489860534668}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6304, "num_agent_steps_trained": 6304, "num_env_steps_sampled": 6304, "num_env_steps_trained": 6304, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.926370026863278, "num_env_steps_trained_throughput_per_sec": 4.926370026863278, "timesteps_total": 6304, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6304, "timers": {"training_iteration_time_ms": 7214.415, "sample_time_ms": 7205.009, "load_time_ms": 0.203, "load_throughput": 157347.864, "learn_time_ms": 5.018, "learn_throughput": 6377.533, "synch_weights_time_ms": 4.185}, "counters": {"num_env_steps_sampled": 6304, "num_env_steps_trained": 6304, "num_agent_steps_sampled": 6304, "num_agent_steps_trained": 6304}, "done": false, "episodes_total": 251, "training_iteration": 88, "trial_id": "3fc51_00000", "date": "2024-08-11_19-34-08", "timestamp": 1723368848, "time_this_iter_s": 19.492005825042725, "time_total_s": 1461.1742787361145, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1461.1742787361145, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 16.132142857142856, "ram_util_percent": 89.29285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.7983812600496094e-08, "policy_loss": 0.0, "vf_loss": 1.1430492401123047}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 200.0, "diff_num_grad_updates_vs_sampler_policy": 199.0}}, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.003484346731540641, "episode_reward_mean": 0.031010888326680582, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 616.9766124602352, "mean_inference_ms": 1.6819123094594708, "mean_action_processing_ms": 0.21857557269378183, "mean_env_wait_ms": 11.917311556057257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016122102737426758, "StateBufferConnector_ms": 0.008594512939453125, "ViewRequirementAgentConnector_ms": 0.15106630325317383}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.003484346731540641, "episode_reward_mean": 0.031010888326680582, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0055530321393915975, 0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 616.9766124602352, "mean_inference_ms": 1.6819123094594708, "mean_action_processing_ms": 0.21857557269378183, "mean_env_wait_ms": 11.917311556057257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016122102737426758, "StateBufferConnector_ms": 0.008594512939453125, "ViewRequirementAgentConnector_ms": 0.15106630325317383}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.05608581979132, "num_env_steps_trained_throughput_per_sec": 4.05608581979132, "timesteps_total": 6400, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 8048.104, "sample_time_ms": 8037.762, "load_time_ms": 0.199, "load_throughput": 161087.048, "learn_time_ms": 4.364, "learn_throughput": 7332.539, "synch_weights_time_ms": 5.779}, "counters": {"num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 255, "training_iteration": 89, "trial_id": "3fc51_00000", "date": "2024-08-11_19-34-32", "timestamp": 1723368872, "time_this_iter_s": 23.66813826560974, "time_total_s": 1484.8424170017242, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1484.8424170017242, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 16.7, "ram_util_percent": 89.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.54520606994629, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.7492820464658507e-08, "policy_loss": 0.0, "vf_loss": 0.18734502792358398}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 201.0, "diff_num_grad_updates_vs_sampler_policy": 200.0}}, "num_env_steps_sampled": 6432, "num_env_steps_trained": 6432, "num_agent_steps_sampled": 6432, "num_agent_steps_trained": 6432}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.003484346731540641, "episode_reward_mean": 0.030990213977634483, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 616.6146373680613, "mean_inference_ms": 1.6804566310205085, "mean_action_processing_ms": 0.21859998997919333, "mean_env_wait_ms": 11.857682598038547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016122102737426758, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.15105056762695312}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.003484346731540641, "episode_reward_mean": 0.030990213977634483, "episode_len_mean": 25.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.005210256902679682, 0.005447173491606587, 0.005274329541893047, 0.005341518244740552, 0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 616.6146373680613, "mean_inference_ms": 1.6804566310205085, "mean_action_processing_ms": 0.21859998997919333, "mean_env_wait_ms": 11.857682598038547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016122102737426758, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.15105056762695312}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6432, "num_agent_steps_trained": 6432, "num_env_steps_sampled": 6432, "num_env_steps_trained": 6432, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.9763009301840717, "num_env_steps_trained_throughput_per_sec": 2.9763009301840717, "timesteps_total": 6432, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 6432, "timers": {"training_iteration_time_ms": 7707.633, "sample_time_ms": 7697.531, "load_time_ms": 0.199, "load_throughput": 161087.048, "learn_time_ms": 4.184, "learn_throughput": 7647.777, "synch_weights_time_ms": 5.719}, "counters": {"num_env_steps_sampled": 6432, "num_env_steps_trained": 6432, "num_agent_steps_sampled": 6432, "num_agent_steps_trained": 6432}, "done": false, "episodes_total": 256, "training_iteration": 90, "trial_id": "3fc51_00000", "date": "2024-08-11_19-34-43", "timestamp": 1723368883, "time_this_iter_s": 10.751600980758667, "time_total_s": 1495.594017982483, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1495.594017982483, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 14.200000000000001, "ram_util_percent": 89.87333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.530099868774414, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.9399501499938197e-08, "policy_loss": 0.0, "vf_loss": 0.05532894656062126}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 204.0, "diff_num_grad_updates_vs_sampler_policy": 203.0}}, "num_env_steps_sampled": 6528, "num_env_steps_trained": 6528, "num_agent_steps_sampled": 6528, "num_agent_steps_trained": 6528}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0031975387979227363, "episode_reward_mean": 0.03090646892275902, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 615.1026297337768, "mean_inference_ms": 1.6758126995992635, "mean_action_processing_ms": 0.21817151349097041, "mean_env_wait_ms": 11.628792897162116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.15000033378601074}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0031975387979227363, "episode_reward_mean": 0.03090646892275902, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0051343861243037005, 0.005073648551663692, 0.005298038274315127, 0.00519803553711948, 0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 615.1026297337768, "mean_inference_ms": 1.6758126995992635, "mean_action_processing_ms": 0.21817151349097041, "mean_env_wait_ms": 11.628792897162116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.15000033378601074}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6528, "num_agent_steps_trained": 6528, "num_env_steps_sampled": 6528, "num_env_steps_trained": 6528, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.612442579753731, "num_env_steps_trained_throughput_per_sec": 4.612442579753731, "timesteps_total": 6528, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6528, "timers": {"training_iteration_time_ms": 7471.997, "sample_time_ms": 7461.979, "load_time_ms": 0.251, "load_throughput": 127656.199, "learn_time_ms": 3.726, "learn_throughput": 8587.297, "synch_weights_time_ms": 6.041}, "counters": {"num_env_steps_sampled": 6528, "num_env_steps_trained": 6528, "num_agent_steps_sampled": 6528, "num_agent_steps_trained": 6528}, "done": false, "episodes_total": 260, "training_iteration": 91, "trial_id": "3fc51_00000", "date": "2024-08-11_19-35-04", "timestamp": 1723368904, "time_this_iter_s": 20.81922721862793, "time_total_s": 1516.4132452011108, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1516.4132452011108, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 15.980000000000002, "ram_util_percent": 89.91999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3034738302230835, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.9498069764599677e-08, "policy_loss": 0.0, "vf_loss": 0.0006170305423438549}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 207.0, "diff_num_grad_updates_vs_sampler_policy": 206.0}}, "num_env_steps_sampled": 6624, "num_env_steps_trained": 6624, "num_agent_steps_sampled": 6624, "num_agent_steps_trained": 6624}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.003007073786712633, "episode_reward_mean": 0.030820670392081674, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 613.7232038684206, "mean_inference_ms": 1.6713978269114573, "mean_action_processing_ms": 0.21777973278214455, "mean_env_wait_ms": 11.408458923961478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14899373054504395}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.003007073786712633, "episode_reward_mean": 0.030820670392081674, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.004938052751765889, 0.005150362824337494, 0.0050558054296496475, 0.004995570066028133, 0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 613.7232038684206, "mean_inference_ms": 1.6713978269114573, "mean_action_processing_ms": 0.21777973278214455, "mean_env_wait_ms": 11.408458923961478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14899373054504395}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6624, "num_agent_steps_trained": 6624, "num_env_steps_sampled": 6624, "num_env_steps_trained": 6624, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.274122689750398, "num_env_steps_trained_throughput_per_sec": 7.274122689750398, "timesteps_total": 6624, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6624, "timers": {"training_iteration_time_ms": 6842.946, "sample_time_ms": 6832.228, "load_time_ms": 0.151, "load_throughput": 212302.638, "learn_time_ms": 4.095, "learn_throughput": 7814.533, "synch_weights_time_ms": 6.472}, "counters": {"num_env_steps_sampled": 6624, "num_env_steps_trained": 6624, "num_agent_steps_sampled": 6624, "num_agent_steps_trained": 6624}, "done": false, "episodes_total": 264, "training_iteration": 92, "trial_id": "3fc51_00000", "date": "2024-08-11_19-35-17", "timestamp": 1723368917, "time_this_iter_s": 13.202450275421143, "time_total_s": 1529.615695476532, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1529.615695476532, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 25.036842105263155, "ram_util_percent": 88.59473684210528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.212940216064453, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.866966397618853e-08, "policy_loss": 0.0, "vf_loss": 0.06798432022333145}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 210.0, "diff_num_grad_updates_vs_sampler_policy": 209.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0028366143209698196, "episode_reward_mean": 0.030733590153794715, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 612.3799702751609, "mean_inference_ms": 1.6672651724819758, "mean_action_processing_ms": 0.21739551053485948, "mean_env_wait_ms": 11.197260719384303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14399409294128418}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0028366143209698196, "episode_reward_mean": 0.030733590153794715, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.004826542451154956, 0.005029161485409317, 0.004938969073241515, 0.004881473415662622, 0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 612.3799702751609, "mean_inference_ms": 1.6672651724819758, "mean_action_processing_ms": 0.21739551053485948, "mean_env_wait_ms": 11.197260719384303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14399409294128418}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 7.328285007226398, "num_env_steps_trained_throughput_per_sec": 7.328285007226398, "timesteps_total": 6720, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 5786.125, "sample_time_ms": 5775.974, "load_time_ms": 0.152, "load_throughput": 210901.521, "learn_time_ms": 4.744, "learn_throughput": 6745.626, "synch_weights_time_ms": 5.255}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 268, "training_iteration": 93, "trial_id": "3fc51_00000", "date": "2024-08-11_19-35-31", "timestamp": 1723368931, "time_this_iter_s": 13.106898784637451, "time_total_s": 1542.7225942611694, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1542.7225942611694, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 27.077777777777776, "ram_util_percent": 88.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.225589752197266, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.7750003184223715e-08, "policy_loss": 0.0, "vf_loss": 0.25351566076278687}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 212.0}}, "num_env_steps_sampled": 6816, "num_env_steps_trained": 6816, "num_agent_steps_sampled": 6816, "num_agent_steps_trained": 6816}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0027017713139482363, "episode_reward_mean": 0.030645672797411816, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 611.1406533618799, "mean_inference_ms": 1.6632844790587549, "mean_action_processing_ms": 0.21701906802587267, "mean_env_wait_ms": 10.993666479238684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.1434328556060791}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0027017713139482363, "episode_reward_mean": 0.030645672797411816, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.004724524682673184, 0.004918504609497401, 0.004832200087889086, 0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 611.1406533618799, "mean_inference_ms": 1.6632844790587549, "mean_action_processing_ms": 0.21701906802587267, "mean_env_wait_ms": 10.993666479238684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.1434328556060791}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6816, "num_agent_steps_trained": 6816, "num_env_steps_sampled": 6816, "num_env_steps_trained": 6816, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 5.904434437885203, "num_env_steps_trained_throughput_per_sec": 5.904434437885203, "timesteps_total": 6816, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6816, "timers": {"training_iteration_time_ms": 5395.476, "sample_time_ms": 5385.512, "load_time_ms": 0.355, "load_throughput": 90024.635, "learn_time_ms": 4.508, "learn_throughput": 7098.162, "synch_weights_time_ms": 5.1}, "counters": {"num_env_steps_sampled": 6816, "num_env_steps_trained": 6816, "num_agent_steps_sampled": 6816, "num_agent_steps_trained": 6816}, "done": false, "episodes_total": 272, "training_iteration": 94, "trial_id": "3fc51_00000", "date": "2024-08-11_19-35-47", "timestamp": 1723368947, "time_this_iter_s": 16.26606583595276, "time_total_s": 1558.9886600971222, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1558.9886600971222, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 27.082608695652173, "ram_util_percent": 87.4913043478261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.54042434692383, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.703760770828012e-08, "policy_loss": 0.0, "vf_loss": 0.4336509704589844}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 216.0, "diff_num_grad_updates_vs_sampler_policy": 215.0}}, "num_env_steps_sampled": 6912, "num_env_steps_trained": 6912, "num_agent_steps_sampled": 6912, "num_agent_steps_trained": 6912}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0025698102146037723, "episode_reward_mean": 0.030578707074580037, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 610.5748260037406, "mean_inference_ms": 1.6609548860851704, "mean_action_processing_ms": 0.21707786501787626, "mean_env_wait_ms": 10.845032619017475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14640355110168457}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0025698102146037723, "episode_reward_mean": 0.030578707074580037, "episode_len_mean": 25.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0047771474279074515, 0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 610.5748260037406, "mean_inference_ms": 1.6609548860851704, "mean_action_processing_ms": 0.21707786501787626, "mean_env_wait_ms": 10.845032619017475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14640355110168457}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6912, "num_agent_steps_trained": 6912, "num_env_steps_sampled": 6912, "num_env_steps_trained": 6912, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 8.400246015839569, "num_env_steps_trained_throughput_per_sec": 8.400246015839569, "timesteps_total": 6912, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 6912, "timers": {"training_iteration_time_ms": 5391.668, "sample_time_ms": 5381.618, "load_time_ms": 0.303, "load_throughput": 105459.046, "learn_time_ms": 4.099, "learn_throughput": 7806.488, "synch_weights_time_ms": 5.647}, "counters": {"num_env_steps_sampled": 6912, "num_env_steps_trained": 6912, "num_agent_steps_sampled": 6912, "num_agent_steps_trained": 6912}, "done": false, "episodes_total": 275, "training_iteration": 95, "trial_id": "3fc51_00000", "date": "2024-08-11_19-35-58", "timestamp": 1723368958, "time_this_iter_s": 11.43358850479126, "time_total_s": 1570.4222486019135, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1570.4222486019135, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 20.962500000000002, "ram_util_percent": 84.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.42032814025879, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.6731894919862498e-08, "policy_loss": 0.0, "vf_loss": 0.1974894255399704}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 217.0, "diff_num_grad_updates_vs_sampler_policy": 216.0}}, "num_env_steps_sampled": 6944, "num_env_steps_trained": 6944, "num_agent_steps_sampled": 6944, "num_agent_steps_trained": 6944}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0025698102146037723, "episode_reward_mean": 0.030556640501986188, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 609.7931308552677, "mean_inference_ms": 1.6595791755864981, "mean_action_processing_ms": 0.216621664958787, "mean_env_wait_ms": 10.7967923689915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14540338516235352}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0025698102146037723, "episode_reward_mean": 0.030556640501986188, "episode_len_mean": 25.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.004632425343910513, 0.00481876102607894, 0.004683003931999708, 0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 609.7931308552677, "mean_inference_ms": 1.6595791755864981, "mean_action_processing_ms": 0.216621664958787, "mean_env_wait_ms": 10.7967923689915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.14540338516235352}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6944, "num_agent_steps_trained": 6944, "num_env_steps_sampled": 6944, "num_env_steps_trained": 6944, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.9644653493368582, "num_env_steps_trained_throughput_per_sec": 2.9644653493368582, "timesteps_total": 6944, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 6944, "timers": {"training_iteration_time_ms": 5158.066, "sample_time_ms": 5147.169, "load_time_ms": 0.409, "load_throughput": 78297.59, "learn_time_ms": 4.366, "learn_throughput": 7328.775, "synch_weights_time_ms": 6.122}, "counters": {"num_env_steps_sampled": 6944, "num_env_steps_trained": 6944, "num_agent_steps_sampled": 6944, "num_agent_steps_trained": 6944}, "done": false, "episodes_total": 276, "training_iteration": 96, "trial_id": "3fc51_00000", "date": "2024-08-11_19-36-09", "timestamp": 1723368969, "time_this_iter_s": 10.807674169540405, "time_total_s": 1581.2299227714539, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1581.2299227714539, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 12.013333333333332, "ram_util_percent": 82.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.6676655551227668e-08, "policy_loss": 0.0, "vf_loss": 1.072597861289978}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 219.0, "diff_num_grad_updates_vs_sampler_policy": 218.0}}, "num_env_steps_sampled": 7008, "num_env_steps_trained": 7008, "num_agent_steps_sampled": 7008, "num_agent_steps_trained": 7008}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.002464257543465202, "episode_reward_mean": 0.03048986249798995, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 608.9034249131165, "mean_inference_ms": 1.657586267523162, "mean_action_processing_ms": 0.21634271742456007, "mean_env_wait_ms": 10.654808071106508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.008090496063232422, "ViewRequirementAgentConnector_ms": 0.15445446968078613}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.002464257543465202, "episode_reward_mean": 0.03048986249798995, "episode_len_mean": 25.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00473589447275943, 0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 608.9034249131165, "mean_inference_ms": 1.657586267523162, "mean_action_processing_ms": 0.21634271742456007, "mean_env_wait_ms": 10.654808071106508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157316207885742, "StateBufferConnector_ms": 0.008090496063232422, "ViewRequirementAgentConnector_ms": 0.15445446968078613}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7008, "num_agent_steps_trained": 7008, "num_env_steps_sampled": 7008, "num_env_steps_trained": 7008, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 3.762269485789098, "num_env_steps_trained_throughput_per_sec": 3.762269485789098, "timesteps_total": 7008, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 7008, "timers": {"training_iteration_time_ms": 6852.378, "sample_time_ms": 6839.795, "load_time_ms": 0.464, "load_throughput": 68925.039, "learn_time_ms": 6.074, "learn_throughput": 5268.523, "synch_weights_time_ms": 6.045}, "counters": {"num_env_steps_sampled": 7008, "num_env_steps_trained": 7008, "num_agent_steps_sampled": 7008, "num_agent_steps_trained": 7008}, "done": false, "episodes_total": 279, "training_iteration": 97, "trial_id": "3fc51_00000", "date": "2024-08-11_19-36-26", "timestamp": 1723368986, "time_this_iter_s": 17.011008977890015, "time_total_s": 1598.2409317493439, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1598.2409317493439, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.395833333333332, "ram_util_percent": 83.85833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.852871894836426, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.7293399540440078e-08, "policy_loss": 0.0, "vf_loss": 0.07048984616994858}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 220.0, "diff_num_grad_updates_vs_sampler_policy": 219.0}}, "num_env_steps_sampled": 7040, "num_env_steps_trained": 7040, "num_agent_steps_sampled": 7040, "num_agent_steps_trained": 7040}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.002464257543465202, "episode_reward_mean": 0.03046715238085862, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202, 0.0024648827596266357], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 608.6249615388738, "mean_inference_ms": 1.6566720110350044, "mean_action_processing_ms": 0.21631091189478102, "mean_env_wait_ms": 10.607620119668631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01615738868713379, "StateBufferConnector_ms": 0.007090330123901367, "ViewRequirementAgentConnector_ms": 0.15445566177368164}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.002464257543465202, "episode_reward_mean": 0.03046715238085862, "episode_len_mean": 25.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00453025004434077, 0.004708304914993794, 0.004578612045276921, 0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202, 0.0024648827596266357], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 608.6249615388738, "mean_inference_ms": 1.6566720110350044, "mean_action_processing_ms": 0.21631091189478102, "mean_env_wait_ms": 10.607620119668631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01615738868713379, "StateBufferConnector_ms": 0.007090330123901367, "ViewRequirementAgentConnector_ms": 0.15445566177368164}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7040, "num_agent_steps_trained": 7040, "num_env_steps_sampled": 7040, "num_env_steps_trained": 7040, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 2.7935919386003807, "num_env_steps_trained_throughput_per_sec": 2.7935919386003807, "timesteps_total": 7040, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 7040, "timers": {"training_iteration_time_ms": 6694.652, "sample_time_ms": 6681.903, "load_time_ms": 0.565, "load_throughput": 56679.784, "learn_time_ms": 6.15, "learn_throughput": 5202.943, "synch_weights_time_ms": 6.034}, "counters": {"num_env_steps_sampled": 7040, "num_env_steps_trained": 7040, "num_agent_steps_sampled": 7040, "num_agent_steps_trained": 7040}, "done": false, "episodes_total": 280, "training_iteration": 98, "trial_id": "3fc51_00000", "date": "2024-08-11_19-36-38", "timestamp": 1723368998, "time_this_iter_s": 11.459773540496826, "time_total_s": 1609.7007052898407, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1609.7007052898407, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 13.193750000000001, "ram_util_percent": 84.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.8445048982916887e-08, "policy_loss": 0.0, "vf_loss": 1.5671584606170654}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 222.0, "diff_num_grad_updates_vs_sampler_policy": 221.0}}, "num_env_steps_sampled": 7104, "num_env_steps_trained": 7104, "num_agent_steps_sampled": 7104, "num_agent_steps_trained": 7104}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0023550663132678408, "episode_reward_mean": 0.030400213400807775, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202, 0.0024648827596266357, 0.0023776640536138658, 0.0023905386326452276, 0.0023550663132678408], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 607.7597473911807, "mean_inference_ms": 1.65495521969208, "mean_action_processing_ms": 0.21590131630099343, "mean_env_wait_ms": 10.47050586710575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01615738868713379, "StateBufferConnector_ms": 0.00808858871459961, "ViewRequirementAgentConnector_ms": 0.16245031356811523}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0023550663132678408, "episode_reward_mean": 0.030400213400807775, "episode_len_mean": 25.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.2802219263895576, 0.00456268207113043, 0.004629159849498104, 0.00444078551714112, 1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202, 0.0024648827596266357, 0.0023776640536138658, 0.0023905386326452276, 0.0023550663132678408], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 607.7597473911807, "mean_inference_ms": 1.65495521969208, "mean_action_processing_ms": 0.21590131630099343, "mean_env_wait_ms": 10.47050586710575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01615738868713379, "StateBufferConnector_ms": 0.00808858871459961, "ViewRequirementAgentConnector_ms": 0.16245031356811523}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7104, "num_agent_steps_trained": 7104, "num_env_steps_sampled": 7104, "num_env_steps_trained": 7104, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 5.325947302148938, "num_env_steps_trained_throughput_per_sec": 5.325947302148938, "timesteps_total": 7104, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 7104, "timers": {"training_iteration_time_ms": 7889.773, "sample_time_ms": 7876.724, "load_time_ms": 0.461, "load_throughput": 69431.342, "learn_time_ms": 6.456, "learn_throughput": 4956.47, "synch_weights_time_ms": 6.132}, "counters": {"num_env_steps_sampled": 7104, "num_env_steps_trained": 7104, "num_agent_steps_sampled": 7104, "num_agent_steps_trained": 7104}, "done": false, "episodes_total": 283, "training_iteration": 99, "trial_id": "3fc51_00000", "date": "2024-08-11_19-36-50", "timestamp": 1723369010, "time_this_iter_s": 12.023970365524292, "time_total_s": 1621.724675655365, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1621.724675655365, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.705882352941178, "ram_util_percent": 83.84705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.9506271204127188e-08, "policy_loss": 0.0, "vf_loss": 1.7912588119506836}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 225.0, "diff_num_grad_updates_vs_sampler_policy": 224.0}}, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 7200}, "sampler_results": {"episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0022634210424784746, "episode_reward_mean": 0.027553662964659664, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202, 0.0024648827596266357, 0.0023776640536138658, 0.0023905386326452276, 0.0023550663132678408, 0.0022842857798530086, 0.0022961660415318766, 0.0023556373486527857, 0.0022634210424784746], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 606.6697610369116, "mean_inference_ms": 1.6523877294033908, "mean_action_processing_ms": 0.21535463123166276, "mean_env_wait_ms": 10.29336032435777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01615738868713379, "StateBufferConnector_ms": 0.008023738861083984, "ViewRequirementAgentConnector_ms": 0.16689848899841309}}, "episode_reward_max": 1.1871714096285002, "episode_reward_min": 0.0022634210424784746, "episode_reward_mean": 0.027553662964659664, "episode_len_mean": 25.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.1871714096285002, 0.17065952232851847, 0.1594385850689024, 0.16072486906391464, 0.22688066775499227, 0.06585573271077652, 0.055587762565658345, 0.057464858958181604, 0.0503989331607426, 0.020561007423132237, 0.021945515026057755, 0.022927281034683437, 0.026840814958922543, 0.022216471626729725, 0.022373188304675575, 0.020411129397120007, 0.02036785642243801, 0.015343100484445798, 0.015901717178966716, 0.014461940883542735, 0.014440248131627528, 0.011778919171727834, 0.012102795493860594, 0.01124299954843944, 0.01002118533713471, 0.010254508269737584, 0.011256060129248183, 0.009630828001511922, 0.009640405201141079, 0.00835151745308384, 0.008513031217013566, 0.00807848681238348, 0.0071912609278278975, 0.007310461118290635, 0.008085228020806202, 0.006988257295231221, 0.006993292388183696, 0.006418942390085676, 0.0065137263055815835, 0.006260773508261187, 0.00625673838811915, 0.00585676628924813, 0.00593555076329291, 0.005724838379207349, 0.005721465190564854, 0.005302287344794478, 0.005366804381743593, 0.005193884670779451, 0.0051911069521168125, 0.0048203923145920926, 0.004873636226468789, 0.004730663032594244, 0.004728359375857925, 0.004415826506106933, 0.004460465279858861, 0.004338471915045095, 0.004078414840524677, 0.004116443579226014, 0.004340411195209491, 0.004012373689962439, 0.0038413021169956874, 0.0038750343239631595, 0.004014031533029705, 0.0037826366020673585, 0.003534056672423015, 0.0035625843236434395, 0.003784110627385047, 0.003484346731540641, 0.003485597234781106, 0.0032393468466801684, 0.0032632953193368393, 0.003198591729433904, 0.0031975387979227363, 0.003044019637996301, 0.003065157023399981, 0.00300800497155798, 0.003007073786712633, 0.0028694673754153396, 0.0028882426335786328, 0.002837442913121907, 0.0028366143209698196, 0.0027315550877010293, 0.0027485614850131014, 0.0027025229005159966, 0.0027017713139482363, 0.002596741204237819, 0.0026121056780401123, 0.0025698102146037723, 0.0025704901685225053, 0.0024890101259241538, 0.0025031222329762, 0.002464257543465202, 0.0024648827596266357, 0.0023776640536138658, 0.0023905386326452276, 0.0023550663132678408, 0.0022842857798530086, 0.0022961660415318766, 0.0023556373486527857, 0.0022634210424784746], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 606.6697610369116, "mean_inference_ms": 1.6523877294033908, "mean_action_processing_ms": 0.21535463123166276, "mean_env_wait_ms": 10.29336032435777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01615738868713379, "StateBufferConnector_ms": 0.008023738861083984, "ViewRequirementAgentConnector_ms": 0.16689848899841309}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 7200, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 4.850028161017446, "num_env_steps_trained_throughput_per_sec": 4.850028161017446, "timesteps_total": 7200, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 7200, "timers": {"training_iteration_time_ms": 8241.672, "sample_time_ms": 8228.745, "load_time_ms": 0.638, "load_throughput": 50172.976, "learn_time_ms": 6.463, "learn_throughput": 4951.533, "synch_weights_time_ms": 5.826}, "counters": {"num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 7200}, "done": true, "episodes_total": 287, "training_iteration": 100, "trial_id": "3fc51_00000", "date": "2024-08-11_19-37-10", "timestamp": 1723369030, "time_this_iter_s": 19.803053855895996, "time_total_s": 1641.527729511261, "pid": 16904, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000019AAAA428B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1641.527729511261, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.289285714285715, "ram_util_percent": 81.99999999999999}}
