{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 51.50151824951172, "policy_loss": -836.8817749023438, "vf_loss": 5975.216796875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32, "num_env_steps_trained": 32, "num_agent_steps_sampled": 32, "num_agent_steps_trained": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32, "num_agent_steps_trained": 32, "num_env_steps_sampled": 32, "num_env_steps_trained": 32, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 0.6798690743091039, "num_env_steps_trained_throughput_per_sec": 0.6798690743091039, "timesteps_total": 32, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 32, "timers": {"training_iteration_time_ms": 47067.367, "sample_time_ms": 46571.408, "load_time_ms": 2.073, "load_throughput": 15434.421, "learn_time_ms": 482.741, "learn_throughput": 66.288, "synch_weights_time_ms": 11.144}, "counters": {"num_env_steps_sampled": 32, "num_env_steps_trained": 32, "num_agent_steps_sampled": 32, "num_agent_steps_trained": 32}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "c760a_00000", "date": "2024-08-12_16-45-42", "timestamp": 1723445142, "time_this_iter_s": 47.08462691307068, "time_total_s": 47.08462691307068, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 47.08462691307068, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.27575757575758, "ram_util_percent": 88.18939393939395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 31.019304275512695, "policy_loss": 77.11770629882812, "vf_loss": 180.75308227539062}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128}, "sampler_results": {"episode_reward_max": -39.02283670928644, "episode_reward_min": -68.97460386220025, "episode_reward_mean": -51.62182095142398, "episode_len_mean": 30.333333333333332, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644], "episode_lengths": [30, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1359.8257676519531, "mean_inference_ms": 5.006460228351632, "mean_action_processing_ms": 0.5662393088292594, "mean_env_wait_ms": 1401.3818225475272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033855438232421875, "StateBufferConnector_ms": 0.027799606323242188, "ViewRequirementAgentConnector_ms": 0.5953788757324219}}, "episode_reward_max": -39.02283670928644, "episode_reward_min": -68.97460386220025, "episode_reward_mean": -51.62182095142398, "episode_len_mean": 30.333333333333332, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644], "episode_lengths": [30, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1359.8257676519531, "mean_inference_ms": 5.006460228351632, "mean_action_processing_ms": 0.5662393088292594, "mean_env_wait_ms": 1401.3818225475272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033855438232421875, "StateBufferConnector_ms": 0.027799606323242188, "ViewRequirementAgentConnector_ms": 0.5953788757324219}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128, "num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 2.120430773756739, "num_env_steps_trained_throughput_per_sec": 2.120430773756739, "timesteps_total": 128, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 128, "timers": {"training_iteration_time_ms": 23085.297, "sample_time_ms": 22931.09, "load_time_ms": 3.141, "load_throughput": 10188.27, "learn_time_ms": 132.285, "learn_throughput": 241.901, "synch_weights_time_ms": 18.723}, "counters": {"num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128}, "done": false, "episodes_total": 3, "training_iteration": 2, "trial_id": "c760a_00000", "date": "2024-08-12_16-46-28", "timestamp": 1723445188, "time_this_iter_s": 45.293442726135254, "time_total_s": 92.37806963920593, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 92.37806963920593, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.6984126984127, "ram_util_percent": 85.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 12.555307388305664, "policy_loss": 30.201919555664062, "vf_loss": 43.279170989990234}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 160, "num_env_steps_trained": 160, "num_agent_steps_sampled": 160, "num_agent_steps_trained": 160}, "sampler_results": {"episode_reward_max": -39.02283670928644, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -60.99382979541843, "episode_len_mean": 31.25, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179], "episode_lengths": [30, 32, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1298.1335967889295, "mean_inference_ms": 4.8227103568850325, "mean_action_processing_ms": 0.5118563628073366, "mean_env_wait_ms": 1334.2442326605628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025391578674316406, "StateBufferConnector_ms": 0.026243925094604492, "ViewRequirementAgentConnector_ms": 0.7147908210754395}}, "episode_reward_max": -39.02283670928644, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -60.99382979541843, "episode_len_mean": 31.25, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179], "episode_lengths": [30, 32, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1298.1335967889295, "mean_inference_ms": 4.8227103568850325, "mean_action_processing_ms": 0.5118563628073366, "mean_env_wait_ms": 1334.2442326605628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025391578674316406, "StateBufferConnector_ms": 0.026243925094604492, "ViewRequirementAgentConnector_ms": 0.7147908210754395}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160, "num_agent_steps_trained": 160, "num_env_steps_sampled": 160, "num_env_steps_trained": 160, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 0.7014040599450897, "num_env_steps_trained_throughput_per_sec": 0.7014040599450897, "timesteps_total": 160, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 160, "timers": {"training_iteration_time_ms": 27592.792, "sample_time_ms": 27460.945, "load_time_ms": 2.513, "load_throughput": 12735.338, "learn_time_ms": 110.619, "learn_throughput": 289.28, "synch_weights_time_ms": 18.669}, "counters": {"num_env_steps_sampled": 160, "num_env_steps_trained": 160, "num_agent_steps_sampled": 160, "num_agent_steps_trained": 160}, "done": false, "episodes_total": 4, "training_iteration": 3, "trial_id": "c760a_00000", "date": "2024-08-12_16-47-14", "timestamp": 1723445234, "time_this_iter_s": 45.63800048828125, "time_total_s": 138.01607012748718, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 138.01607012748718, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.785937500000003, "ram_util_percent": 86.0609375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 9.884382247924805, "policy_loss": 20.839984893798828, "vf_loss": 7.041348457336426}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 224, "num_env_steps_trained": 224, "num_agent_steps_sampled": 224, "num_agent_steps_trained": 224}, "sampler_results": {"episode_reward_max": 0.37583487265273663, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -40.53971993494212, "episode_len_mean": 29.166666666666668, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432], "episode_lengths": [30, 32, 29, 34, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1398.9364318405205, "mean_inference_ms": 4.954778828596612, "mean_action_processing_ms": 0.5290640106732413, "mean_env_wait_ms": 1160.2604683531163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016927719116210938, "StateBufferConnector_ms": 0.01749595006306966, "ViewRequirementAgentConnector_ms": 0.7490436236063639}}, "episode_reward_max": 0.37583487265273663, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -40.53971993494212, "episode_len_mean": 29.166666666666668, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432], "episode_lengths": [30, 32, 29, 34, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1398.9364318405205, "mean_inference_ms": 4.954778828596612, "mean_action_processing_ms": 0.5290640106732413, "mean_env_wait_ms": 1160.2604683531163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016927719116210938, "StateBufferConnector_ms": 0.01749595006306966, "ViewRequirementAgentConnector_ms": 0.7490436236063639}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224, "num_agent_steps_trained": 224, "num_env_steps_sampled": 224, "num_env_steps_trained": 224, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 1.3654149145965666, "num_env_steps_trained_throughput_per_sec": 1.3654149145965666, "timesteps_total": 224, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 224, "timers": {"training_iteration_time_ms": 26405.166, "sample_time_ms": 26299.504, "load_time_ms": 2.474, "load_throughput": 12933.977, "learn_time_ms": 84.621, "learn_throughput": 378.158, "synch_weights_time_ms": 18.534}, "counters": {"num_env_steps_sampled": 224, "num_env_steps_trained": 224, "num_agent_steps_sampled": 224, "num_agent_steps_trained": 224}, "done": false, "episodes_total": 6, "training_iteration": 4, "trial_id": "c760a_00000", "date": "2024-08-12_16-48-01", "timestamp": 1723445281, "time_this_iter_s": 46.88855767250061, "time_total_s": 184.9046277999878, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 184.9046277999878, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.59538461538462, "ram_util_percent": 86.20153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 22.4493408203125, "policy_loss": -2.410459518432617, "vf_loss": 1.8284127712249756}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256}, "sampler_results": {"episode_reward_max": 0.37583487265273663, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -30.34439526840648, "episode_len_mean": 28.125, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1400.9817105108154, "mean_inference_ms": 4.951462826985695, "mean_action_processing_ms": 0.4765109674412009, "mean_env_wait_ms": 1048.351953189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039187073707580566, "StateBufferConnector_ms": 0.013121962547302246, "ViewRequirementAgentConnector_ms": 0.7941693067550659}}, "episode_reward_max": 0.37583487265273663, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -30.34439526840648, "episode_len_mean": 28.125, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1400.9817105108154, "mean_inference_ms": 4.951462826985695, "mean_action_processing_ms": 0.4765109674412009, "mean_env_wait_ms": 1048.351953189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039187073707580566, "StateBufferConnector_ms": 0.013121962547302246, "ViewRequirementAgentConnector_ms": 0.7941693067550659}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256, "num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 0.6905170803618418, "num_env_steps_trained_throughput_per_sec": 0.6905170803618418, "timesteps_total": 256, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 256, "timers": {"training_iteration_time_ms": 28897.281, "sample_time_ms": 28798.536, "load_time_ms": 3.165, "load_throughput": 10110.087, "learn_time_ms": 77.112, "learn_throughput": 414.981, "synch_weights_time_ms": 18.438}, "counters": {"num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256}, "done": false, "episodes_total": 8, "training_iteration": 5, "trial_id": "c760a_00000", "date": "2024-08-12_16-48-47", "timestamp": 1723445327, "time_this_iter_s": 46.36541700363159, "time_total_s": 231.27004480361938, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 231.27004480361938, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.155384615384616, "ram_util_percent": 86.8246153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 27.704490661621094, "policy_loss": -29.008230209350586, "vf_loss": 25.97057342529297}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 320, "num_env_steps_trained": 320, "num_agent_steps_sampled": 320, "num_agent_steps_trained": 320}, "sampler_results": {"episode_reward_max": 0.4013762708445243, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -24.20146311948665, "episode_len_mean": 27.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1458.74597161637, "mean_inference_ms": 4.964709970985861, "mean_action_processing_ms": 0.5079944761285249, "mean_env_wait_ms": 953.0198168911008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036792755126953125, "StateBufferConnector_ms": 0.010497570037841797, "ViewRequirementAgentConnector_ms": 0.7204747200012207}}, "episode_reward_max": 0.4013762708445243, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -24.20146311948665, "episode_len_mean": 27.5, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1458.74597161637, "mean_inference_ms": 4.964709970985861, "mean_action_processing_ms": 0.5079944761285249, "mean_env_wait_ms": 953.0198168911008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036792755126953125, "StateBufferConnector_ms": 0.010497570037841797, "ViewRequirementAgentConnector_ms": 0.7204747200012207}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320, "num_agent_steps_trained": 320, "num_env_steps_sampled": 320, "num_env_steps_trained": 320, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 1.3869386443380438, "num_env_steps_trained_throughput_per_sec": 1.3869386443380438, "timesteps_total": 320, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 320, "timers": {"training_iteration_time_ms": 27732.304, "sample_time_ms": 27646.885, "load_time_ms": 2.701, "load_throughput": 11847.898, "learn_time_ms": 64.575, "learn_throughput": 495.549, "synch_weights_time_ms": 18.062}, "counters": {"num_env_steps_sampled": 320, "num_env_steps_trained": 320, "num_agent_steps_sampled": 320, "num_agent_steps_trained": 320}, "done": false, "episodes_total": 10, "training_iteration": 6, "trial_id": "c760a_00000", "date": "2024-08-12_16-49-33", "timestamp": 1723445373, "time_this_iter_s": 46.16720700263977, "time_total_s": 277.43725180625916, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 277.43725180625916, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.7375, "ram_util_percent": 86.94687499999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 21.588239669799805, "policy_loss": -15.880959510803223, "vf_loss": 7.617510795593262}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 352, "num_env_steps_trained": 352, "num_agent_steps_sampled": 352, "num_agent_steps_trained": 352}, "sampler_results": {"episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -20.035715569668376, "episode_len_mean": 27.083333333333332, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1471.694330982421, "mean_inference_ms": 4.934700368546777, "mean_action_processing_ms": 0.48388146823965233, "mean_env_wait_ms": 880.9484950519221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03110369046529134, "StateBufferConnector_ms": 0.017742315928141277, "ViewRequirementAgentConnector_ms": 0.6575385729471842}}, "episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -20.035715569668376, "episode_len_mean": 27.083333333333332, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1471.694330982421, "mean_inference_ms": 4.934700368546777, "mean_action_processing_ms": 0.48388146823965233, "mean_env_wait_ms": 880.9484950519221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03110369046529134, "StateBufferConnector_ms": 0.017742315928141277, "ViewRequirementAgentConnector_ms": 0.6575385729471842}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352, "num_agent_steps_trained": 352, "num_env_steps_sampled": 352, "num_env_steps_trained": 352, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 0.7055385196174043, "num_env_steps_trained_throughput_per_sec": 0.7055385196174043, "timesteps_total": 352, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 352, "timers": {"training_iteration_time_ms": 27561.11, "sample_time_ms": 27521.096, "load_time_ms": 2.494, "load_throughput": 12832.995, "learn_time_ms": 18.68, "learn_throughput": 1713.018, "synch_weights_time_ms": 18.759}, "counters": {"num_env_steps_sampled": 352, "num_env_steps_trained": 352, "num_agent_steps_sampled": 352, "num_agent_steps_trained": 352}, "done": false, "episodes_total": 12, "training_iteration": 7, "trial_id": "c760a_00000", "date": "2024-08-12_16-50-19", "timestamp": 1723445419, "time_this_iter_s": 45.37049102783203, "time_total_s": 322.8077428340912, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 322.8077428340912, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.255555555555556, "ram_util_percent": 87.45396825396823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.475133895874023, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 2.7606263160705566, "policy_loss": -3.5703020095825195, "vf_loss": 0.005838066339492798}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 416, "num_env_steps_trained": 416, "num_agent_steps_sampled": 416, "num_agent_steps_trained": 416}, "sampler_results": {"episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -18.472504491215613, "episode_len_mean": 26.923076923076923, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045, 0.28602845021754886], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1489.424417344342, "mean_inference_ms": 4.904651153339572, "mean_action_processing_ms": 0.5026920255692351, "mean_env_wait_ms": 847.2814814430844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02871109889103816, "StateBufferConnector_ms": 0.020392124469463643, "ViewRequirementAgentConnector_ms": 0.6348188106830304}}, "episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -18.472504491215613, "episode_len_mean": 26.923076923076923, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045, 0.28602845021754886], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1489.424417344342, "mean_inference_ms": 4.904651153339572, "mean_action_processing_ms": 0.5026920255692351, "mean_env_wait_ms": 847.2814814430844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02871109889103816, "StateBufferConnector_ms": 0.020392124469463643, "ViewRequirementAgentConnector_ms": 0.6348188106830304}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416, "num_agent_steps_trained": 416, "num_env_steps_sampled": 416, "num_env_steps_trained": 416, "num_env_steps_sampled_this_iter": 64, "num_env_steps_trained_this_iter": 64, "num_env_steps_sampled_throughput_per_sec": 1.4964542453933722, "num_env_steps_trained_throughput_per_sec": 1.4964542453933722, "timesteps_total": 416, "num_steps_trained_this_iter": 64, "agent_timesteps_total": 416, "timers": {"training_iteration_time_ms": 31808.907, "sample_time_ms": 31770.044, "load_time_ms": 1.623, "load_throughput": 19718.183, "learn_time_ms": 19.946, "learn_throughput": 1604.33, "synch_weights_time_ms": 17.227}, "counters": {"num_env_steps_sampled": 416, "num_env_steps_trained": 416, "num_agent_steps_sampled": 416, "num_agent_steps_trained": 416}, "done": false, "episodes_total": 13, "training_iteration": 8, "trial_id": "c760a_00000", "date": "2024-08-12_16-55-39", "timestamp": 1723445739, "time_this_iter_s": 319.84279894828796, "time_total_s": 642.6505417823792, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 642.6505417823792, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.888333333333335, "ram_util_percent": 87.38666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.5600981712341309, "policy_loss": 0.02121621184051037, "vf_loss": 2.981693744659424}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 448, "num_env_steps_trained": 448, "num_agent_steps_sampled": 448, "num_agent_steps_trained": 448}, "sampler_results": {"episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -14.950967558320743, "episode_len_mean": 26.5625, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045, 0.28602845021754886, 0.27865637074923433, 0.3862099370944072, 0.2622111448274376], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1547.292812144235, "mean_inference_ms": 4.921689549128356, "mean_action_processing_ms": 0.49219722532035376, "mean_env_wait_ms": 765.1689488809933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023327767848968506, "StateBufferConnector_ms": 0.0230252742767334, "ViewRequirementAgentConnector_ms": 0.6693243980407715}}, "episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -14.950967558320743, "episode_len_mean": 26.5625, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045, 0.28602845021754886, 0.27865637074923433, 0.3862099370944072, 0.2622111448274376], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1547.292812144235, "mean_inference_ms": 4.921689549128356, "mean_action_processing_ms": 0.49219722532035376, "mean_env_wait_ms": 765.1689488809933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023327767848968506, "StateBufferConnector_ms": 0.0230252742767334, "ViewRequirementAgentConnector_ms": 0.6693243980407715}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448, "num_agent_steps_trained": 448, "num_env_steps_sampled": 448, "num_env_steps_trained": 448, "num_env_steps_sampled_this_iter": 32, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 0.4810241711964115, "num_env_steps_trained_throughput_per_sec": 0.4810241711964115, "timesteps_total": 448, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 448, "timers": {"training_iteration_time_ms": 33962.977, "sample_time_ms": 33921.363, "load_time_ms": 1.664, "load_throughput": 19229.727, "learn_time_ms": 21.004, "learn_throughput": 1523.494, "synch_weights_time_ms": 18.887}, "counters": {"num_env_steps_sampled": 448, "num_env_steps_trained": 448, "num_agent_steps_sampled": 448, "num_agent_steps_trained": 448}, "done": false, "episodes_total": 16, "training_iteration": 9, "trial_id": "c760a_00000", "date": "2024-08-12_16-56-46", "timestamp": 1723445806, "time_this_iter_s": 66.54390978813171, "time_total_s": 709.1944515705109, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 709.1944515705109, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 68.75444444444445, "ram_util_percent": 87.52555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.780710220336914, "cur_lr": 0.01, "entropy_coeff": 0.01, "policy_entropy": 0.011355766095221043, "policy_loss": 0.0001675318635534495, "vf_loss": 0.21465764939785004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 544, "num_env_steps_trained": 544, "num_agent_steps_sampled": 544, "num_agent_steps_trained": 544}, "sampler_results": {"episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -11.940299614413341, "episode_len_mean": 26.25, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045, 0.28602845021754886, 0.27865637074923433, 0.3862099370944072, 0.2622111448274376, 0.10467778505321072, 0.10391556936174605, 0.09840590944382085, 0.10248938100628978], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1596.5850569102024, "mean_inference_ms": 4.908266229400376, "mean_action_processing_ms": 0.5011864075488882, "mean_env_wait_ms": 679.7811520416737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018662214279174805, "StateBufferConnector_ms": 0.02442479133605957, "ViewRequirementAgentConnector_ms": 0.5720031261444092}}, "episode_reward_max": 1.1052069284166757, "episode_reward_min": -89.10985632740179, "episode_reward_mean": -11.940299614413341, "episode_len_mean": 26.25, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.86802228278522, -68.97460386220025, -39.02283670928644, -89.10985632740179, 0.37583487265273663, 0.3611646993682432, 0.22495707996434786, 0.258200382436537, 0.33915468154079687, 0.4013762708445243, 1.1052069284166757, 0.4808374304293045, 0.28602845021754886, 0.27865637074923433, 0.3862099370944072, 0.2622111448274376, 0.10467778505321072, 0.10391556936174605, 0.09840590944382085, 0.10248938100628978], "episode_lengths": [30, 32, 29, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1596.5850569102024, "mean_inference_ms": 4.908266229400376, "mean_action_processing_ms": 0.5011864075488882, "mean_env_wait_ms": 679.7811520416737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018662214279174805, "StateBufferConnector_ms": 0.02442479133605957, "ViewRequirementAgentConnector_ms": 0.5720031261444092}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544, "num_agent_steps_trained": 544, "num_env_steps_sampled": 544, "num_env_steps_trained": 544, "num_env_steps_sampled_this_iter": 96, "num_env_steps_trained_this_iter": 96, "num_env_steps_sampled_throughput_per_sec": 1.9349183199659719, "num_env_steps_trained_throughput_per_sec": 1.9349183199659719, "timesteps_total": 544, "num_steps_trained_this_iter": 96, "agent_timesteps_total": 544, "timers": {"training_iteration_time_ms": 29674.929, "sample_time_ms": 29634.007, "load_time_ms": 1.406, "load_throughput": 22759.569, "learn_time_ms": 20.012, "learn_throughput": 1599.077, "synch_weights_time_ms": 19.447}, "counters": {"num_env_steps_sampled": 544, "num_env_steps_trained": 544, "num_agent_steps_sampled": 544, "num_agent_steps_trained": 544}, "done": true, "episodes_total": 20, "training_iteration": 10, "trial_id": "c760a_00000", "date": "2024-08-12_16-57-36", "timestamp": 1723445856, "time_this_iter_s": 49.63751530647278, "time_total_s": 758.8319668769836, "pid": 29120, "hostname": "DELL", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "qdataset/qsimpyds_1000_sub_26.csv", "evaluation_interval": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000028D29326820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "use_critic": true, "use_gae": true, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 758.8319668769836, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.77246376811594, "ram_util_percent": 87.8144927536232}}
